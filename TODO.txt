# patch olsrd1 for interface-name e.g. tap0: olsrd[15913]: OLSR: sendto IPv4 Operation not permitted

# HOSTNAME differs from monitoring? autotake monitoring name...

# init: never touch txpower/beacon_int in roaming mode

# extrawatt: automatische pruefung

# VHS: ffweimar: wifi-dhcp-range

# /usr/sbin/cron.build_netjson.sh -> dont hardcode curl, use _curl it

# ewerk: disable wan-olsr on inet-offer

# 4900er mac-fix: disable for newer firmwares

# _net_show_traffic: short timestamps


# 10.63.249.166 = MUCZ-ANB-084    = 8c:73:6e:0a:99:3a
# 10.63.249.172 = Goethe-Event700 = 00:e0:db:0f:7e:2c


# mail: golle: benutzerverwaltung
# mail: julius: remote-luci2
# mail: GEZ/robert

# Router gibt TX-power vor?! Bahn-WLAN:
# kernel: wlan0: Limiting TX power to 20 (20 - 0) dBm as advertised by 06:90:e8:38:21:04

# WITI-board: autostart mac-address-script on first boot

# HNCP deploy + olsrd2

# iptables --quota for exact cut of user

# callbacks to ubus from hostapd for active reduce/omit proberesponse messages
# -> decentralized roaming-controller

# apply to trunk: https://github.com/thuehn/RegMon
# +powercontrol


# net_inet_seems_valid: dns + wget + https? + ping? -> hna4-offer

# SMS77

# spbansin: haus1/knoten2: 192.168.1.20 ping?!

# wartungsmodus? ->raise TXpower + message to master

# roam: active kick of mac at last known router
# roam: better concept for distributed DB:
#       - all add/del-events broadcast to all my neighs + master
#       - all routers ask master/x.x.x.x if they dont know the IP
#       - cgi-bin-roaming.sh
# db-format:
# timestamp_written_to_db mac lastnode ip4,times_out_at ip6,times_out_at


# wagenplatz: 10.63.235.33 sendet leer an cgi-bin-sql.sh?

# spbansin: 0.0.0.0/0 bei boot auf 6.6.6.6/32 und nur bei pppoe-up auf 0.0.0.0 + restart olsr
# I=0; while VALUE="$( uci -q get olsrd.@Hna4[$I].netaddr )"; do I=$((I+1)); echo "I: $I V: $VALUE"; done
I: 1 V: 10.63.21.64
I: 2 V: 0.0.0.0
I: 3 V: 100.66.18.0


# split 0.0.0.0/0 into 0.0.0.0/1 and 128.0.0.0/1?


# spbansin: knopfdruck: SSID-aenderung? + zwangsseite mit systeminfos?


SSH_CONNECTION=100.66.45.61 50938 100.64.0.1 22
TZ=CET-1CEST-2,M3.5.0/02:00:00,M10.5.0/03:00:00
root@F36-drucker-NEU:~ _net ip2mac 100.66.45.61
00:21:6a:32:7c:1c
root@F36-drucker-NEU:~ iw dev wlan0 station get 00:21:6a:32:7c:1c
command failed: No such file or directory (-2)
root@F36-drucker-NEU:~ iw dev wlan0-1 station get 00:21:6a:32:7c:1c
Station 00:21:6a:32:7c:1c (on wlan0-1)
	inactive time:	0 ms
	rx bytes:	6994122
	rx packets:	52208
	tx bytes:	58676522
	tx packets:	67069
	tx retries:	11480
	tx failed:	70
	signal:  	-51 [-56, -55, -57] dBm
	signal avg:	-51 [-54, -55, -56] dBm
	tx bitrate:	52.0 MBit/s MCS 11
	rx bitrate:	117.0 MBit/s MCS 14
	expected throughput:	28.14Mbps
	authorized:	yes
	authenticated:	yes
	preamble:	short
	WMM/WME:	yes
	MFP:		no
	TDLS peer:	no
	connected time:	10633 seconds





# https://github.com/koalaman/shellcheck/pull/594# 
# 5000 netto -> MAIL + post
# 4000 netto wettermail
# 2 x ueberweisung boltenahgen + sms77



# vpn-server: cgi-bin-sql.sh wird gerufen von _weblogin, fehlt aber.
# override_uci_vars kann wegen rc.common nicht ausgefuehrt werden.

# dualradio: only restart roaming-listener after last client if *all* ap-devs are empty

# hotplug -> IMEI -> correct settings

# extrawatt: kromsdorf: keine SMS?

# wuschel: 2nd netz? e.g. 'freifunk ($hostname)'

# falsche reihenfolge, RRD haut nicht hin:
root@EG-flurDSL-MESH:~ iptables -nxvL FORWARD
Chain FORWARD (policy ACCEPT 388095 packets, 246324393 bytes)
    pkts      bytes target     prot opt in     out     source               destination         
  470509 26415584 TCPMSS     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 TCPMSS clamp to PMTU
10937424 13211795494            all  --  eth0.2 *       0.0.0.0/0            0.0.0.0/0           
 6705076 1866794696            all  --  *      eth0.2  0.0.0.0/0            0.0.0.0/0           



# WPA2-anonymous: http://blog.vandestreek.net/post/95438706640/playing-with-wpa2-enterprise-using-openwrt-and

# marinabh: 6mbit mcast?

# ibfl: auf dem USB-stick gibt es 2 mal DB:
# $DIR_DATABASE/USER/profile/id1_counterA (korrekt)
# /tmp/kalua/storage/sda1_3.7G/DB/USER/profile/id1_counterA
# /tmp/kalua/storage/sda1_3.7G/database/DB/USER/profile/id1_counterA


# roaming: kann anderes nicht erreichen, weil laptop zu grosse netzmaske hat:
# 100.66.19.64/10 = laptop
# ziel = 100.65.4.28 auf router 100.64.4.1
# geht nicht!
#
# ergo: laptop hat nur 24er-maske und route zu 100.64.0.1 ?


# resolv.conf -> SMS once

# roaming: new: check where was the last AP, at remove host route there
# roaming: host route set? -> inactive time >50 sec? kick!


# on dualradio: shift down txpower of 2.4ghz, raise 5ghz

# use declaration in HTTP-Header AND in document:
#   https://www.w3.org/International/questions/qa-html-encoding-declarations.en
# test: https://validator.w3.org/i18n-checker/
# test: https://gtmetrix.com/
# cgi-script: <html lang='de'>
# http://bwireless.mooo.com/cgi-bin-status.sh

# wifi-assoc-liste in owm-api

# free-country-flags.com ?

# DNS much better in DSCP?


# angebot: kloster

# angebot: 3.6. neufert box und 4.6 foyer DNT




# use mtd-rw kernelmodule for updating bootloaders

# use codespell!

# mac80211 enforce band steering
# https://documentation.meraki.com/MR/Radio_Settings/Band_Steering_Overview

# wenn client auf 5ghz wechselt, dann 2.4ghz verbieten?

# read: hostapd "IP ROAMING" / Inter Access Point Protocol (IAPP) / 802.11f
# http://resin.csoft.net/cgi-bin/man.cgi?section=5&topic=hostapd.conf
# https://dev.openwrt.org/ticket/18021


# VPN-server: disable tap598
# autobootup: portfw: see net: keyword: 10.63.88.186
# new uci-var: ???



# netjson: vis: http://emptypipes.org/2015/02/15/selectable-force-directed-graph/


# show in monitoring:
# cat /etc/openwrt_release
# ...
# DISTRIB_CODENAME='chaos_calmer'
# DISTRIB_CODENAME='designated_driver'





# zsun:
# =====
# download on PC into /tmp
# openwrt-ar71xx-generic-zsun-sdreader-rootfs-squashfs.bin
# openwrt-ar71xx-generic-zsun-sdreader-kernel.bin
#
# on PC
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp
#
# on ZSUN:
# cd /tmp
# tftp -g 10.168.168.100 -r openwrt-ar71xx-generic-zsun-sdreader-kernel.bin
# tftp -g 10.168.168.100 -r openwrt-ar71xx-generic-zsun-sdreader-rootfs-squashfs.bin
# cat /proc/mtd

#!/bin/sh
# nohup() { test -t 0 && exec 0>/dev/null; test -t 1 && { exec 1>nohup.out || exec 1>nohup.out; }; test -t 2 && exec 2>&1; trap : HUP; }
# for F in /proc/[0-9]*; do PID=${F##*/}; case "$(cat $F/cmdline)" in ''|*telnetd|*wifi_daemon|*sh|*115200|init);;*)kill $PID;; esac; done
#
# mtd_write write openwrt-ar71xx-generic-zsun-sdreader-kernel.bin /dev/mtd3
# mtd_write write openwrt-ar71xx-generic-zsun-sdreader-rootfs-squashfs.bin /dev/mtd2



  PID  Uid     VmSize Stat Command
    1 root        180 S   init       
    2 root            SW< [kthreadd]
    3 root            SW< [ksoftirqd/0]
    4 root            SW< [events/0]
    5 root            SW< [khelper]
    8 root            SW< [async/mgr]
   56 root            SW< [kblockd/0]
   65 root            SW< [khubd]
   84 root            SW  [pdflush]
   85 root            SW  [pdflush]
   86 root            SW< [kswapd0]
   90 root            SW< [crypto/0]
  120 root            SW< [mtdblockd]
  151 root            SWN [jffs2_gcd_mtd2]
  356 root        140 S   /usr/sbin/telnetd 
  483 root        296 S   /sbin/wifi_daemon 
  489 root            Z   [sh]
 2015 root        320 S   -sh 
 3078 root        208 S   /sbin/getty ttyS0 115200 
 3093 root        196 R   ps 
















# seems that cron.eval... has a race with /database?

# detect context and forget net_reachable during normal operation



# bootup + no ethernet? -> generate on the fly ethernet section


# db_backup + db_restore: override names via uci or autodetect 


loop?:
Mon Apr  4 21:59:37 CEST 2016 ignoring 'regulatory domain change: set to US by a user request' - touch '/tmp/kalua/IWLOOP_RESPECT_REGSET' for this
Mon Apr  4 21:59:37 CEST 2016 ignoring 'regulatory domain change: set to world roaming by a user request' - touch '/tmp/kalua/IWLOOP_RESPECT_REGSET' for this
Mon Apr  4 21:59:37 CEST 2016 ignoring 'regulatory domain change: set to US by a user request' - touch '/tmp/kalua/IWLOOP_RESPECT_REGSET' for this
Mon Apr  4 21:59:38 CEST 2016 mac2ipv4(12) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:38 CEST 2016 mac2ipv4(11) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:38 CEST 2016 mac2ipv4(11) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:38 CEST 2016 mac2ipv4(10) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:38 CEST 2016 mac2ipv4(10) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(9) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(9) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(8) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(8) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(7) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(7) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(6) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(6) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(5) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(5) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(4) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:39 CEST 2016 mac2ipv4(4) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(3) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(3) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(2) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(2) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(1) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(1) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(0) station 00:21:6a:32:7c:1c lost - giving up
Mon Apr  4 21:59:40 CEST 2016 worker(12086) dev:wlan1-1 ch:5 MODE: new MAC: 00:21:6a:32:7c:1c - ip: '' signal: '-55' (is_good)
Mon Apr  4 21:59:40 CEST 2016 EVENT 25: 'wlan1-1: del station 00:21:6a:32:7c:1c'
Mon Apr  4 21:59:40 CEST 2016 worker(12086) dev:wlan1-1 ch:5 MODE: del MAC: 00:21:6a:32:7c:1c - alien: deleting route
Mon Apr  4 21:59:40 CEST 2016 EVENT 29: 'wlan0-1: new station 00:21:6a:32:7c:1c'
Mon Apr  4 21:59:40 CEST 2016 worker(12086) dev:wlan0-1 ch:40 MODE: new MAC: 00:21:6a:32:7c:1c - signal: '-61' border: '-83' try: 4
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(19) grabbed ip from arp: 00:21:6a:32:7c:1c -> 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 mac2ipv4(19) [SUCCESS] setting host route for alien 100.66.79.61
Mon Apr  4 21:59:40 CEST 2016 worker(12086) dev:wlan0-1 ch:40 MODE: new MAC: 00:21:6a:32:7c:1c - ip: '100.66.79.61' signal: '-61' (is_good)









# git grep '/tmp/CLIENTS_'|grep -v ^openwrt-addons/etc/init.d/S43ethers_fff+
# ersetzen durch:
# _net_both_ipv4_in_same_subnet '10.63.2.41/32' "$LANNET/$LANPRE"


# idee:
# iw scan + grundriss + https://de.wikipedia.org/wiki/Gnuplot
# xdotool getmouselocation --shell
# http://unix.stackexchange.com/questions/106736/detect-if-mouse-button-is-pressed-then-invoke-a-script-or-command


# TODO: busybox: shift
# - ./shell/ash.c must return 1 if no more args
# - see: dash: src/options.c

EJBW: allow WAN-SSH from RFC1918-net? 172.17.0.81 -> 172.17.0.2 geht nicht

# airport hotels

# mario behling

# update olsr.org-git in build.sh

tc change dev wifi0 root cake bandwidth 10mbit

sysbench --num-threads=8 --cpu-max-prime=10000 --test=cpu run

DIFF luense

comgt-ncm

# no speedtest for 3g!
# no olsr on tunnel for 3g! on client - uci set olsrd.@Interface[3].ignored=1
# no olsr on tunnel for 3g! on server - ankuendigen von node per HNA?
#
# -> 119913 / 600 sec RX = 17.3mb/Tag - oder 169170/15min
# ->  40569 / 600 sec TX =  5.8mb/Tag ... beides = 23.1mb/Tag - oder 42800/15min
# oder RX 169170/15min
# oder TX 42800/15min  ... ergo: 20,3mb/tag = 610mb/monat
# anders: 50mb/monat = 1.66mb/tag = 70k/Stunde = 1157 Bytes/Minute



- mail jens beantworten

# CVJM:
# anpassen
CHARSET="ISO-8859-1"
HOTELNAME="CVJM-Leipzig e.V."
BEZAHLMODELL="kostenfrei"
SPEED="50 Megabit/s"
TECHNIK="IEEE 802.11b/g/n/a"
WARTUNGSFENSTER="t.glich zwischen 03:30 - 04:30 Uhr"
SPEICHERDAUER="6 Monate"
SIGNATUR="Die Administration"
ERSTELLUNGSZEIT='2016 Mar 17'
# for F in '/tmp/vds_user_'*; do [ -e "$F" ] && touch "$F"; done
# in _netfilter_user_del am ende kein 'rm'



https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/log/?h=v4.1.19


# TEXT PC Luense + whitelabel?!



root@EG-bastianHQ:~ _net local_inet_offer
Mar 14 13:59:07 ' [up 35331s 97632 bytes free] TERM:screen -ash [daemon.debug] net_local_inet_offer() PHYDEV: 'wwan0' METRIC: '' N: 'static' D: '10.28.200.225'
Mar 14 13:59:07 ' [up 35331s 97664 bytes free] TERM:screen -ash [daemon.info] net_local_inet_offer() found local default-gateway over device 'wwan0' = 'pppoe'
pppoe



"Complexity is a cost, spend it wisely."

root@Emilio-derZar:~ iw dev wlan0-1 station get 00:21:6a:32:7c:1c
Station 00:21:6a:32:7c:1c (on wlan0-1)
	inactive time:	10 ms
	rx bytes:	728859
	rx packets:	3334
	tx bytes:	4456843
	tx packets:	4242
	tx retries:	6009
	tx failed:	51
	signal:  	-80 [-82, -86, -90] dBm
	signal avg:	-73 [-75, -82, -84] dBm
	tx bitrate:	13.0 MBit/s MCS 8
	rx bitrate:	5.5 MBit/s
	expected throughput:	0.732Mbps
	authorized:	yes
	authenticated:	yes
	preamble:	short
	WMM/WME:	yes
	MFP:		no
	TDLS peer:	no





root@WiTi-1:~ hdparm -t /dev/sda

/dev/sda:
 Timing buffered disk reads: 198 MB in  3.01 seconds =  65.88 MB/sec


root@WiTi-1:~ time dd if=/dev/sda of=/dev/null bs=1M count=1000
1000+0 records in
1000+0 records out
real    0m 14.89s
user    0m 0.03s
sys     0m 14.49s

root@WiTi-1:~ cat /proc/partitions
major minor  #blocks  name

  31        0        192 mtdblock0
  31        1         64 mtdblock1
  31        2         64 mtdblock2
  31        3      16064 mtdblock3
  31        4       1469 mtdblock4
  31        5      14594 mtdblock5
  31        6      10944 mtdblock6
   8        0  312571224 sda
   8        1  312568672 sda1
 253        0     126976 zram0
 253        1     126976 zram1
 253        2     126976 zram2
 253        3     126976 zram3

root@WiTi-1:~ grep ahci /tmp/dmesg.log 
[    4.810000] ahci 0000:03:00.0: no of_node; not parsing pinctrl DT
[    4.810000] ahci 0000:03:00.0: version 3.0
[    4.810000] ahci 0000:03:00.0: SSS flag set, parallel bus scan disabled
[    4.830000] ahci 0000:03:00.0: AHCI 0001.0200 32 slots 2 ports 6 Gbps 0x3 impl SATA mode
[    4.840000] ahci 0000:03:00.0: flags: 64bit ncq sntf stag led clo pmp pio slum part ccc sxs
[    4.860000] scsi host0: ahci
[    4.870000] scsi host1: ahci





# bastian/berlin: mail von julias wegen homenet+olsrd2+ipv6+bgp
# olsrd-dev: routing table import zwischen olsr1 <-> olsrd2




# cd /www; while :;do dd if=/dev/urandom of=test$(date +%s).bin bs=3k count=1;df -h;done


# mpc-hc
# spielt ab GNM - media player classic / 

/etc/dhcp-script.d/10dhc: stopwatch_stop() timefile '/tmp/STOPWATCH_tmpCRON_LASTCALL'... not found - abort


# smtp.sh -> remote_addr -> parse netstat?


# bday: jakob: 4. April

# detect webcam hotplug:
Wed Feb 24 09:15:09 CET 2016 1: usb ACTION: add DEVPATH: /devices/platform/ehci-platform/usb1/1-1 INTERFACE:  DEVICE: 
Wed Feb 24 09:15:09 CET 2016 1: usb ACTION: add DEVPATH: /devices/platform/ehci-platform/usb1/1-1/1-1:1.0 INTERFACE: 14/1/0 DEVICE: 
Wed Feb 24 09:15:09 CET 2016 1: input ACTION: add DEVPATH: /devices/platform/ehci-platform/usb1/1-1/1-1:1.0/input/input1 INTERFACE:  DEVICE: 
Wed Feb 24 09:15:09 CET 2016 1: usb ACTION: add DEVPATH: /devices/platform/ehci-platform/usb1/1-1/1-1:1.1 INTERFACE: 14/2/0 DEVICE: 
Wed Feb 24 09:15:09 CET 2016 1: usb ACTION: add DEVPATH: /devices/platform/ehci-platform/usb1/1-1/1-1:1.2 INTERFACE: 1/1/0 DEVICE: 
Wed Feb 24 09:15:09 CET 2016 1: usb ACTION: add DEVPATH: /devices/platform/ehci-platform/usb1/1-1/1-1:1.3 INTERFACE: 1/2/0 DEVICE: 



curl http://wttr.in/dallas

# detect this!:
# root@E1-mitteLinksINET-MESH:~ _db restore
Feb 18 10:54:50 ' [up 24464s 10660 bytes free] TERM:screen -ash [daemon.info] system_del_ramdisc() [OK] not mounted
Feb 18 10:54:55 ' [up 24468s 10716 bytes free] TERM:screen -ash [daemon.info] db_restore() try mounting '/tmp/kalua/storage/sda1_2.0G/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/device/DB/USER/login/DB/USER/device/DB/USER/device/DB/USER/device/DB' -> /database
Feb 18 10:54:55 ' [up 24469s 10620 bytes free] TERM:screen -ash [daemon.info] db_restore() will unarc '/www/cgi-bin/db_backup.tgz' to /database
tar: can't create directory 'database': I/O error
tar: can't make dir database/DB: No such file or directory
tar: can't create directory 'database/': I/O error
tar: can't make dir database/: I/O error
tar: can't create directory 'database/': I/O error
tar: can't make dir database/: I/O error
tar: can't create directory 'database/': I/O error
tar: can't open 'database/': Is a directory
Feb 18 10:54:55 ' [up 24469s 10156 bytes free] TERM:screen -ash [daemon.debug] scheduler_list_queue() working with option: ''
Feb 18 10:54:55 ' [up 24469s 10452 bytes free] TERM:screen -ash [daemon.alert] db_restore() [ERR] db_restore() rescheduling: untar of '/www/cgi-bin/db_backup.tgz' went wron
#
#




EJBW:
- backup-server:
  grep -q '172.17.0.22' '/etc/resolv.conf' || echo >'/etc/resolv.conf' 'nameserver 172.17.0.22'
- kalua: detect node32: unsymetric wired olsr
- Telefonnummer aendern: 141? -> 145 gehre / 827459 = fax -> Test!



https://github.com/koalaman/shellcheck/pull/594

# find / -xdev -exec stat -c '%y %N' {} \;
# 2012-11-23 15:44:51.000000000 +0100 `/home/tasso/.viminfo'

# find / -xdev -exec stat -c '%s %y %N' {} \;
# 21973 2013-04-30 09:12:25.000000000 +0200 `/etc/ld.so.cache'

TODO:
*** check bansin
*** check dhcp-renew on brutus
*** apply_profile: write to /tmp - so we can use another uci-path in case of error
root@OpenWrt:/ uci show network
uci: Entry not found
root@OpenWrt:/ echo $?
1

* iptables -A FORWARD -m connbytes --connbytes 600000: --connbytes-dir both --connbytes-mode bytes
*** corrupted /lib/preinit/99_10_failsafe_login when 'noSSH' + git revert brakes
*** router ralf
*** router frenze
*** wo ist das linksys-paket?
*** voip bluse
*** zusammenfassung stadttreffen
*** standardschreiben pdf freifunk
*** texte CVJM aendern
*** portfw extrawatt: https://wiki.mdex.de/Support/MdexDownloads
*** tasso/bigbrother: portfw VS img-src='http://user@pass:$IP ... ' - http://stackoverflow.com/questions/19244006/chrome-basic-auth-image-requests-return-401-but-not-when-called-directly
*** CVJM rules per client
*** aschbach/DB
*** alrik aufkleber
*** alrik DB
*** IFA: check pw zustand
*** ejbw/405: javascript: automatisch schliessen + mail - /var/www/fusionpbx/dial.php


- roaming: dhcp-release/ip-change: set static route/remove old route needed?
- mapapi: send clients
- openwrt-patch: which -> command -V -> Require
- patch: olsr: show interface
- loop-makro? -> _loop var i=5...0 { ... }
- ejbw: master: ip route add 192.168.112.0/24 via 172.17.0.1
- netcat-client: while read LINE; do sleep 1; echo $LINE; done | nc 192.168.1.1 23
- too much reboots: disable autoreboot_when_crash on bootup?
- tasso: jwplayer https://github.com/jwplayer/jwplayer vs. jplayer https://github.com/happyworm/jPlayer
- tc filter: conn_length?
- add_ramdisc: fix racy (sometimes double /coredumps or /database)
- failsafe: button: config random!
- TSF/Custom IE: NTP-timestamp? http://www.mail-archive.com/ath9k-devel@lists.ath9k.org/msg08746.html
  - http://comments.gmane.org/gmane.linux.drivers.ath9k.devel/9392
- shutdown hideandseek-vpn if no ping to neigh
- db: rollback-log?
- make build.sh output for https://wiki.openwrt.org/doc/howto/obtain.firmware.generate
  - make image PROFILE=XXX PACKAGES="XXX" FILES=files/
- cool: http://berlin.freifunk.net/network/stats/
- ipv4-sanitizer: e.g. 224.1.1.1/24 is wrong: https://lists.openwrt.org/pipermail/openwrt-devel/2016-February/039825.html
- detect jffs2-ready better
- wuschel: 746-inetoffer,720 -> luci + weimarnetz
- VoIP bluse
- lowering prio for internal traffic? 10.0.0.0 -> 10.0.0.0 or 100.x.x.x
- find calc freq2daempfung for wireless_events
- _db user login list last -> rc muss 0 sein, sonst restore()
- autoadd some files to keep-files: /www/wifimac
- holm: ekehau: site survey
- !!!! backup userdb to usb-stick if possible
- !!!! generic function flash_free not_enough
- letsencrypt POSIX
- monami: inetoffer -> Westseite-ProfBunsen + zram aus auf E2-buerooben-MESH? + portfw + IP
- Doku Bansin versenden
- Doku Bansin aktualisieren
- router DNT x3
- fix USB-storage fuer db/ibfleesensee - also /database points to USB-stick...
- sollstedt/router kiga hinschicken/hinbringen?
- anruf elektriker sbansin
- rehungen: termine eintragen
- IFA: zyxel / statistik senden / sprache statistik
- email umziehen
- teitzl rueckmeldung
- router fundus 2x2
- fake-update itzehoe + mail
- ICVPN: backup ssh-priv + pubkey
- bot for every strange OS i have (e.g. fetch webpage-oneliner in regular intervals)
  - and upload output via netcat or wget --get (server-cgi) or wget --POST
- OLSR: list in interface kann nur 1nen eintrag haben? -> bricht ab bei erstem nicht existenten interface

bansin:
- HWR -> hybrid
- hna4 0.0.0.0 aus!
- vpn zuenden
- roaming zuenden
- vpn-server muss IP-Schema kennen
- speed runter auf 7 und VPN auf 20?


- loader: introduce (fast?) substring() for posix-sh: e.g. substring 'bla:0:3'
  a='/my/long/path/to/file'
  expr "//$a" : '.*/\(.*\)'
  -> "file"
  expr also has a 'substring' statement
  http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man1/expr.1?query=expr
- userdb-gui: log ALL actions from IP
- monami: portfw userdb
- ute: alien-ip kann 192.168.0.1 nicht erreichen, aber traceroute zu 8.8.8.8 geht.


etc/dropbear/dropbear_rsa_host_key.pub
etc/dropbear/dropbear_rsa_host_key
etc/dropbear/dropbear_dss_host_key.pub
etc/dropbear/dropbear_dss_host_key
etc/dropbear/authorized_keys
etc/crontabs/�v���v���v���v���v��`v���v���
etc/crontabs/root
etc/crontabs/fi
...
-> keine files sichern mit komischen namen?


# TODO:
- letsencrypt: POSIX: https://github.com/lukas2511/letsencrypt.sh/issues/116
- disable busybox-ip if full-ip is built for 'small' images?
- opkg install vfork-error
- hangs: wget -T 3 -O- http://1.2.3.4:567 -> fixed, but good usecase
- zram disable?
- kalender: rechtzeitiges austragen bei netflix
- spbansin: doku verschicken
- tkolleg: forward im ipfire an?
- EJBW: termin (war 23. Jan) + telefon umklemmen demokratie e.v.
- vpn-server DE
- testVPN
- kabeltester-batterie?
- sms aufladen
- GNM: bilder aufklappen + mail
- GNM: IE -> link mit passwort?
- monitoring: sichern meshrdf/recent jeden tag + backup
- fix schoeneck /database-issue
- echo 1 >/sys/kernel/debug/ieee80211/phy0/ath9k/disable_ani
- echo 0 >/sys/kernel/debug/ieee80211/phy0/ath9k/ani
- dnsmasq -> lookup youtube.com -> ipset -> use it


# Variables without spaces: https://github.com/koalaman/shellcheck/blob/master/ShellCheck/Data.hs#L38

# test: qemu-system-mipsel -M malta -hda openwrt-malta-le-root.ext4 -kernel openwrt-malta-le-vmlinux.elf -nographic -append "root=/dev/sda console=ttyS0"


- rechnung kamera aktualisieren GNM?

# showstopper:
# - network.@switch[0].reset='1' -> can hang -> https://dev.openwrt.org/ticket/22024 + https://dev.openwrt.org/ticket/19630
# - wait till patches are merged: peak cal for all ar9300 chips
# - patch: minstrel: Scale expected_throughput by 10 (1. Feb. Sven Eckelmann) -> 2.Feb applied
# - ath9k: fixes for NoiseFloor (2x)
# - olsrd crashs on shutdown
# - zram: crashes - https://dev.openwrt.org/ticket/21705
# - ag71xx/irqstorm: https://dev.openwrt.org/ticket/18922#comment:35
# - low performance eth0/eth1: https://dev.openwrt.org/ticket/21624
# - nslookup -> hostip oder was anderes - musl new dns? https://dev.openwrt.org/ticket/18333
# - dnsmasq: Regression: dnsmasq replies to forwarded query too early when receiving REFUSED response from upstream server
## - telnet ins image?
## - sysctl -w kernel.print-fatal-signals=1
## - ap-isolate default on? https://dev.openwrt.org/ticket/21767#comment:1
## - serial-console deaktivieren: askfirst -> inittab

# Acked-by: Bastian Bittorf <bittorf@bluebottle.com>

- mutt-git
  - server holt mails
  - fuer jede mail einzeln einen git-commit
  - client holt git
  - lesen + loeschen + taggen
  - git commit auf client?

# lqmult-faktor: apply for all interfaces?


# compatible: ???
# SCRIPTDIR=$(dirname $(cd -P -- "$(dirname -- "$0")" && printf '%s\n' "$(pwd -P)/$(basename -- "$0")"))

# wireless-kick: anderer treshold bei 5ghz, e.g. -85?

# GNM: MOSCHIP usb-ethernet driver 8-1:1.0 eth1: register 'MOSCHIP usb-ethernet driver' at usb-0000:00:1d.7-1, MOSCHIP 7830/7832/7730 usb-NET adapter, 00:60:6e:01:2a:03

# malchowit: zimmer mellentin: tickets laufen nicht ab?
# busybox: bugreport 'ip n' <-> arp

# NM5: http://www.aredn.org/content/ubiquiti-airos-56-alert-0
# nodenumber-roaming: avoid clash >256
# patch: authorized.keys beimbooten
# test fake radius

# dropbear crash wenn:
ssh fe80::56e6:fcff:fea7:c086%eth0.1


# https://dev.openwrt.org/ticket/21738: iptables -t filter -I FORWARD -m conntrack --ctstate INVALID -j REJECT


# mac is wrong for 10.63.44.225 -> dc:9f:db:0c:c8:aa = false (from ip avove 10.63.160.129)
  # the 2nd occurrence if correct:  dc:9f:db:0d:c8:c5
# mac is wrong for 10.63.44.193 -> 64:66:b3:00:02:77 = false (from ip above 10.63.22.125)
  # (the same node, but wifi - not directly reachable so: dc:9f:db:0d:c8:c5)

root@f36-longshot-schlacht:~ ip n
10.63.4.33 dev eth0 lladdr 00:13:10:14:c4:fc used 0/0/0 probes 1 STALE
10.63.44.193 dev eth0 lladdr dc:9f:db:0d:c8:c5 used 0/0/0 probes 0 STALE
10.63.160.129 dev wlan0 lladdr dc:9f:db:0c:c8:aa ref 1 used 0/0/0 probes 1 REACHABLE
10.63.44.225 dev wlan0 lladdr dc:9f:db:0c:c8:aa used 0/0/0 probes 6 FAILED
10.63.195.161 dev eth0 lladdr 00:10:75:2d:81:be used 0/0/0 probes 4 STALE
10.63.21.97 dev eth0 lladdr 00:18:84:88:65:98 ref 1 used 0/0/0 probes 1 REACHABLE
10.63.44.225 dev eth0 lladdr 00:18:84:88:65:98 used 0/0/0 probes 6 FAILED
10.63.160.161 dev wlan0 lladdr dc:9f:db:0c:c8:aa used 0/0/0 probes 6 STALE
10.63.82.125 dev eth0 lladdr f4:ec:38:9d:7a:1e ref 1 used 0/0/0 probes 1 DELAY
10.63.22.125 dev eth0 lladdr 64:66:b3:00:02:77 ref 1 used 0/0/0 probes 1 REACHABLE
10.63.44.193 dev wlan0 lladdr 64:66:b3:00:02:77 used 0/0/0 probes 6 FAILED
fe80::213:10ff:fe14:c4fc dev eth0 lladdr 64:66:b3:00:02:77 used 0/0/0 probes 6 FAILED
fe80::de9f:dbff:fe0d:c8c5 dev eth0 lladdr 64:66:b3:00:02:77 router ref 1 used 0/0/0 probes 6 INCOMPLETE
fe80::218:84ff:fe88:6598 dev eth0 lladdr 00:18:84:88:65:98 router used 0/0/0 probes 4 STALE
fe80::213:10ff:fe14:c4fc dev wlan0 lladdr 00:18:84:88:65:98 used 0/0/0 probes 6 FAILED
fe80::6666:b3ff:fe00:277 dev eth0 lladdr 64:66:b3:00:02:77 router ref 1 used 0/0/0 probes 1 REACHABLE

root@f36-longshot-schlacht:~ cat /proc/net/arp 
IP address       HW type     Flags       HW address            Mask     Device
10.63.4.33       0x1         0x2         00:13:10:14:c4:fc     *        eth0
10.63.44.193     0x1         0x2         dc:9f:db:0d:c8:c5     *        eth0
10.63.160.129    0x1         0x2         dc:9f:db:0c:c8:aa     *        wlan0
10.63.44.225     0x1         0x0         00:00:00:00:00:00     *        wlan0
10.63.195.161    0x1         0x2         00:10:75:2d:81:be     *        eth0
10.63.21.97      0x1         0x2         00:18:84:88:65:98     *        eth0
10.63.44.225     0x1         0x0         dc:9f:db:0d:c8:c5     *        eth0
10.63.160.161    0x1         0x2         dc:9f:db:0c:c8:aa     *        wlan0
10.63.82.125     0x1         0x2         f4:ec:38:9d:7a:1e     *        eth0
10.63.22.125     0x1         0x2         64:66:b3:00:02:77     *        eth0
10.63.44.193     0x1         0x0         00:00:00:00:00:00     *        wlan0



# IPv6 / linklocal / zone-id / workaround: ssh -L '8080:[fe80::209:5bff:fede:ad02%eth0]:80' user@router

# freifunk: extend Ideas - http://wiki.freifunk.net/Ideas#Automatic_Network_Configuration



# fix missing /etc/rc.common auf vpn-server

# /tmp/LOCKFILE_APPLY -> weg / scheduler + db_restore

olsr_build_tables() bad: remote: 10.10.12.1 cost: INFINITE


# busybox:
ip neigh add|change|replace -> not implemented!


# somehow mark user_add which comes not in via DHCP? -> drucker

# mail an gera / kommune4.0

config 'LoadPlugin'                                                                            
        option 'library' 'olsrd_nameservice.so.0.3'
        option 'ignore' '0'                  
        option 'hosts_file' '/var/etc/hosts'                                         
        option 'suffix' '.olsr'
        option 'interval' '180'
        option 'timeout' '3600'            
        option 'latlon_file' '/var/run/latlon.js'                                
        option 'latlon_infile' '/var/run/latlon.txt'
provide: latlon


# dnsmasq: option3 = gateway, option6: dns

# compress URL:
# 0-9 A-Z a-z .:,;+*-_/()$=!@?~' -> base80
#  10 +26 +26 +18 = 80
# numbers, e.g. unixtime -> longint?
# http://cs.stackexchange.com/questions/29809/using-base-80-for-compressing-files
# http://stackoverflow.com/questions/2996049/how-to-compress-decompress-a-long-query-string-in-php

# ( sleep 100 ) 200>bla
# ls -1 /proc/22187/fd
# readlink /proc/22187/fd/200
# preinit: flock: invalid number '/tmp/tmp.ahbhoi' -> filen from 'mktemp'


# VPN:server: http://3.v.weimarnetz.de/freifunk/vpn/

# idee: eingesteckter USB-stick -> audiofiles -> radiosender-stream (icecast?)

# Tulpe: WTF? /usr/sbin/cron.monitoring: watch_hanging_command() killing '/usr/sbin/rsyslogd'

# Deluxe Rock: http://tunein.com/radio/Deluxe-Rock-s183707/
# Harrison Ford - auf der Flucht?
# BladERunner

# dropbear-patch: Child connection from fe80::224:7eff:fe12:72f3%br-lan:54722
#
# fail2ban: patch dropbear -> script when failed from IP
  # Login attempt for nonexistent user from $IP:$PORT
  # Bad password attempt for 'root' from $IP:$PORT
svr-auth.c:                             "Login attempt for nonexistent user from %s",
svr-auth.c:                             "Login attempt with wrong user %s from %s",
svr-authpam.c:                          "Bad PAM password attempt for '%s' from %s",
svr-authpam.c:                          "Bad PAM password attempt for '%s' from %s",
svr-authpasswd.c:                               "Bad password attempt for '%s' from %s",

# handyupdate:
# http://download.cyanogenmod.org/?device=crespo
# http://www.android-hilfe.de/forum/custom-roms-fuer-nexus-s.347/?direction=desc
# http://alchemistar.blogspot.de/2011/01/google-nexus-s-custom-rom-list.html


# definitions: SSID_AP + SSID_MESH

# dell2300 / meyer23 updaten

# teitzel: IP

# always make sure 'rm' is invoked with '-f', otherwise it can hang (e.g. readonly)
# root@EG-bastianHQ:~ rm /www/keep/coredumps/r47603.ar71xx.ip.*
rm: remove '/www/keep/coredumps/r47603.ar71xx.ip.1075.10.1448962860.core'? ^C



# https://github.com/davidshimjs/qrcodejs

# missing /etc/config/network -> trigger firstboot? + apply_profile + enforce IPv6?



# roaming-klasse fuer netzweites mac-addressen dingsi / unsplash

# kernel 4.3.0 is wrong age in monitoring?!

# konzept gesucht:
# auf medion:
# scp root@intercity-vpn.de:/root/.ssh/authorized_keys /home/bastian/.ssh/authorized_keys.ICVPN
# cat .ssh/authorized_keys.* >.ssh/authorized_keys

# klingonisch: http://www.klingonisch.net/d/index.html

# mail: medion: alle akzeptieren

# idea: /rom exists? ->we have squashfs/jffs2

# nachschauen: schroeder = schneller?

# reactivate fakedns - it works!

# name the adhoc-interface 'ibss0' instead of 'wlan0'?

# paltstadt + monami + palais -> 10.64.x.x


UML-crash: (since a long time - here r47958
[    0.340000] Console initialized on /dev/tty0
[    0.340000] console [tty0] enabled
[    0.340000] Initializing software serial port version 1
[    0.340000] console [mc-1] enabled
[    0.340000] Computing a digest to use as ethernet address for device eth8
[    0.340000] Netdevice 8 (b2:69:8f:a3:40:a6) :
[    0.340000] TUN/TAP backend - IP = 192.168.0.254
[    0.340000] ------------[ cut here ]------------
[    0.340000] WARNING: CPU: 0 PID: 1 at drivers/base/dd.c:184 deferred_probe_initcall+0x60/0xb0()
[    0.340000] Modules linked in:
[    0.340000] CPU: 0 PID: 1 Comm: swapper Not tainted 4.1.13 #2
[    0.340000] Stack:
[    0.340000]  00000000 00000000 00000000 603afb9e
[    0.340000]  6047a9cb 6003bb40 60560300 6006f623
[    0.340000]  00000001 60548870 63774c00 60548870
[    0.340000] Call Trace:
[    0.340000]  [<60032b95>] ? os_is_signal_stack+0x15/0x30
[    0.340000]  [<603afb9e>] ? printk+0x0/0x9b
[    0.340000]  [<60222600>] ? deferred_probe_initcall+0x60/0xb0
[    0.340000]  [<6001d1ad>] ? show_stack+0x12d/0x1b0
[    0.340000]  [<603afb9e>] ? printk+0x0/0x9b
[    0.340000]  [<6003bb40>] ? warn_slowpath_common+0xe0/0x120
[    0.340000]  [<6006f623>] ? mod_timer+0x173/0x1a0
[    0.340000]  [<601ee3b0>] ? strcmp+0x0/0x30
[    0.340000]  [<602225a0>] ? deferred_probe_initcall+0x0/0xb0
[    0.340000]  [<60222600>] ? deferred_probe_initcall+0x60/0xb0
[    0.340000]  [<6001a309>] ? do_one_initcall+0x139/0x230
[    0.340000]  [<60056c06>] ? parse_args+0x276/0x3e0
[    0.340000]  [<6001a1d0>] ? do_one_initcall+0x0/0x230
[    0.340000]  [<601ee310>] ? strcpy+0x0/0x30
[    0.340000]  [<60000f39>] ? kernel_init_freeable+0x1b0/0x292
[    0.340000]  [<600003d0>] ? repair_env_string+0x0/0xb4
[    0.340000]  [<6005b453>] ? finish_task_switch+0x43/0xc0
[    0.340000]  [<603ad5cd>] ? kernel_init+0xd/0x160
[    0.340000]  [<6001be62>] ? new_thread_handler+0x82/0xb0
[    0.340000] 
[    0.340000] ---[ end trace 1c9c0c4a9a1cda20 ]---
[    0.340000] EXT4-fs (ubda): couldn't mount as ext3 due to feature incompatibilities
[    0.340000] EXT4-fs (ubda): couldn't mount as ext2 due to feature incompatibilities
[    0.340000] EXT4-fs (ubda): mounted filesystem without journal. Opts: (null)
[    0.340000] VFS: Mounted root (ext4 filesystem) readonly on device 98:0.

# todo: 2 x webcam -scp?

# TODO: test all olsr-subfunc for git?

# support for html-error-code 451?

# monitoring: switch: show red if no ipv6 ping

# leipzig: rother: prospekt/jakob





# rother: admin-mail an PC_Luense

#  konnekteueber kueche: mrate=1000
wireless.@wifi-iface[3].device=radio1
wireless.@wifi-iface[3].network=wlanRADIO1
wireless.@wifi-iface[3].disassoc_low_ack=0
wireless.@wifi-iface[3].ssid=Schnelle PC Hilfe 5 GHz
wireless.@wifi-iface[3].mode=sta
wireless.@wifi-iface[3].key=Flugzeug987654!
wireless.@wifi-iface[3].disabled=0
wireless.@wifi-iface[3].encryption=psk2



vpn-server: logread missing

# track ap: ip-wechsel

iw phy pyh0 interface add mon0 type monitor
tcpdump -i mon0 -s 200 -tt -w /tmp/test.pcap



# mail: ejbw: secosys

# profile.d: show active ap-clients

# cron.add ... lock-login: only once alert

# weihnachtfeier-mail

# roaming: track avg-sig of each station each minute and kick if needed

# 2xvpn-server up

# travis: use cache for custom installs:
  - https://docs.travis-ci.com/user/caching/
  - remove cache when new shellsheck arrives in git

# use POSIX readlink: http://stackoverflow.com/questions/29832037/how-to-get-script-directory-in-posix-sh

# apply_profile: abort if nodenumber invalid for ip_system

# simon/openvpn

# vtund: type 'tun'? nolzo? -> short asking /json/ server, which version/which port
# ask via netcat special dns-server for entry-URL/port?

# mail: 2x Telefon: secosys

#  @webis5.medien.uni-weimar.de
# riso3860 betaweb135.medien.uni-weimar.de
# EjReshAcDayheshrojio

# chromecast audio: Squeezelite und Logitech Media Server.

# idea: wget: first start listener in background & and then wget

# test schwaches pw: mkpasswd needed

# check: wird pmu wirklich direkt nach boot gemacht? ->check scheduler-table first run

# after reboot check more strict (once) if we really can download something from internet -> otherwise Wartungsmode

# S70prepare: http://127.0.0.1/cgi-bin/luci -> 401?

# monitoring: longshot, aber kein funknachbar: rot
# monitoring: longshot, aber defroute nicht ueber funk: rot

# ejbw: api -> extentsion X waehle nummer Y
# ejbw: https-cert
# ejbw: auf master: iptables -I INPUT -p tcp -i $WANDEV --dport 22 -s 172.17.0.0/22 -j ACCEPT
# ejbw: https erzwingen ausgeschaltet...: /etc/nginx/sites-available/fusionpbx - auskommentiert: rewrite ^(.*) https://$host$1 permanent;


# IFA
# monitoring:
# - alter des git in tagen
# - schnellinfo, wieviel clients in letzten 15mins
# datenbank auf 231 machen
# vorschlag optimierungsrecher in RZ 
# portforwarding scheint auf 192.168.2.107 zu gehen (alias aendern?)
# - evtl. ist die 107 auf die per DHCP bezogene Adresse
#
# WebUI: Telekom-Master: pass = 08460851
# - Zugangsnummer: 551112888025 ("T-Online Nummer")
# - Kennwort: 71618140
# - Anschlusskennung: 002115159108
#
# WebUI: Telekom-Ersatz: pass = 56006535
# - PortFW auf die 192.168.2.100 (!!!)
#
# NetIO-230b = http://10.10.2.34/ -> user: admin pass: admin -> version 4.0
# alle Ports gehen an, beim einschalten


# _net_ping6 -> auto ff02::1%$LAN


# HTTPS / uhttpd:
- check: openssl s_client -connect example.com:443 -ssl3
- https://gethttpsforfree.com/
#
- openssl rsa -in yourkeyfile.pem -outform DER -out uhttpd.key
#
- cat "Signed Certificate:" + "Intermediate Certificate:" >cert.pem
- openssl x509 -in cert.pem -outform DER -out uhttpd.crt
#
# upload uhttpd.key + uhttpd.crt

# muenchen: bildschirm sofort schwarz? dpms?

# komische files:
# ls -la /var/www/networks/apphalle/meshrdf/


# EJWB: fax send / mail
# ls -lt /usr/local/freeswitch/storage/fax/3000/inbox|grep 557-|more

# update: mark "already installed" with 0 - and the clients will not install it, except configured

# dbGUI: explain -2 and -3

# check admin-pw:
# https://github.com/weimarnetz/weimarnetz/issues/187#event-479470882

# mini-json-monitoring

ubus call system board
ubus listen

# ejbw:
 - auf master: ip route add 192.168.112.0/24 via 172.17.0.1
 - auf 43 anderer DNS: 172.17.0.21 + 172.17.0.22

# USB 5m
# Fahrrad-Clip x 2
# braunes/rotes nwk


# https://de.wikipedia.org/wiki/Slowloris

root@fonera2n:~ nslookup krautchan.net
Server:    127.0.0.1
Address 1: 127.0.0.1 localhost

Name:      krautchan.net
Address 1: 104.28.3.14
Address 2: 104.28.2.14
root@fonera2n:~ nslookup krautchan.net 208.67.222.123
Server:    208.67.222.123
Address 1: 208.67.222.123 resolver1-fs.opendns.com

Name:      krautchan.net
Address 1: ::ffff:146.112.61.106
Address 2: 146.112.61.106 hit-adult.opendns.com






Mon Nov 23 08:59:02 2015 daemon.info kalua: /bin/sh: system_del_ramdisc() [OK] not mounted
Mon Nov 23 08:59:02 2015 daemon.info kalua: /bin/sh: system_add_ramdisc() adding ramdisk /database of size 28991488
Mon Nov 23 08:59:02 2015 daemon.info kalua: /bin/sh: db_restore() will unarc '/www/cgi-bin/db_backup.tgz' to /database
Mon Nov 23 08:59:05 2015 daemon.info kalua: /bin/sh: db_restore() [OK] untar
Mon Nov 23 08:59:05 2015 daemon.info kalua: /bin/sh: db_restore() [OK] restructure path
Mon Nov 23 08:59:25 2015 kern.info kernel: [  147.891463]
Mon Nov 23 08:59:25 2015 kern.info kernel: [  147.891463] do_page_fault(): sending SIGSEGV to sh for invalid read access from 36323134
Mon Nov 23 08:59:25 2015 kern.info kernel: [  147.899668] epc = 36323135 in libgcc_s.so.1[77d14000+22000]
Mon Nov 23 08:59:25 2015 kern.info kernel: [  147.905334] ra  = 0041ce81 in busybox[400000+4e000]
Mon Nov 23 08:59:25 2015 kern.info kernel: [  147.910302]
Mon Nov 23 08:59:25 2015 kern.info kernel: [  148.021929]
Mon Nov 23 08:59:25 2015 kern.info kernel: [  148.021929] do_page_fault(): sending SIGSEGV to sh for invalid read access from 00706964
Mon Nov 23 08:59:25 2015 kern.info kernel: [  148.030150] epc = 00706964 inra  = 00706964 in
Mon Nov 23 08:59:25 2015 kern.info kernel: [  148.034640]
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.557697]
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.557697] do_page_fault(): sending SIGSEGV to gzip for invalid read access from 00000000
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.566145] epc = 00000000 in busybox[400000+4e000]
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.571172] ra  = 00000000 in busybox[400000+4e000]
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.576100]
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.907487]
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.907487] do_page_fault(): sending SIGSEGV to iw for invalid read access from 007d7280
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.915940] epc = 007d7280 inra  = 77872329 in libnl-tiny.so[77870000+15000]
Mon Nov 23 08:59:26 2015 kern.info kernel: [  148.923505]
Mon Nov 23 08:59:28 2015 kern.info kernel: [  151.149709]
Mon Nov 23 08:59:28 2015 kern.info kernel: [  151.149709] do_page_fault(): sending SIGSEGV to uhttpd for invalid read access from 0091bfc8
Mon Nov 23 08:59:28 2015 kern.info kernel: [  151.158303] epc = 77471c23 in libubox.so[7746e000+17000]
Mon Nov 23 08:59:28 2015 kern.info kernel: [  151.163677] ra  = 77471bfb in libubox.so[7746e000+17000]
Mon Nov 23 08:59:28 2015 kern.info kernel: [  151.169206]



# tests: text2port() collision?

# ffweimar: fetch JSON or minimal monitoring?

# repair http://intercity-vpn.de/networks/error

# TODO: test all possible userdb-HTML output (first: a walkthrough for humans, later 'html-tidy')
  - startseite/passwortabfrage:
    - http://10.63.21.97/cgi-bin/userdb
  - uebersicht:
    - http://10.63.21.97/cgi-bin/userdb
      oder
    - http://10.63.21.97/cgi-bin/userdb?FORM_AUTH_USER=root&FORM_AUTH_PASS=fm1204&submit=Login
  - profile bearbeiten:
    - http://10.63.21.97/cgi-bin/userdb?FORM_ACTION=profile_update&FORM_ID=1
  - logins
    - hinzufuegen:
      - http://10.63.21.97/cgi-bin/userdb?FORM_ACTION=login_add
    - anzeigen: alle:
      - http://10.63.21.97/cgi-bin/userdb?FORM_ACTION=login_show&FORM_RANGE_METHOD=all
    - anzeigen: neuesten 32:
      - http://10.63.21.97/cgi-bin/userdb?FORM_ACTION=login_show&FORM_RANGE_METHOD=last&FORM_RANGE_KEYWORD=32
    - suche muster: nur fuer 1 profil: (":" -> macs)
      - http://10.63.21.97/cgi-bin/userdb?FORM_ACTION=login_search&FORM_SEARCH_PATTERN=%3A&FORM_PROFILE_ID=1
    - suche muster: fuer all profile:
      - http://10.63.21.97/cgi-bin/userdb?FORM_ACTION=login_search&FORM_SEARCH_PATTERN=%3A&FORM_PROFILE_ID=

# friend-monitoring:
# shout out: please be my friend (linklocal/1hop?)
# somebody sees it and agrees (1...up to 2 friends or even X?)
# send email, when friend goes away


# rules for traceroute = perfekt DSCP
# http://lartc.org/howto/lartc.adv-filter.html
# "Packet will match to this rule, if its time to live (TTL) is 64. TTL is the field starting just after 8-th byte of the IP header."
# http://www.netfilter.org/documentation/HOWTO/netfilter-extensions-HOWTO-3.html
# "Check the value of a 1 byte field"


# also: earlyboot_netparam() store initial version: WIFIDEV=''

# weimarnetz/dyndns ueberall?

audiostudio (Parkseite) ---> RH-Sofia-MESH ---> F2.2 ---> 10.10.46.1
root@(none):/# uptime
 04:47:45 up 76 days,  4:47,  load average: 0.00, 0.01, 0.04
root@(none):/# ip a
1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN group default 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether d8:5d:4c:f6:2f:9e brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.1/24 brd 192.168.1.255 scope global eth0
       valid_lft forever preferred_lft forever



# convert mydesign-stuff
# http://www.cyberciti.biz/faq/unix-linux-sed-ascii-control-codes-nonprintable/
# http://www.fileformat.info/info/unicode/char/00e0/index.htm

json_init
json_add_string name "_adblock"
json_add_string ifname "eth0"
json_add_string proto "static"
json_add_array ipaddr
json_add_string "" "1.2.3.4"
json_close_array
json_close_object
ubus call network add_dynamic "$(json_dump)"


- monami: alles auf die 9
- tasso: hangs after: too much load: '177' - rebooting -> crashreboot?
- dropbear banner prob

# remove all '# shellcheck disable=SC2034' when fixed: https://github.com/koalaman/shellcheck/issues/477


# Dorfhotel Fl Wartungsmodus 21/0

# Huawei E398 (erhältlich als Vodafone K5005 & Telekom Speedstick LTE)

# weih:
# - WC
# - Wohnz
# - GewueReg x 3
# - lichtKue/dimm
# - fotokal

root@abtpark-hybrid--5:~ cat /www/monitoring.wifimac 
14cc20ed24ed


# rose!
# drittanbietersperre
# SIP evernet

telegram:
 - https://github.com/vysheng/tg/issues/48
 - https://github.com/mikeadamz/telebot
 - https://github.com/area31/Telegram-api-msg-bot/blob/master/send-msg-telegram

# ----------------------

# LTE-Modem:
# cat /sys/kernel/debug/usb/devices
T:  Bus=01 Lev=02 Prnt=02 Port=00 Cnt=01 Dev#=  3 Spd=480  MxCh= 0
D:  Ver= 2.00 Cls=00(>ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=  1
P:  Vendor=12d1 ProdID=14c3 Rev= 0.00
S:  Manufacturer=Vodafone Group (Huawei) 
S:  Product=Vodafone Mobile Broadband (Huawei) 
C:* #Ifs= 2 Cfg#= 1 Atr=c0 MxPwr=500mA
I:* If#= 0 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage
E:  Ad=81(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=01(O) Atr=02(Bulk) MxPS= 512 Ivl=0ms
I:* If#= 1 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage
E:  Ad=02(O) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=82(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms






# intercity-vpn.de 84.38.67.43 -> 198.23.155.210

# ejbw/kuerzere pause bis AB

# does it work? --hwardware X --info?
# first run
# first start
# do not check hw
#
# please run: 'mkdir openwrt_download' before starting this script



# android kiosk system? zurueck + menu-taste + kontexttaste totlegen
  - root?
  - reboot?
  - busybox?

# bullet versenden: rehungen 106/107?

# idee: automatisierte Nachrichtensendung beim git-checkin, unterschiedliche sprecher und anderer applaus (je nach change-impact)

# x86_64/qemu: -> mit 4.1 nochmal schauen
# [ 4181.017348] rm[25456]: segfault at 3 ip 0000000000000003 sp 00007fffb88e5718 error 14 in busybox[400000+5a000]
# [ 1972.621758] grep[12377]: segfault at 0 ip 00007f6eec306c08 sp 00007ffc8e9b0600 error 4 in libc.so[7f6eec2bb000+65000]
# [10430.688218] which[597]: segfault at 3 ip 0000000000000003 sp 00007ffdb7e74e08 error 14 in busybox[400000+5a000]
# [13204.227236] sleep[18629]: segfault at 0 ip           (null) sp 00007ffc3969dfe8 error 14 in busybox[400000+5a000]

# REMOTE=10.63.42.125
# wget -O - "http://$REMOTE/cgi-bin-tool.sh?OPT=notebookconf&IPWIZARD=ERR;\$(/sbin/reboot)+ZZZ=22222"

# radioshow / battlemesh / IPFS : 
  http://wcbn.org - 6 AM thuesday morning - Michigan/near detroit - 14.00

# paxos-alghorithm
  -raft

# Ubiquiti Bullet r46298 with read errors in JFFS2 - only comes up in failsafe mode (but mount_root works)
#
# root@(none):/# find /usr -type f
# /bin/ash: find: I/O error
#
# /bin/busybox find /usr -type f
# -> OK
#
# a lot of symlinks where missing, so repairing was (a little bit) possible with:
# cd /bin; for i in $(./busybox --list); do ln -s busybox $i; done
#
# dmesg:
[    5.740000] random: procd urandom read with 9 bits of entropy available
[    8.280000] eth0: link up (100Mbps/Full duplex)
[   40.990000] jffs2: error: (366) jffs2_build_inode_pass1: child dir "#81498440" (ino #730) of dir ino #722 appears to be a hard link
[   41.000000] jffs2: notice: (366) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[   41.020000] mount_root: switching to jffs2 overlay
[   42.780000] jffs2: warning: (354) jffs2_get_inode_nodes: Eep. No valid nodes for ino #730.
[   42.790000] jffs2: warning: (354) jffs2_do_read_inode_internal: no data nodes found for ino #730
[   42.800000] jffs2: iget() failed for ino #730
[   45.530000] jffs2: warning: (354) jffs2_get_inode_nodes: Eep. No valid nodes for ino #730.
[   45.540000] jffs2: warning: (354) jffs2_do_read_inode_internal: no data nodes found for ino #730
[   45.550000] jffs2: iget() failed for ino #730
[   58.250000] jffs2: warning: (354) jffs2_get_inode_nodes: Eep. No valid nodes for ino #730.
[   58.260000] jffs2: warning: (354) jffs2_do_read_inode_internal: no data nodes found for ino #730
[   58.270000] jffs2: iget() failed for ino #730
[   73.550000] random: nonblocking pool is initialized
[  124.910000] jffs2: warning: (354) jffs2_get_inode_nodes: Eep. No valid nodes for ino #730.
[  124.920000] jffs2: warning: (354) jffs2_do_read_inode_internal: no data nodes found for ino #730
[  124.920000] jffs2: iget() failed for ino #730
[  125.100000] jffs2: warning: (354) jffs2_get_inode_nodes: Eep. No valid nodes for ino #730.
[  125.110000] jffs2: warning: (354) jffs2_do_read_inode_internal: no data nodes found for ino #730
[  125.120000] jffs2: iget() failed for ino #730



# aboriginal linux
# build.sh mipsel
# ./dev-env.sh
#
### TODO: activate zram
#
# mkdir /home/bin
# export PATH="/home/bin:$PATH:/usr/local/bin"
# ln -s /home/bin /usr/local/bin
# unset DISTCC_HOSTS; export DISTCC_HOSTS
#
# mount -t tmpfs -o size=128000000,nosuid,nodev,mode=1777 tmpfs /tmp
#
# after each compile: (or raise size of initial disk?)
# mv /usr/local/bin/* /home/bin
# TODO: build everything in ramdisc
#
# wget m4		ftp://ftp.gnu.org/gnu/m4/m4-1.4.9.tar.gz
# wget binutils		http://ftp.gnu.org/gnu/binutils/binutils-2.25.tar.gz
# wget perl		http://www.cpan.org/src/5.0/perl-5.22.0.tar.gz
	sed -i 's/usenm=true/usenm=false/g' 'Configure'
	./Configure -des
# wget autoconf		ftp://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.gz
	wget -O build-aux/config.guess "http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.guess;hb=HEAD"
	wget -O build-aux/config.sub   "http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.sub;hb=HEAD"
# wget openssl		ftp://ftp.openssl.org/source/openssl-1.0.2c.tar.gz
	./config
	make depend
	make all
	make install
	export PATH="$PATH:/usr/local/ssl/bin"
# wget zlib		http://zlib.net/zlib-1.2.8.tar.gz			-> OK
#
# wget libtool		ftp://ftp.gnu.org/gnu/libtool/libtool-2.4.tar.gz	-> OK
	./configure
	sed -i 's/^\\/ /g' libtool

# wget libiconv		http://ftp.gnu.org/pub/gnu/libiconv/libiconv-1.14.tar.gz -> OK
	./configure
	# find . -name libtool
	sed -i 's/^\\/ /g' ...
#
# wget gettext		ftp://ftp.gnu.org/pub/gnu/gettext/gettext-0.19.tar.gz
	./configure --with-libiconv-prefix=/usr/local/include
	# find . -name libtool | while read LINE; do echo "$LINE"; sed -i 's/^\\/ /g' "$LINE"; done
	sed -i 's/^\\/ /g' ./gettext-tools/libtool
	sed -i 's/^\\/ /g' ./gettext-runtime/libtool
	sed -i 's/^\\/ /g' ./gettext-runtime/libasprintf/libtool
	
	
# wget git		http://github.com/git/git/archive/v2.4.8.tar.gz
	make configure
	make


# 192.168.1.222 = 24:A4:3C:E6:1E:CE = ewerk = AP = Channel/Frequency: 39 / 5195 MHz @ 10 mhz = NanoBeamM5
# 192.168.1.20  = 24:A4:3C:E6:DB:53 = client/ewerkseite? = NanoBeamM5
# 192.168.3.20  = 24:a4:3c:8e:a7:dc = fe80::26a4:3cff:fe8e:a7dc = wagenplatz = AP WDS = Channel/Frequency:60 / 5300 MHz @ 5 MHz = NanoBridge
# 192.168.3.30  = 04:18:D6:EC:3F:30 = wagenplatz = client/BAMAGseite = ...

# auf 10.63.34.225
#
iptables -t nat -I PREROUTING -p tcp --dport 10443 -j DNAT --to-destination 192.168.1.222:443
iptables -t nat -I PREROUTING -p tcp --dport 11443 -j DNAT --to-destination 192.168.1.20:443
iptables -t nat -I POSTROUTING -d 192.168.1.0/24 -j MASQUERADE
iptables -t nat -I PREROUTING -p tcp --dport 30443 -j DNAT --to-destination 192.168.3.20:443
iptables -t nat -I PREROUTING -p tcp --dport 31443 -j DNAT --to-destination 192.168.3.30:443
iptables -t nat -I POSTROUTING -d 192.168.3.0/24 -j MASQUERADE


# 1=unbestimmt, 2=1043, 3= wzr,4=nano,5=4300er,6=4900erPUTT,7=703er,8=bulletM,9=TP-LINK TL-WR841N/ND v8

# F='all.tar.bz2'; mkdir -p moni-html; cd moni-html; wget -O $F http://intercity-vpn.de/files/$F; tar xjf $F; cd ..
# F='all.tar.xz';  mkdir -p moni-html; cd moni-html; wget -O $F http://intercity-vpn.de/files/$F; tar xJf $F; cd ..
# F='all.tar.bz2'; mkdir -p moni-html; cd moni-html; wget -O $F http://172.30.0.1/files/$F; tar xjf $F; cd ..
# F='all.tar.bz2'; mkdir -p moni-html; wget -O moni-html/$F http://intercity-vpn.de/files/$F && tar xjf $F

# GW=fe80::fad1:11ff:fea9:b688%eth0
# while :;do ping -c1 -W1 -q -6 $GW >/dev/null && break; date;done; ssh $GW 'sed -i "s|/bin/echo|return;|" /etc/kalua/system'
# ip neigh change 192.168.1.1 dev eth0 lladdr b0:48:7a:c5:db:9a nud permanent

# ubus -v list lxc
# ubus call lxc list
# ubus call lxc stop 'json-name'

# ubus call service list '{"name":"dnsmasq"}'
# ubus call service list '{"name":"dnsmasq"}' | jsonfilter -e '@.*.instances.instance1.running'

# using channel below 1 http://yo3iiu.ro/blog/?p=1301

# try openwrt-compile on IBM Power8 with FORCE=1 -> https://patchwork.ozlabs.org/patch/497539/

# openwrt/routing:
# git checkout origin/for-15.05
# ...changes...
# commit
# git push origin HEAD:for-15.05
#
# git checkout origin/for-14.07
# ...

# http://xaychru.com/games/AlienCrab.html

# jffs2-putt: sysupgrade:
# uci add system profile


# uci set system.@profile[-1].nodenumber=266
# uci set system.@profile[-1].profile=liszt28_hybrid


[   35.750000] block: attempting to load /tmp/jffs_cfg/upper/etc/config/fstab
[   35.760000] block: extroot: not configured
[   35.800000] jffs2: error: (407) jffs2_build_inode_pass1: child dir "rc.d" (ino #82) of dir ino #6 appears to be a hard link
[   35.810000] jffs2: notice: (407) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[   35.830000] mount_root: loading kmods from internal overlay



und:

[   26.470000] jffs2: error: (357) jffs2_build_inode_pass1: child dir "init.d" (ino #1384) of dir ino #1345 appears to be a hard link
[   26.480000] jffs2: notice: (357) jffs2_build_xattr_subsystem: complete building xattr subsystem, 3 of xdatum (2 unchecked, 1 orphan) and 3 of xref (1 dead, 0 orphan) found.
[   26.500000] mount_root: switching to jffs2 overlay


# alle sind zimbies, bei denen in status NICHT 'PPid:	0' steht (also ein wert)
# tasklist if everything is broken with shell internals:
# for FILE in /proc/*; do case "$FILE" in */[0-9]*) read L1 <"$FILE/cmdline"; read NOP L2 <"$FILE/status"; echo "$FILE: '${L1:-[$L2]}'"; esac; done
# for FILE in /proc/*; do case "$FILE" in */[0-9]*) read LINE <"$FILE/cmdline"; echo "$FILE: '$LINE'"; esac; done
/proc/1: '/sbin/procd'
/proc/102: ''
/proc/10817: ''
/proc/10876: '/usr/sbin/hostapd-P/var/run/wifi-phy1.pid-B/var/run/hostapd-phy1.conf'
/proc/10896: '/usr/sbin/hostapd-P/var/run/wifi-phy0.pid-B/var/run/hostapd-phy0.conf'
/proc/14839: ''
/proc/155: ''
/proc/2: ''
/proc/2433: ''
/proc/2534: ''
/proc/2660: '/usr/sbin/dropbear-F-P/var/run/dropbear.1.pid-p22-K300'
/proc/278: ''
/proc/2785: '-ash'
/proc/3: ''
/proc/31: ''
/proc/3182: '/sbin/askfirst/bin/ash--login'
/proc/32363: ''
/proc/3349: ''
/proc/371: ''
/proc/3885: '/usr/sbin/dropbear-F-P/var/run/dropbear.1.pid-p22-K300'
/proc/5: ''
/proc/5060: ''
/proc/62: ''
/proc/63: ''
/proc/64: ''
/proc/7: ''




Making all in iptables
make[6]: Entering directory `/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/iptables-1.4.21/iptables'
/bin/bash ../libtool  --tag=CC   --mode=link mips-openwrt-linux-uclibc-gcc -Wall -Waggregate-return -Wmissing-declarations      -Wmissing-prototypes -Wredundant-decls -Wshadow -Wstrict-prototypes    -Winline -pipe -DALL_INCLUSIVE -DENABLE_IPV4  -Os -pipe -mno-branch-likely -mips32r2 -mtune=34kc -fno-caller-saves -fhonour-copts -Wno-error=unused-but-set-variable -msoft-float -mips16 -minterlink-mips16 -I/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/iptables-1.4.21/include -I/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/linux-3.18.14/user_headers/include -ffunction-sections -fdata-sections -DNO_LEGACY  -L../extensions/ -liptext -liptext4  -L/home/bastian/openwrt/staging_dir/target-mips_34kc_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/staging_dir/target-mips_34kc_uClibc-0.9.33.2/lib -L/home/bastian/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/lib -Wl,--gc-sections  -o xtables-multi xtables_multi-xtables-multi.o xtables_multi-iptables-xml.o xtables_multi-iptables-save.o xtables_multi-iptables-restore.o xtables_multi-iptables-standalone.o xtables_multi-iptables.o  xtables_multi-xshared.o ../libiptc/libip4tc.la  ../libxtables/libxtables.la -lm
OpenWrt-libtool: link: mips-openwrt-linux-uclibc-gcc -Wall -Waggregate-return -Wmissing-declarations -Wmissing-prototypes -Wredundant-decls -Wshadow -Wstrict-prototypes -Winline -pipe -DALL_INCLUSIVE -DENABLE_IPV4 -Os -pipe -mno-branch-likely -mips32r2 -mtune=34kc -fno-caller-saves -fhonour-copts -Wno-error=unused-but-set-variable -msoft-float -mips16 -minterlink-mips16 -I/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/iptables-1.4.21/include -I/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/linux-3.18.14/user_headers/include -ffunction-sections -fdata-sections -DNO_LEGACY -Wl,--gc-sections -o .libs/xtables-multi xtables_multi-xtables-multi.o xtables_multi-iptables-xml.o xtables_multi-iptables-save.o xtables_multi-iptables-restore.o xtables_multi-iptables-standalone.o xtables_multi-iptables.o xtables_multi-xshared.o  -L../extensions/ -liptext -liptext4 -L/home/bastian/openwrt/staging_dir/target-mips_34kc_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/staging_dir/target-mips_34kc_uClibc-0.9.33.2/lib -L/home/bastian/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/lib ../libiptc/.libs/libip4tc.so ../libxtables/.libs/libxtables.so -ldl -lm
../libxtables/.libs/libxtables.so: warning: gethostbyaddr is obsolescent, use getaddrinfo() instead.
../libxtables/.libs/libxtables.so: warning: gethostbyname is obsolescent, use getnameinfo() instead.
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x34): undefined reference to `ip6tables_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x3c): undefined reference to `ip6tables_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x44): undefined reference to `ip6tables_save_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x4c): undefined reference to `ip6tables_save_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x54): undefined reference to `ip6tables_restore_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x5c): undefined reference to `ip6tables_restore_main'
collect2: error: ld returned 1 exit status
make[6]: *** [xtables-multi] Error 1
make[6]: Leaving directory `/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/iptables-1.4.21/iptables'
make[5]: *** [all-recursive] Error 1
make[5]: Leaving directory `/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/iptables-1.4.21'
make[4]: *** [all] Error 2
make[4]: Leaving directory `/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/iptables-1.4.21'
make[3]: *** [/home/bastian/openwrt/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/iptables-1.4.21/.built] Error 2






Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.err dnsmasq-dhcp[14465]: ARP-cache injection failed: Invalid argument
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.err dnsmasq-dhcp[14465]: ARP-cache injection failed: Invalid argument
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.err dnsmasq-dhcp[14465]: ARP-cache injection failed: Invalid argument
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.err dnsmasq-dhcp[14465]: ARP-cache injection failed: Invalid argument
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.err dnsmasq-dhcp[14465]: ARP-cache injection failed: Invalid argument
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.err dnsmasq-dhcp[14465]: ARP-cache injection failed: Invalid argument
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 
Thu Jun  4 13:37:13 2015 daemon.err dnsmasq-dhcp[14465]: ARP-cache injection failed: Invalid argument
Thu Jun  4 13:37:13 2015 daemon.info dnsmasq-dhcp[14465]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
root@UFO:~ cat 
root@UFO:~ reb
root@UFO:~ 
root@UFO:~ 
root@UFO:~ 
root@UFO:~ 
root@UFO:~ cat /etc/banner
  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, r45702)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@UFO:~ 





# /usr/local/freeswitch/storage/fax/8850/inbox/*
# /usr/local/freeswitch/storage/fax/failed_fax_emails.log
# /usr/local/freeswitch/storage/fax/emailed_faxes.log
#
# grep 'postfix/' /var/log/syslog | tail -n100
# ejbw-pbx-mailversand in syslog
May 31 11:29:01 ejbw-pbx postfix/pickup[28044]: 794D741BC7: uid=0 from=<root>
May 31 11:29:01 ejbw-pbx postfix/cleanup[28991]: 794D741BC7: message-id=<20150531092901.794D741BC7@ejbw-pbx>
May 31 11:29:01 ejbw-pbx postfix/qmgr[6758]: 794D741BC7: from=<root@ejbw-pbx>, size=573, nrcpt=1 (queue active)
May 31 11:29:01 ejbw-pbx postfix/local[20554]: 794D741BC7: to=<root@ejbw-pbx>, orig_to=<root>, relay=local, delay=0.07, delays=0.05/0/0/0.02, dsn=2.0.0, status=sent (delivered to mailbox)
May 31 11:29:01 ejbw-pbx postfix/qmgr[6758]: 794D741BC7: removed



[   83.120000] jffs2: iget() failed for ino #114
[   83.130000] jffs2: warning: (1416) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.140000] jffs2: warning: (1416) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.150000] jffs2: iget() failed for ino #114
[   83.160000] jffs2: warning: (1420) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.170000] jffs2: warning: (1420) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.170000] jffs2: iget() failed for ino #114
[   83.190000] jffs2: warning: (1421) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.190000] jffs2: warning: (1421) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.200000] jffs2: iget() failed for ino #114
[   83.210000] jffs2: warning: (1421) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.220000] jffs2: warning: (1421) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.220000] jffs2: iget() failed for ino #114
[   83.260000] jffs2: warning: (1422) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.270000] jffs2: warning: (1422) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.280000] jffs2: iget() failed for ino #114
[   83.330000] jffs2: warning: (1424) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.340000] jffs2: warning: (1424) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.340000] jffs2: iget() failed for ino #114
[   83.350000] jffs2: warning: (1427) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.360000] jffs2: warning: (1427) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.370000] jffs2: iget() failed for ino #114
[   83.380000] jffs2: warning: (1424) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.390000] jffs2: warning: (1424) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.400000] jffs2: iget() failed for ino #114
[   83.410000] jffs2: warning: (1428) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.410000] jffs2: warning: (1428) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.420000] jffs2: iget() failed for ino #114
[   83.430000] jffs2: warning: (1429) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.440000] jffs2: warning: (1429) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.450000] jffs2: iget() failed for ino #114
[   83.460000] jffs2: warning: (1429) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.460000] jffs2: warning: (1429) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.470000] jffs2: iget() failed for ino #114
[   83.510000] jffs2: warning: (1430) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.520000] jffs2: warning: (1430) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.530000] jffs2: iget() failed for ino #114
[   83.570000] jffs2: warning: (1432) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.580000] jffs2: warning: (1432) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.590000] jffs2: iget() failed for ino #114
[   83.600000] jffs2: warning: (1435) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.600000] jffs2: warning: (1435) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.610000] jffs2: iget() failed for ino #114
[   83.620000] jffs2: warning: (1432) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.630000] jffs2: warning: (1432) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.640000] jffs2: iget() failed for ino #114
[   83.650000] jffs2: warning: (1436) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.650000] jffs2: warning: (1436) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.660000] jffs2: iget() failed for ino #114
[   83.670000] jffs2: warning: (1437) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.680000] jffs2: warning: (1437) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.690000] jffs2: iget() failed for ino #114
[   83.700000] jffs2: warning: (1437) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.700000] jffs2: warning: (1437) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.710000] jffs2: iget() failed for ino #114
[   83.750000] jffs2: warning: (1438) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.760000] jffs2: warning: (1438) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.770000] jffs2: iget() failed for ino #114
[   83.810000] jffs2: warning: (1440) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.820000] jffs2: warning: (1440) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.830000] jffs2: iget() failed for ino #114
[   83.840000] jffs2: warning: (1443) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.840000] jffs2: warning: (1443) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.850000] jffs2: iget() failed for ino #114
[   83.860000] jffs2: warning: (1440) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.870000] jffs2: warning: (1440) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.880000] jffs2: iget() failed for ino #114
[   83.890000] jffs2: warning: (1444) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.890000] jffs2: warning: (1444) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.900000] jffs2: iget() failed for ino #114
[   83.910000] jffs2: warning: (1445) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.920000] jffs2: warning: (1445) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.930000] jffs2: iget() failed for ino #114
[   83.940000] jffs2: warning: (1445) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   83.950000] jffs2: warning: (1445) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   83.950000] jffs2: iget() failed for ino #114
[   84.020000] jffs2: warning: (1446) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.030000] jffs2: warning: (1446) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.040000] jffs2: iget() failed for ino #114
[   84.080000] jffs2: warning: (1448) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.090000] jffs2: warning: (1448) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.090000] jffs2: iget() failed for ino #114
[   84.100000] jffs2: warning: (1451) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.110000] jffs2: warning: (1451) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.120000] jffs2: iget() failed for ino #114
[   84.130000] jffs2: warning: (1448) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.140000] jffs2: warning: (1448) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.140000] jffs2: iget() failed for ino #114
[   84.150000] jffs2: warning: (1452) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.160000] jffs2: warning: (1452) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.170000] jffs2: iget() failed for ino #114
[   84.180000] jffs2: warning: (1453) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.190000] jffs2: warning: (1453) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.200000] jffs2: iget() failed for ino #114
[   84.210000] jffs2: warning: (1453) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.210000] jffs2: warning: (1453) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.220000] jffs2: iget() failed for ino #114
[   84.270000] jffs2: warning: (1454) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.280000] jffs2: warning: (1454) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.290000] jffs2: iget() failed for ino #114
[   84.340000] jffs2: warning: (1456) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.350000] jffs2: warning: (1456) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.360000] jffs2: iget() failed for ino #114
[   84.370000] jffs2: warning: (1459) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.380000] jffs2: warning: (1459) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.380000] jffs2: iget() failed for ino #114
[   84.390000] jffs2: warning: (1456) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.400000] jffs2: warning: (1456) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.410000] jffs2: iget() failed for ino #114
[   84.420000] jffs2: warning: (1460) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.430000] jffs2: warning: (1460) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.430000] jffs2: iget() failed for ino #114
[   84.450000] jffs2: warning: (1461) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.450000] jffs2: warning: (1461) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.460000] jffs2: iget() failed for ino #114
[   84.470000] jffs2: warning: (1461) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.480000] jffs2: warning: (1461) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.490000] jffs2: iget() failed for ino #114
[   84.520000] jffs2: warning: (1462) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.530000] jffs2: warning: (1462) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.540000] jffs2: iget() failed for ino #114
[   84.580000] jffs2: warning: (1464) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.590000] jffs2: warning: (1464) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.600000] jffs2: iget() failed for ino #114
[   84.610000] jffs2: warning: (1467) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.620000] jffs2: warning: (1467) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.630000] jffs2: iget() failed for ino #114
[   84.630000] jffs2: warning: (1464) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.640000] jffs2: warning: (1464) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.650000] jffs2: iget() failed for ino #114
[   84.660000] jffs2: warning: (1468) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.670000] jffs2: warning: (1468) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.680000] jffs2: iget() failed for ino #114
[   84.690000] jffs2: warning: (1469) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.700000] jffs2: warning: (1469) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.700000] jffs2: iget() failed for ino #114
[   84.710000] jffs2: warning: (1469) jffs2_get_inode_nodes: Eep. No valid nodes for ino #114.
[   84.720000] jffs2: warning: (1469) jffs2_do_read_inode_internal: no data nodes found for ino #114
[   84.730000] jffs2: iget() failed for ino #114
root@Emilio-derZar:/# 



Jan 01 01:01:21 ' [up 81s 17223680 bytes free] TERM:linux /etc/kalua_init [daemon.info] gen_loader() [OK] done '/tmp/loader' (in 2.82sec, using 563683 bytes in /tmp/kalua) - you MUST reinclude the new loader with 'LODEV= . /tmp/loader' if this is an interactive shell
root: /etc/init.d/apply_profile.code: ....working on section 'softwareinstall'
rm: can't stat '/etc/rc.d/S??olsrd': Input/output error
rm: can't stat '/etc/rc.d/K??olsrd': Input/output error
ln: /etc/rc.d/S65olsrd: Input/output error
rm: can't stat '/etc/rc.d/S??dnsmasq': Input/output error
rm: can't stat '/etc/rc.d/K??dnsmasq': Input/output error
ln: /etc/rc.d/S60dnsmasq: Input/output error
rm: can't stat '/etc/rc.d/S??crashlog_apport': Input/output error
rm: can't stat '/etc/rc.d/K??crashlog_apport': Input/output error
ln: /etc/rc.d/S99crashlog_apport: Input/output error
rm: can't stat '/etc/rc.d/S??count_reboots': Input/output error
rm: can't stat '/etc/rc.d/K??count_reboots': Input/output error
ln: /etc/rc.d/S11count_reboots: Input/output error
rm: can't stat '/etc/rc.d/S??generate_kalua_loader': Input/output error
rm: can't stat '/etc/rc.d/K??generate_kalua_loader': Input/output error
ln: /etc/rc.d/S00generate_kalua_loader: Input/output error
rm: can't stat '/etc/rc.d/S??generate_netparams': Input/output error
rm: can't stat '/etc/rc.d/K??generate_netparams': Input/output error
ln: /etc/rc.d/S41generate_netparams: Input/output error
rm: can't stat '/etc/rc.d/S??end_boot': Input/output error
rm: can't stat '/etc/rc.d/K??end_boot': Input/output error
ln: /etc/rc.d/S99end_boot: Input/output error
rm: can't stat '/etc/rc.d/S??prepare_stuff': Input/output error
rm: can't stat '/etc/rc.d/K??prepare_stuff': Input/output error
ln: /etc/rc.d/S70prepare_stuff: Input/output error
rm: can't stat '/etc/rc.d/S??netfilter': Input/output error
rm: can't stat '/etc/rc.d/K??netfilter': Input/output error
ln: /etc/rc.d/S45netfilter: Input/output error
rm: can't stat '/etc/rc.d/S??cron.user': Input/output error
rm: can't stat '/etc/rc.d/K??cron.user': Input/output error
ln: /etc/rc.d/S51cron.user: Input/output error
/etc/init.d/apply_profile.code: line 1812: /etc/init.d/samba: not found
/etc/init.d/apply_profile.code: line 1812: /etc/init.d/siproxd: not found
/etc/init.d/apply_profile.code: line 1812: /etc/init.d/netserver: not found
/etc/init.d/apply_profile.code: line 1812: /etc/init.d/ulogd: not found
/etc/init.d/apply_profile.code: line 1812: /etc/init.d/cron: not found
/etc/init.d/apply_profile.code: line 1812: /etc/init.d/firewall: not found
root: /etc/init.d/apply_profile.code: [ok] ready with section 'softwareinstall'
root: /etc/init.d/apply_profile.code: ....working on section 'system'
root: /etc/init.d/apply_profile.code: [ok] ready with section 'system'
root: /etc/init.d/apply_profile.code: ....working on section 'mail'
root: /etc/init.d/apply_profile.code: [ok] ready with section 'mail'
root: /etc/init.d/apply_profile.code: ....working on section 'wireless'
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
root: /etc/init.d/apply_profile.code: configuring radio0 ...
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Invalid argument
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Invalid argument
root: /etc/init.d/apply_profile.code: [ok] ready with section 'wireless'
root: /etc/init.d/apply_profile.code: ....working on section 'network'
root: /etc/init.d/apply_profile.code: [ok] ready with section 'network'
root: /etc/init.d/apply_profile.code: ....working on section 'dhcp'
uci: Entry not found
root: /etc/init.d/apply_profile.code: [ok] ready with section 'dhcp'
root: /etc/init.d/apply_profile.code: ....working on section 'aliases'
root: /etc/init.d/apply_profile.code: [ok] ready with section 'aliases'
root: /etc/init.d/apply_profile.code: ....working on section 'olsrd'
root: /etc/init.d/apply_profile.code: [ok] ready with section 'olsrd'
root: /etc/init.d/apply_profile.code: ....working on section 'sms'
root: /etc/init.d/apply_profile.code: [ok] ready with section 'sms'
root: /etc/init.d/apply_profile.code: ....working on section 'polipo'
root: /etc/init.d/apply_profile.code: [ok] ready with section 'polipo'

[ok] READY/synched - now type: reboot && exit



13:29 < johnf1911> the embedded space is far more constraining
13:29 < jow_laptop> well, there is libxml2, libssh, ... shouldn't be hard to write a C client
13:29 < jow_laptop> but its not cool
13:30 < johnf1911> bit disappointed with the updated version of sscep you helped me with yesterday
13:30 < johnf1911> it seg faults
13:30 < johnf1911> need to gdb it but it's going to need to wait until after I deploy these devices
13:30 < johnf1911> then I will rescue it from oldpackages
13:31 < jow_laptop> johnf1911: install gdbserver on your unit, run gdbserver :9000 /usr/bin/sscep ...
13:31 < jow_laptop> johnf1911: then in your buildroot, ./scripts/remote-gdb 192.168.1.1:9000 build_dir/target-*/sscep-*/sscep_dyn
13:31 < jow_laptop> type "c" to continue the program and if the SIGSEGV is catched, a "bt full"
13:32 < jow_laptop> thats the basic process
13:32 < jow_laptop> no need to copy unstripped binaries or something to the router
13:32 < johnf1911> yes, I read about that on the wiki
13:32 < johnf1911> it's pretty nice
13:32 < johnf1911> but I can't do it right now, not that high a priority
13:32 < jow_laptop> ok
13:32 < johnf1911> need to get this deployment process working right
13:32 < johnf1911> it is very elegant though
13:32 < johnf1911> like all of openwrt really
13:33 < johnf1911> what do you do with openwrt? I assume that you work on it professionally for someone
13:33 < jow_laptop> not really, just a hobby
13:33 < johnf1911> damn
13:33 < jow_laptop> since like 6+ years
13:34 < johnf1911> I need to admit I'm a bit surprised
13:34 < jow_laptop> I joined with a freifunk community background and then gradually shifted to the core development work
13:34 < johnf1911> even if it started as a hobby I'd have expected someone using it commercially to try to head hunt you
13:34 < johnf1911> at the same time, there are advantages to not turning your hobbies into jobs
13:34 < johnf1911> I work on routers and computers all day
13:35 < johnf1911> then, to relax
13:35 < johnf1911> I work on routers and computers???
13:35 < johnf1911> there's something wrong with that :)
13:35 < jow_laptop> yeah I (and others) get regular offers
13:35 < jow_laptop> but I don't want to work paid on openwrt
13:35 < jow_laptop> it helps if at least some develoeprs retain an outside perspective not driven by paid customer demands
13:37 < johnf1911> makes sense
13:37 < johnf1911> hopefully you have a day job that's similarly interesting and leverages your abilities well
13:37 < johnf1911> this is my first time doing openwrt based routers professionally
13:37 < johnf1911> but I do a lot of networking
13:38 < johnf1911> anyways, to work



# die kraftidioten

system.led_wan=led
system.led_wan.name=WAN
system.led_wan.sysfs=tp-link:green:wan
system.led_wan.trigger=netdev
system.led_wan.dev=eth0
system.led_wan.mode=link tx rx
system.led_lan1=led
system.led_lan1.name=LAN1
system.led_lan1.sysfs=tp-link:green:lan1
system.led_lan1.trigger=switch0
system.led_lan1.port_mask=0x04
system.led_lan2=led
system.led_lan2.name=LAN2
system.led_lan2.sysfs=tp-link:green:lan2
system.led_lan2.trigger=switch0
system.led_lan2.port_mask=0x08
system.led_lan3=led
system.led_lan3.name=LAN3
system.led_lan3.sysfs=tp-link:green:lan3
system.led_lan3.trigger=switch0
system.led_lan3.port_mask=0x10
system.led_lan4=led
system.led_lan4.name=LAN4
system.led_lan4.sysfs=tp-link:green:lan4
system.led_lan4.trigger=switch0
system.led_lan4.port_mask=0x02
system.led_wlan=led
system.led_wlan.name=WLAN
system.led_wlan.sysfs=tp-link:green:wlan
system.led_wlan.trigger=phy0tpt



# test ag71xx-patch:
# cp ag71xx-test.patch ./target/linux/ar71xx/patches-3.18/904-ag71xx-test.patch
# make target/linux/clean
# make -j25


# ap99 war r44945 - gesehen auf mit stube: r45447

# r45511 laesst kein sysupgrade zu
# factory und sysupgrade (beides geht nicht!)
# 841 v8

# ubuntu: nameserver: nmcli dev list iface wlan0 | grep name
# ssh -o UserKnownHostsFile=/dev/null root@$( ip route list exact '0.0.0.0/0' | cut -d' ' -f3 )

# roaming-change X301:
# wlan0: deauthenticated from a2:f3:c1:a8:75:db (Reason: 3=DEAUTH_LEAVING)

# hack HOTSPLOTS
# md5-hash1: rxvKaK7B$EMAzmsKx7OskN4WgRgO601
# md5-hash2: OA7Z/6NP$r7oTHgVBho/NTEw8wbLUM0
#
# jede minute wird per wget URL geholt:
# http://firmware.hotsplots.de/service/pulse3.0.php?hash=d19365367df2c3d9ed7b0acad8139ac0&csize=0&vers=3.0-521&intval=1&filter=off&vpn_s=vpn23.hotsplots.net&vpn_r=1&vpn_ok=0&vpn_service=openvpn
# d.h. alle anfragen an 'firmware.hotsplots.de' muessen beantwortet werden mit der gleichen antwort:
# einen shellscript, was direkt ausgefuehrt wird (kein https!)
# im shellscript muss stehen: grep -q "## HOTSPLOTS update 3.0 ##" /tmp/hs_update.txt
# 
# 
# leider ist 'update.update.url' = leer
#
# evtl. ueber ntp was holen?
/usr/sbin/ntpd -n -p 0.openwrt.pool.ntp.org
#
# debugmodus = touch /etc/hotsplots/debug
#
# in init: / md5 = d19365367df2c3d9ed7b0acad8139ac0 -> route-up.sh
wget -O /tmp/test.tar "http://firmware.hotsplots.de/service/getVPN3.0.php?hash=$md5"

root@liszt28-adhoc--2:~ tar tf /tmp/test.tar
hotsplots-ca.crt
vpn-routing.key
vpn-routing.crt
vpn-routing.conf
vpn-remote
route-up.sh

# -> vpn muss laufen, dann injecten in route-up.sh? -> nur http!

#
# HOTSPLOTS Firmware 3.0-521 (r38430)
# Linux version 3.10.32 (jontrup@splot3) (gcc version 4.6.4 (OpenWrt/Linaro GCC 4.6-2013.05 r38430) ) #1 Thu Jul 17 17:25:25 CEST 2014
# Joerg Ontrup -> http://www.hotsplots.de/profile/heads/joerg-ontrup.html
#
#
# uci set uhttpd.main.config='/etc/httpd.conf'
# echo '/cgi-bin/:root:admin' >/etc/httpd.conf
# /etc/init.d/uhttpd restart
# -> http://192.168.43.254:8080 -> geht -> luci
#
# -> https://192.168.43.254:8080
# -> crash
root@HOTSPLOTS:/# ls -l /www/cgi-bin/[ 2608.000497] NETDEV WATCHDOG: eth0 (fsl-gianfar): transmit queue 4 timed out
[ 2608.007549] ------------[ cut here ]------------
[ 2608.012158] WARNING: at net/sched/sch_generic.c:255
[ 2608.017026] Modules linked in: pppoe pppox ppp_async ppp_generic slhc lib80211_crypt_tkip lib80211_crypt_ccmp lib80211_crypt_wep lib80211 ts_fsm ts_bm crc_ccitt xt_u32 nf_nat_tftp nf_conntrack_tftp nf_nat_snmp_basic nf_conntrack_snmp nf_nat_sip nf_conntrack_sip nf_nat_pptp nf_conntrack_pptp nf_nat_h323 nf_conntrack_h323 nf_nat_proto_gre nf_conntrack_proto_gre nf_nat_amanda ts_kmp nf_conntrack_amanda nf_conntrack_broadcast nf_nat_irc nf_nat_ftp nf_conntrack_irc nf_conntrack_ftp xt_REDIRECT ipt_MASQUERADE iptable_nat nf_nat_ipv4 xt_nat nf_nat xt_mark xt_time ipt_REJECT xt_TCPMSS xt_LOG xt_comment xt_multiport xt_mac xt_limit iptable_mangle iptable_filter xt_tcpudp xt_recent xt_helper xt_connmark xt_connbytes xt_conntrack xt_CT iptable_raw ip_tables xt_state nf_conntrack_ipv4 nf_defrag_ipv4 nf_conntrack gpio_keys ebt_snat ebt_dnat ebt_arpreply ebt_ip ebt_arp ebt_redirect ebt_mark ebt_vlan ebt_stp ebt_pkttype ebt_mark_m ebt_limit ebt_among ebt_802_3 ebtable_nat ebtable_filter ebtable_broute ebtables ath9k mac80211 ath9k_common ath9k_hw ath cfg80211 compat arptable_filter arpt_mangle arp_tables sch_teql sch_tbf sch_sfq sch_red sch_prio sch_htb sch_gred sch_dsmark sch_codel em_text em_nbyte em_meta em_cmp cls_basic act_police act_ipt x_tables act_skbedit act_mirred em_u32 cls_u32 cls_tcindex cls_flow cls_route cls_fw sch_hfsc sch_ingress leds_gpio booke_wdt ehci_platform ehci_hcd fsl_mph_dr_of tun button_hotplug input_core usbcore nls_base usb_common arc4 crypto_blkcipher crypto_hash ipv6
[ 2608.148719] CPU: 0 PID: 0 Comm: swapper Not tainted 3.10.32 #1
[ 2608.154545] task: c02f02e0 ti: c7ff2000 task.ti: c0304000
[ 2608.159934] NIP: c01cbc6c LR: c01cbc6c CTR: c01612a0
[ 2608.164890] REGS: c7ff3e70 TRAP: 0700   Not tainted  (3.10.32)
[ 2608.170712] MSR: 00029000 <CE,EE,ME>  CR: 44042042  XER: 20000000
[ 2608.176810]
GPR00: c01cbc6c c7ff3f20 c02f02e0 0000003f 00000006 00000005 000057f0 75652034
GPR08: c02f4174 c02f6af8 c02f6afc 00000004 0000011a 00000000 00000000 00000000
GPR16: c0000a00 c02f43e4 c028f95c 00200000 0008cde9 00000000 c032ffd0 c032fdd0
GPR24: c032fbd0 00000000 00200200 c032f9d0 c0300000 c02f0000 00000004 c781b000
[ 2608.206522] NIP [c01cbc6c] dev_watchdog+0x160/0x248
[ 2608.211393] LR [c01cbc6c] dev_watchdog+0x160/0x248
[ 2608.216173] Call Trace:
[ 2608.218614] [c7ff3f20] [c01cbc6c] dev_watchdog+0x160/0x248 (unreliable)
[ 2608.225235] [c7ff3f40] [c002d050] call_timer_fn.isra.38+0x28/0x80
[ 2608.231324] [c7ff3f60] [c002d208] run_timer_softirq+0x160/0x1a0
[ 2608.237240] [c7ff3fa0] [c0027dc0] __do_softirq+0xbc/0x16c
[ 2608.242642] [c7ff3ff0] [c000b424] call_do_softirq+0x14/0x24
[ 2608.248209] [c0305e60] [c0004374] do_softirq+0x60/0xa0
[ 2608.253343] [c0305e80] [c0027f78] irq_exit+0x4c/0x68
[ 2608.258303] [c0305e90] [c0007f34] timer_interrupt+0xe8/0x100
[ 2608.263959] [c0305eb0] [c000ca3c] ret_from_except+0x0/0x18
[ 2608.269443] --- Exception: 901 at arch_cpu_idle+0x24/0x58
[ 2608.269443]     LR = arch_cpu_idle+0x24/0x58
[ 2608.279095] [c0305f70] [c005fe48] rcu_idle_enter+0x94/0xac (unreliable)
[ 2608.285713] [c0305f80] [c004a844] cpu_startup_entry+0xb0/0x10c
[ 2608.291540] [c0305fb0] [c000270c] rest_init+0x68/0x78
[ 2608.296594] [c0305fc0] [c02cd7a8] start_kernel+0x2cc/0x2e0
[ 2608.302072] [c0305ff0] [c00003c0] skpinv+0x2ac/0x2e8
[ 2608.307026] Instruction dump:
[ 2608.309985] 396b0074 4200ffac 4800004c 7fe3fb78 4bfea4fd 7fe4fb78 7c651b78 3c60c02b
[ 2608.317735] 7fc6f378 38638818 4cc63182 4807ab75 <0fe00000> 38000001 981c2126 813f00e8
[ 2608.325662] ---[ end trace ec89c8f1f8b7e23d ]---




#
# WAN = dhcp
# LAN = br-can = 192.168.43.254/24
#
# vpn23.hotsplots.net
PORT     STATE  SERVICE
22/tcp   open   ssh
5001/tcp open   commplex-link
5002/tcp open   rfe
5003/tcp open   filemaker
5004/tcp open   unknown
5009/tcp open   airport-admin
9999/tcp closed abyss
#
# firmware.hotsplots.de
PORT    STATE  SERVICE
22/tcp  open   ssh
80/tcp  open   http
113/tcp closed auth
443/tcp open   https
#
root@HOTSPLOTS:/# ps
  PID USER       VSZ STAT COMMAND
    1 root      1480 S    init
    2 root         0 SW   [kthreadd]
    3 root         0 SW   [ksoftirqd/0]
    5 root         0 SW<  [kworker/0:0H]
    7 root         0 SW<  [khelper]
    8 root         0 SW   [kworker/u2:1]
   93 root         0 SW<  [writeback]
   95 root         0 SW<  [bioset]
   97 root         0 SW<  [kblockd]
  127 root         0 SW   [kswapd0]
  186 root         0 SW   [fsnotify_mark]
  722 root         0 SW<  [ffe07000.spi]
  786 root         0 SW<  [deferwq]
 1471 root         0 SWN  [jffs2_gcd_mtd4]
 1486 root      1484 S    /bin/ash --login
 1504 root      1484 S    syslogd -C16
 1506 root      1468 S    klogd
 1520 root       868 S    /sbin/hotplug2 --override --persistent --set-worker
 1648 root      1476 S    udhcpc -t 0 -i eth0.2 -b -p /var/run/dhcp-eth0.2.pid
 1738 root         0 SW   [khubd]
 1743 root         0 SW   [kworker/u2:2]
 1777 root         0 SW<  [cfg80211]
 2096 root      1480 S    hostapd -P /var/run/wifi-phy0.pid -B /var/run/hostap
 2535 root      1480 S    crond -c /etc/crontabs -l 5
 2546 root      1140 S    /usr/sbin/dropbear -P /var/run/dropbear.1.pid -p 22
 2556 root      1028 S    /usr/sbin/uhttpd -f -h /www -r HOTSPLOTS -x /cgi-bin
 2571 nobody     928 S    /usr/sbin/dnsmasq -K -D -y -Z -b -E -s lan -S /lan/
 2614 root      3168 S    /usr/sbin/openvpn --syslog openvpn(vpn_routing) --wr
 2647 root      1476 S    /usr/sbin/ntpd -n -p 0.openwrt.pool.ntp.org -p 1.ope
 2650 root      1088 S    /sbin/hs_watchd
 3085 root         0 SW   [kworker/0:0]
 3500 root         0 SW   [kworker/0:1]
 3685 root         0 SW   [kworker/0:2]
 3826 root      1472 R    ps







# Sphairon 1113 VDSL Modem - 50mbit
# http://www.allnet.de/de/allnet-brand/produkte/vdsl2/vdsl2modem-router/p/allnet-all126as2-vdsl2-slave-modem-geeignet-fuer-vdsl2-highspeed-internet/
#
# http://www.onlinekosten.de/forum/showthread.php?t=135750&page=10
# http://www.easy-computerservice.de/html/vdsl_mit_vorhandener_firewall_.html
# 
# netkom = translumina networks ag
# http://www.mygate.de/fileadmin/templates/mygate.net/pdf/130515_Bestellformular_Thueringer_Netkom_FTTH_NEU.pdf



# 	Internetverbindung wurde erfolgreich erneuert. IP-Adresse: 91.137.62.100, DNS-Server: 100.64.0.135 und 100.64.0.136, Gateway: 91.137.63.254
# 	Internetverbindung wurde erfolgreich hergestellt. IP-Adresse: 91.137.62.100, DNS-Server: 100.64.0.135 und 100.64.0.136, Gateway: 91.137.63.254
#	http://www.pcwelt.de/ratgeber/Fritzbox-Hacks__Der_Router_als_Webserver-Linux_Workshop-8669093.html

# evtl. ist das:
91.137.62.100/22 = 255.255.252.0 -> hostmax=254
91.137.60.1 ... 91.137.63.254

# mit DHCP bekommt das zyxel:
# 100.127.64.12 / 255.255.192.0

# zyxel = langsam: 1727 kbps /19374 kbps


/*               
 * /var/flash/ar7.cfg
 * Sun Apr 12 15:32:41 2015
 */                           
                          
meta { encoding = "utf-8"; }           
                                        
ar7cfg {                            
        mode = dsldmode_router;   
        active_provider = "ThueringenDSL";
        active_name = "";         
        igddenabled = yes;          
        igdd_control_enabled = no;
        wan_bridge_with_dhcpc = yes;
        wan_bridge_gateway = 0.0.0.0;
        dhcpc_use_static_dns = no;
        dhcp_dslforumorg = no;
        ethmode = ethmode_bridge;    
        tcom_targetarch = no;         
        vdsl_resalearch = no;       
        aontv_arch = no;          
        hsi_use_wan_vlan = yes;     
        hsi_vlancfg {             
                vlanencap = vlanencap_none;
                vlanid = 0;   
                vlanprio = 0;   
        }  
        mtu_cutback_mode = mtumode_auto;
        mtu_cutback = 1500;
        StatisticStartOfMonth = 1;     
        enable_mac_override = yes;      
        macdsl_override = 00:00:00:00:00:00;
        ipv6mode = ipv6_off;      
        ipv4mode = ipv4_normal;     
        serialcfg {               
                mode = serialmode_off;
                number = "*99#";
                provider = "internet.t-mobile";
                username = "$$$$2YQX2YCPBFXQC6TZPXDKTVMQPMRIC3OWRIKELNYJ33I3VDXLWQS6W3AV4SCK1POFKYXCD2ULKI45CKXO";
                passwd = "$$$$5BWHV33DURRYDGFWQEMEZUZV3IBKMGSPMS3UQ1BDIG2HUHUUX4RD1224T1XQT2QXXE5KSHGFYOSXMKXO";
                connect_chatscript = "ABORT BUSY ABORT 'NO CARRIER'",
                                     "ABORT VOICE ABORT 'NO DAILTONE'",
                                     "ABORT 'NO ANSWER' ABORT DELAYED",
                                     "ABORT ERROR", "TIMEOUT 20",
                                     "'' 'AT+cgdcont=1,\"IP\",\"${provider}\"'",
                                     "OK 'ATDT${number}'", "CONNECT",      
                                     "WAIT 2";
                stay_always_online = no;
                inactivity_timeout = 1m;
                backup {            
                        enabled = no;
                        quickstart = serialquickstart_off;
                        downtime = 3m;
                        reverttime = 30m;
                }         


# gzip -d decode_passwords.tgz 
# ls -l decode_passwords.tar 
-rw-r--r--    1 root     root         40960 Oct  2  2014 decode_passwords.tar
# tar xvf decode_passwords.tar
decode_passwords
micro_decode
md5sums
sha1sums
sha256sums
sha512sums
# grep -o -E '"[$]{4}.*"' /var/flash/ar7.cfg | sh decode_passwords
"ppp"
"ppp"
"ftpuser"
"fm1204"
"@CompatMode"
"fm1204"
# grep -o -E '"[$]{4}.*"' /var/flash/voip.cfg | sh decode_passwords
"4936434684011"
"oKa38gHpf"
"4936434684032"
"oKa38gHpf"
"4936434684033"
"oKa38gHpf"
# 




# ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: tunl0: <NOARP> mtu 1480 qdisc noop 
    link/ipip 0.0.0.0 brd 0.0.0.0
3: sit0: <NOARP> mtu 1480 qdisc noop 
    link/sit 0.0.0.0 brd 0.0.0.0
4: eth0: <NO-CARRIER,BROADCAST,MULTICAST,UP200> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 34:81:c4:c3:d8:38 brd ff:ff:ff:ff:ff:ff
5: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP200> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 34:81:c4:c3:d8:39 brd ff:ff:ff:ff:ff:ff
6: eth2: <NO-CARRIER,BROADCAST,MULTICAST,UP200> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 34:81:c4:c3:d8:3d brd ff:ff:ff:ff:ff:ff
7: eth3: <NO-CARRIER,BROADCAST,MULTICAST,UP200> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 34:81:c4:c3:d8:3e brd ff:ff:ff:ff:ff:ff
8: wasp: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:de:ad:be:ef:ca brd ff:ff:ff:ff:ff:ff
9: ptm_vr9: <BROADCAST,MULTICAST,UP,LOWER_UP100> mtu 1500 qdisc tbf qlen 1000
    link/ether 34:81:c4:c3:d8:3c brd ff:ff:ff:ff:ff:ff
10: adsl: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP> mtu 2000 qdisc pfifo_fast qlen 32
    link/[19] 
11: lan: <BROADCAST,MULTICAST,UP,LOWER_UP200> mtu 1500 qdisc noqueue 
    link/ether 34:81:c4:c3:d8:38 brd ff:ff:ff:ff:ff:ff
    inet 192.168.178.1/24 brd 192.168.178.255 scope global lan
    inet 169.254.1.1/16 brd 169.254.255.255 scope global lan:0
    inet6 fe80::3681:c4ff:fec3:d838/64 scope link 
       valid_lft forever preferred_lft forever
12: guest: <BROADCAST,MULTICAST,UP,LOWER_UP200> mtu 1500 qdisc noqueue 
    link/ether 34:81:c4:c3:d8:38 brd ff:ff:ff:ff:ff:ff
    inet 192.168.179.1/24 brd 192.168.179.255 scope global guest
    inet6 fe80::3681:c4ff:fec3:d838/64 scope link 
       valid_lft forever preferred_lft forever
13: dsl: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP200> mtu 1500 qdisc pfifo_fast qlen 100
    link/ppp 
    inet 192.168.178.1/32 scope global dsl
14: wifi0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop qlen 1000
    link/ieee802.11 34:81:c4:c3:d8:3a brd ff:ff:ff:ff:ff:ff
15: wifi1: <BROADCAST,MULTICAST> mtu 1500 qdisc noop qlen 1000
    link/ieee802.11 34:81:c4:c3:d8:3b brd ff:ff:ff:ff:ff:ff
16: ath0: <BROADCAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 34:81:c4:c3:d8:3a brd ff:ff:ff:ff:ff:ff
17: ath1: <BROADCAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 34:81:c4:c3:d8:3b brd ff:ff:ff:ff:ff:ff
18: wlan: <BROADCAST,MULTICAST,UP,LOWER_UP200> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 34:81:c4:c3:d8:38 brd ff:ff:ff:ff:ff:ff
# 

# ip r
100.64.0.6 dev dsl  metric 4 
100.64.0.68 dev dsl  metric 3 
100.64.0.5 dev dsl  metric 4 
100.64.0.135 dev dsl  metric 2 
192.168.180.1 dev dsl  metric 2 
100.64.0.67 dev dsl  metric 3 
192.168.180.2 dev dsl  metric 2 
100.64.0.136 dev dsl  metric 2 
192.168.178.0/24 dev lan  src 192.168.178.1 
192.168.179.0/24 dev guest  src 192.168.179.1 
91.137.32.0/19 dev dsl  metric 2 
100.126.64.0/18 dev dsl  metric 3 
100.127.64.0/18 dev dsl  metric 4 
169.254.0.0/16 dev lan  src 169.254.1.1 
default dev dsl  metric 2 

# cat /proc/net/vlan/config 
VLAN Dev name	 | VLAN ID
Name-Type: VLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD
# 






# # Dach, Fruehsteck, normal,normal, normal(buero), eg, keller

# let it crash:
# http://www.heise.de/developer/artikel/Let-it-Crash-Paradigma-fuer-fehlertolerante-massiv-parallele-Software-1579007.html

# kein space mehr: -> firstboot kann helfen?!
# [   25.260000] jffs2: warning: (1060) do_jffs2_setxattr: jffs2_reserve_space()=-28, request=48

# subject: [ffj] Schlossklinik Leutenberg

# subject: Interest in a openwrt router database to partially replace TOH

# im bootloader gehts ab block 124/128 los mit fehlern:
[   26.720000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
[   26.740000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   26.740000] jffs2_build_filesystem(): erasing all blocks after the end marker... 
[   30.370000] random: nonblocking pool is initialized
[   67.400000] jffs2: Read of newly-erased block at 0x00380000 failed: -145. Putting on bad_list
[  107.400000] blk_update_request: I/O error, dev mtdblock2, sector 4254
[  107.400000] SQUASHFS error: squashfs_read_data failed to read block 0x2138d6
[  147.400000] blk_update_request: I/O error, dev mtdblock2, sector 4256
[  187.400000] blk_update_request: I/O error, dev mtdblock2, sector 4258
[  227.400000] blk_update_request: I/O error, dev mtdblock2, sector 4260
[  267.400000] blk_update_request: I/O error, dev mtdblock2, sector 4262
[  307.400000] blk_update_request: I/O error, dev mtdblock2, sector 4264
[  347.400000] blk_update_request: I/O error, dev mtdblock2, sector 4266


root@f36-drucker:~ /etc/init.d/olsrd restart
olsrd: /etc/init.d/olsrd: olsrd_write_loadplugin() Warning: Plugin library 'olsrd_arprefresh.so.0.1' not found, skipped
Command failed: Not found
Failed to parse json data: unexpected end of data
Command failed: Not found
Failed to parse json data: unexpected end of data
olsrd: /etc/init.d/olsrd: olsrd_write_interface() Warning: Interface 'lan' not found, skipped
Command failed: Not found
Failed to parse json data: unexpected end of data
Command failed: Not found
Failed to parse json data: unexpected end of data
olsrd: /etc/init.d/olsrd: olsrd_write_interface() Warning: Interface 'innercityVPN' not found, skipped
Command failed: Not found
Failed to parse json data: unexpected end of data
Command failed: Not found
Failed to parse json data: unexpected end of data
olsrd: /etc/init.d/olsrd: olsrd_write_interface() Warning: Interface 'wlanadhoc' not found, skipped







  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, r43769)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/# free
             total         used         free       shared      buffers
Mem:         13752         7792         5960            0          348
-/+ buffers:               7444         6308
Swap:            0            0            0

root@OpenWrt:/# cat /etc/HARDWARE
Linksys WRT54G/GS/GL

root@OpenWrt:/# df -h
Filesystem                Size      Used Available Use% Mounted on
rootfs                    1.9M    208.0K      1.7M  11% /
/dev/root                 1.0M      1.0M         0 100% /rom
tmpfs                     6.7M     20.0K      6.7M   0% /tmp
/dev/mtdblock5            1.9M    208.0K      1.7M  11% /overlay
overlayfs:/overlay        1.9M    208.0K      1.7M  11% /
tmpfs                   512.0K         0    512.0K   0% /dev

root@OpenWrt:/# uname -a
Linux OpenWrt 3.14.26 #45 Tue Dec 23 02:36:42 EST 2014 mips GNU/Linux

root@OpenWrt:/# uptime
 18:28:51 up 4 days, 10:52,  load average: 0.31, 0.38, 0.22

root@OpenWrt:/# neigh.sh
Table: Links
Local IP        Remote IP       Hyst.   LQ      NLQ     Cost
10.63.4.33      10.63.22.97     0.00    1.000   1.000   1.000   
10.63.4.1       10.63.48.65     0.00    0.596   0.823   2.037   
10.63.4.1       10.63.82.65     0.00    0.004   0.191   INFINITE        

Table: Neighbors
IP address      SYM     MPR     MPRS    Will.   2 Hop Neighbors
10.63.82.97     YES     YES     NO      7       6
10.63.48.97     YES     YES     YES     7       1
10.63.22.97     YES     YES     YES     7       5

root@OpenWrt:/# ps
  PID USER       VSZ STAT COMMAND
    1 root      1248 S    /sbin/procd
    2 root         0 SW   [kthreadd]
    3 root         0 SW   [ksoftirqd/0]
    4 root         0 SW   [kworker/0:0]
    5 root         0 SW<  [kworker/0:0H]
    7 root         0 SW<  [khelper]
   39 root         0 SW<  [writeback]
   42 root         0 SW<  [bioset]
   44 root         0 SW<  [kblockd]
   86 root         0 SW   [kswapd0]
   87 root         0 SW   [fsnotify_mark]
  156 root         0 SW<  [deferwq]
  207 root         0 SWN  [jffs2_gcd_mtd5]
  258 root       716 S    /sbin/ubusd
  352 root         0 SW<  [cfg80211]
  353 root         0 SW   [kworker/0:2]
  434 root      1440 S    /sbin/netifd
  476 root      1244 S    /usr/sbin/telnetd -F -l /bin/login.sh
  618 root         0 SW   [irq/4-b43]
  721 root      1420 S    /usr/sbin/olsrd -f /var/etc/olsrd.conf -nofork
  771 root         0 SW   [kworker/u2:0]
 1302 root      1248 S    /bin/ash --login
 1484 root      1244 R    ps
30077 root         0 SW   [kworker/u2:1]
31909 root         0 SW   [kworker/u2:2]

root@OpenWrt:/# iw dev wlan0 station dump
Station f4:ec:38:9d:7a:1e (on wlan0)
        inactive time:  1190 ms
        rx bytes:       1094903833
        rx packets:     6402589
        tx bytes:       13125
        tx packets:     175
        tx retries:     213
        tx failed:      18
        signal:         -86 dBm
        signal avg:     -86 dBm
        tx bitrate:     11.0 MBit/s
        rx bitrate:     11.0 MBit/s
        authorized:     yes
        authenticated:  yes
        preamble:       long
        WMM/WME:        yes
        MFP:            no
        TDLS peer:      no
Station 14:cf:92:3c:5b:00 (on wlan0)
        inactive time:  10 ms
        rx bytes:       528897896
        rx packets:     917165
        tx bytes:       287990717
        tx packets:     212859
        tx retries:     23282
        tx failed:      43
        signal:         -62 dBm
        signal avg:     -61 dBm
        tx bitrate:     54.0 MBit/s
        rx bitrate:     54.0 MBit/s
        authorized:     yes
        authenticated:  yes
        preamble:       long
        WMM/WME:        yes
        MFP:            no
        TDLS peer:      no
Station b0:48:7a:a5:96:2e (on wlan0)
        inactive time:  14880 ms
        rx bytes:       0
        rx packets:     0
        tx bytes:       0
        tx packets:     0
        tx retries:     0
        tx failed:      0
        signal:         0 dBm
        signal avg:     0 dBm
        tx bitrate:     1.0 MBit/s
        rx bitrate:     1.0 MBit/s
        authorized:     yes
        authenticated:  yes
        preamble:       long
        WMM/WME:        yes
        MFP:            no
        TDLS peer:      no

# ------------------------------------------------------------------------------------


# check a random neighbour for ssh/httpd || {
#       udhcpc -i wlan0 -r 10.10.52.2 -n -q -r retter -S;reboot
# }

ip n| grep ^10|grep :| while read LINE; do IP="$( echo "$LINE"| cut -d' ' -f1)"; echo $IP;done | sort -n| while read IP; do echo "$IP"; nc 2>/dev/null "$IP" 554 2>/dev/null && echo "OK $IP"; done


Mem: 27188K used, 1640K free, 0K shrd, 11K buff, 32K cached
CPU:  91% usr   7% sys   0% nic   0% idle   0% io   0% irq   0% sirq
Load average: 1.45 1.25 1.18 2/44 7809
  PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
 6793  6792 root     R     1064   4%  91% /bin/opkg install /tmp/mydesign_0.1_5
 7079     2 root     SW       0   0%   2% [kworker/0:2]
 2929     1 root     S     1608   6%   2% /usr/sbin/olsrd -f /var/etc/olsrd.con
 2468     1 nobody   S      916   3%   2% /sbin/fakedns --address=/#/10.10.151.
  159     2 root     SW       0   0%   1% [spi0]
 2313     1 root     S     1608   6%   1% /usr/sbin/hostapd -P /var/run/wifi-ph
 7388     2 root     SW       0   0%   1% [kworker/u2:1]
    3     2 root     SW       0   0%   1% [ksoftirqd/0]
 7793  7767 root     R     1368   5%   0% top
 7781  2860 root     Z        0   0%   0% [sh]
 3355  2860 root     S     2064   7%   0% /bin/sh -c . /tmp/CRON_IS_CAREFUL
 2786     1 root     S     1816   6%   0% /usr/sbin/uhttpd -f -h /www -r rehung
 5210  3355 root     S     1728   6%   0% {cron.upgrade_pa} /bin/sh /usr/sbin/c
 1764     1 root     S     1552   5%   0% /sbin/netifd
    1     0 root     S     1396   5%   0% /sbin/procd
 7767  7758 root     S     1392   5%   0% -ash
 2860     1 root     S     1372   5%   0% /usr/sbin/crond -L /dev/null
 2074  1764 root     S     1364   5%   0% udhcpc -p /var/run/udhcpc-lo.pid -s /
 7758  7702 root     S     1196   4%   0% /usr/sbin/dropbear -F -P /var/run/dro
^C788     1 root     S     1164   4%   0% /usr/sbin/odhcpd
root@rehungen-adhoc--151:~ cat /proc/
root@rehungen-adhoc--151:~ cat /proc/6793/cmdline
/bin/opkginstall/tmp/mydesign_0.1_5210.ipkroot@rehungen-adhoc--151:~ reboot && exit



# anbieter von TK diensten:
# http://www.bundesnetzagentur.de/SharedDocs/Downloads/DE/Sachgebiete/Telekommunikation/Unternehmen_Institutionen/Anbieterpflichten/Meldepflicht/TKDiensteanbieterPDF.pdf
# http://www.bundesnetzagentur.de/SharedDocs/Downloads/DE/Sachgebiete/Telekommunikation/Unternehmen_Institutionen/Anbieterpflichten/Meldepflicht/TKDiensteanbieterPDF.pdf?__blob=publicationFile&v=31

# http://www.bundesnetzagentur.de/SharedDocs/Downloads/DE/Sachgebiete/Telekommunikation/Unternehmen_Institutionen/Anbieterpflichten/Meldepflicht/TKDiensteanbieterRTF.rtf
# http://www.bundesnetzagentur.de/SharedDocs/Downloads/DE/Sachgebiete/Telekommunikation/Unternehmen_Institutionen/Anbieterpflichten/Meldepflicht/TKDiensteanbieterRTF.rtf?__blob=publicationFile&v=33


# wget -qO - "http://10.63.43.253/msx/" | sed "s/.*<a href='\(.*\)'>.*/\1/g"
# -> /msx/Radio_Sputnik-Livemitschnitt-Terminal_A-Track1.mp3
# http://10.63.43.253/msx/Radio_Sputnik-Livemitschnitt-Terminal_A-Track1.mp3

# auch total lahm, 21.dez.16 uhr
root@DG-Fries36-Wohnzimmer:~ _wifi minstrel 10.63.22.68 debug
lq=;nlq=;cost=;Dec 21 15:54:48 ' [up 41580s 6295552 bytes free] TERM:xterm -ash [daemon.debug] minstrel_out() output of /sys/kernel/debug/ieee80211/phy0/netdev:wlan0-1/stations/00:21:6a:32:7c:1c/rc_stats
 type           rate      tpt eprob *prob ret  *ok(*cum)        ok(      cum)
 CCK/LP          1.0M     0.6  72.6 100.0   2    0(   0)       119(      536)
 CCK/SP          2.0M     0.0   5.9   0.0   2    0(   0)         1(       11)
 CCK/SP          5.5M     0.0   8.7   0.0   2    0(   0)        85(      270)
 CCK/SP         11.0M     1.9  29.1  33.3   3    0(   0)       125(      425)
 HT20/LGI  BCDP MCS0      1.2  19.6   0.0   2    0(  45)       115(     1003)
 HT20/LGI       MCS1      0.0   0.0   0.0   0    0(   0)         0(        2)
 HT20/LGI       MCS2      0.0   0.0   0.0   0    0(   0)         0(        3)
 HT20/LGI       MCS3      0.0   9.5   0.0   5    0(   0)        10(       52)
 HT20/LGI       MCS4      0.0   0.0   0.0   0    0(   0)         0(        2)
 HT20/LGI       MCS5      0.0   0.0   0.0   0    0(   0)         0(        3)
 HT20/LGI       MCS6      0.0   7.2   0.0   4    0(   0)        76(      763)
 HT20/LGI       MCS7      0.0   0.0   0.0   0    0(   0)         0(        2)
 HT20/LGI       MCS8      0.0   9.2   0.0   4    0(   0)         4(       39)
 HT20/LGI       MCS9      0.0   0.0   0.0   0    0(   0)         0(        1)
 HT20/LGI       MCS10     0.0   0.0   0.0   0    0(   0)         0(        3)
 HT20/LGI       MCS11     0.0   6.3   0.0   5    0(   0)        20(      152)
 HT20/LGI       MCS12     0.0   7.8   0.0   1    0(   0)        54(      446)
 HT20/LGI A     MCS13    20.1  26.6   0.0   5    0(  54)       222(     1250)
 HT20/LGI       MCS14     0.0   0.0   0.0   0    0(   0)         0(        2)
 HT20/LGI       MCS15     0.0   0.0   0.0   0    0(   0)         0(        2)




# cut -d' ' -f1 /proc/modules | while read M; do echo $M; rmmod $M; done

# linksys: fe80::213:10ff:fe14:c4fe%wlan1
#          fe80::213:10ff:fe14:c4fc%eth1

root@4G-meshcube:/tmp sysupgrade -n -v /tmp/fw
killall: watchdog: no process killed
Sending TERM to remaining processes ... logd netifd odhcpd dnsmasq fakedns uhttpd crond olsrd askfirst
Sending KILL to remaining processes ... askfirst
Switching to ramdisk...
Performing system upgrade...
Unlocking kernel ...

Writing from <stdin> to kernel ...
Unlocking rootfs ...

Writing from <stdin> to rootfs ...
Upgrade completed
Rebooting system...

ssh: Connection to root@fe80::20e:56ff:fe00:fc53.115302e-314th1:22 exited: Error reading:



# beispiel fuer grep-error/falsches oder fehlender escaping:
FILE="Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02/395507?-R150203-Installation_und_Geraete-J.Raback.odt"
grep pattern "$FILE"
-> Datei oder Verzeichnis nicht gefunden
-> das '?' ist wohl ein TAB und kommt von 'ls' oder 'find'

bastian@X301:~$ find Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02 -maxdepth 1 -type f -exec wc -l {} \;
3424 Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02/AGB  2015.pdf
169 Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02/Antragsformular  mit Sondertarif_2015_Raback.odt
171 Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02/Antragsformular_Internet_und AGB_Sondertarif_Raback.odt
2308 Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02/Preisliste und Leistungsbeschreibung 2015.pdf
163 Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02/2015-AnSchrzurRechnung.-Jannet.Raback.odt
158 Desktop/bittorf_wireless/kunden/Breitband-Rehungen/Kundenkommunikation/BR-R02/395507
-R150203-Installation_und_Geraete-J.Raback.odt
bastian@X301:~$ 

NEWLINE='
'

grep pattern "PRE${NEWLINE}$POST" -> OK ('?' = NEWLINE)
# http://www.dwheeler.com/essays/fixing-unix-linux-filenames.html



# A="$( seq 1 256 )"; I=10000; date +%s; while let I-=1;do logger "$A";done; date +%s

CHANNELS="$( iw phy phy0 info | fgrep ' MHz ' | grep -v 'disabled' | cut -d'[' -f2 | cut -d']' -f1 )"	#  161
CHANNELS="$( iw phy phy0 info | fgrep ' MHz ' | grep -v 'disabled' | cut -d'*' -f2 | cut -d' ' -f2 )"	# 5805
for FREQ in $CHANNELS; do {
	iw wlan0 ibss leave
	sleep 1
	echo "scan on $FREQ:"
	iw dev wlan0 ibss join XXX $FREQ fixed-freq 02:ca:ff:ee:ba:be

	I=10
	while let I-=1; do
		sleep 1
		iwconfig wlan0 | grep -q 'Cell: 02:CA:FF:EE:BA:BE' && break
	done

	iw dev wlan0 scan
} done

# lsmod | while read LINE; do case "$LINE" in *0);;*)echo $LINE;; esac; done|sort


# bilder fuer jeden router:
# https://wiki.freifunk-franken.de/w/Portal:Hardware



# block detect >/etc/config/fstab
# uci set fstab.@mount[0].enabled=1
# uci set fstab.@mount[0].target='/tmp/usb'


# autoteileladen 121: sturm openwrt r41296  

# bh: ibo: 15. nov. 2014: 06/042 E11 - war in Switchport 15 /surfst

# http://pad.freifunk.net/p/firmware


# intercity-vpn: + add to olsrd_interface_list
config interface 'innercity-vpn'
	option ifname 'tap0'
	option proto 'static'
	option ipaddr '10.63.21.121'
	option netmask '255.255.255.252'
	option mtu '1450'

# jena: https://github.com/FreifunkAdvanced/fsm-inetable/blob/master/lib/fsm/inetable/common.sh

# weimarnetz / VPN:
# https://github.com/weimarnetz/vpnconfig/#ip-schema
# https://github.com/weimarnetz/vpnconfig/blob/master/Setup.md


# kalua on server? (cgi-bin-status.html)

# http://ubuntuforums.org/archive/index.php/t-1758312.html
# iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 3/s -j ACCEPT
# iptables -A INPUT -p icmp --icmp-type echo-request -j DROP
#
SERVERSIDE=10.63.99.30
SERVERSIDE="$( _ipsystem getvar WIFIVPNSERVERADR )"
iptables -I INPUT -p udp --dport 698 -s $SERVERSIDE -j DROP
iptables -I INPUT -p udp --dport 698 -s $SERVERSIDE -m limit --limit 2/s --limit-burst 1 -j ACCEPT
#
# auf server:
DEV='tap276'
iptables -I OUTPUT -p udp --dport 698 -o $DEV -j DROP
iptables -I OUTPUT -p udp --dport 698 -o $DEV -m limit --limit 3/s --limit-burst 3 -j ACCEPT



# vpn:

root@box:~ URL='http://vpn3.weimarnetz.de/freifunk/vpn/'
root@box:~ wget -qO - "$URL"
{
    "server": "vpn3.weimarnetz.de",
    "maxmtu": "1450",
    "port_vtun_nossl_nolzo": "5001",
    "clients": "1"
}

root@box:~ jshn -r "$( wget -qO - "$URL" )"
json_init;
json_add_string 'server' 'vpn3.weimarnetz.de';
json_add_string 'maxmtu' '1450';
json_add_string 'port_vtun_nossl_nolzo' '5001';
json_add_string 'clients' '1';

root@box:~ eval $( jshn -r "$( wget -qO - "$URL" )" )

# idea: overload json_init() and json_add_string() -> superfunction: json2shell "$URL"


# check: https://wiki.opennet-initiative.de/wiki/Ubiquiti_NanoStation#POE-Durchleitung


# OLSR-Roaming:
#
# IP-Schema: DHCP = 192.168.$HNA/26
# e.g. WIFIADR  =   10.63.48.65
#      OLSR_HNA =   10.63.48.64/26
#      DCHP     = 192.168.48.65 start
#                 limit = 62
#      roaming-ip immer 192.168.0.1
#
#
# ROUTER1+2+3:
# insmod macvlan
# ip link add link $WIFI-AP2-INTERFACE name roaming address 02:ca:ff:ee:00:01 type macvlan
# ip address add 192.168.0.1/16 dev roaming
# ip link set dev roaming up
# iptables -t nat -I POSTROUTING -s 192.168.0.0/16 -j MASQUERADE
#
# LAPTOP:
# ip address add 192.168.5.2/16 dev wlan0-2
# ping -c3 192.168.5.1
# ip neigh show to 192.168.5.1
#
# dann rumlaufen und ping laufen lassen
# wechsel auf laptop zeigen lassen: _net track_ap


# script hoert mit 'iw event'
wlan0-1: new station 00:eb:2d:d4:6d:cd
wlan0-1: del station 00:1d:0d:b3:e3:13
-> olsrd2 = hna setzen/wegnehmen

# network:
#
config interface 'mastergate'
        option ifname 'roaming'
        option proto static
        option ipaddr 192.168.0.1
        option netmask 255.255.0.0

config device 'roaming'
        option type 'macvlan'
        option name 'roaming'
        option ifname '@wlanROAMING'
        option macaddr '02:ca:ff:ee:00:01'

# wireless: (2nd AP)
config wifi-iface
	option device 'radio0'
	option network 'wlanROAMING'
	option mode 'ap'
	option ssid 'weimarnetz (mobile)'

# dhcp:
#
config dhcp 'roaming'
	option interface 'mastergate'
	option start '192.168.8.1'
	option limit '253'
#
# dnsmasq-dhcp[4813]: DHCP, IP range 192.168.8.1 -- 192.168.8.253, lease time 1h

# ip a
20: roaming@wlan0-2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN group default 
    link/ether 02:ca:ff:ee:00:01 brd ff:ff:ff:ff:ff:ff
    inet 192.168.0.1/16 brd 192.168.255.255 scope global roaming
       valid_lft forever preferred_lft forever
    inet6 fe80::ca:ffff:feee:1/64 scope link 
       valid_lft forever preferred_lft forever


# uci:
network.mastergate=interface
network.mastergate.ifname=roaming
network.mastergate.proto=static
network.mastergate.ipaddr=192.168.0.1
network.mastergate.netmask=255.255.0.0
network.roaming=device
network.roaming.type=macvlan
network.roaming.name=roaming
network.roaming.ifname=@wlanRADIO1
network.roaming.macaddr=02:ca:ff:ee:00:01

Fri Oct 17 21:25:48 2014 daemon.info hostapd: wlan0-2: STA 00:21:6a:32:7c:1c IEEE 802.11: authenticated
Fri Oct 17 21:25:48 2014 daemon.info hostapd: wlan0-2: STA 00:21:6a:32:7c:1c IEEE 802.11: associated (aid 1)
Fri Oct 17 21:25:48 2014 daemon.warn dnsmasq-dhcp[13640]: DHCP packet received on wlan0-2 which has no address
Fri Oct 17 21:25:48 2014 daemon.info dnsmasq-dhcp[13640]: DHCPREQUEST(roaming) 192.168.8.60 00:21:6a:32:7c:1c 
Fri Oct 17 21:25:48 2014 daemon.info dnsmasq-dhcp[13640]: DHCPNAK(roaming) 192.168.8.60 00:21:6a:32:7c:1c wrong address
Fri Oct 17 21:25:48 2014 daemon.warn dnsmasq-dhcp[13640]: DHCP packet received on wlan0-2 which has no address
Fri Oct 17 21:25:51 2014 daemon.info dnsmasq-dhcp[13640]: DHCPDISCOVER(roaming) 00:21:6a:32:7c:1c 
Fri Oct 17 21:25:51 2014 daemon.info dnsmasq-dhcp[13640]: DHCPOFFER(roaming) 192.168.8.60 00:21:6a:32:7c:1c 
Fri Oct 17 21:25:51 2014 daemon.warn dnsmasq-dhcp[13640]: DHCP packet received on wlan0-2 which has no address
Fri Oct 17 21:25:51 2014 daemon.info dnsmasq-dhcp[13640]: DHCPREQUEST(roaming) 192.168.8.60 00:21:6a:32:7c:1c 
Fri Oct 17 21:25:51 2014 daemon.info dnsmasq-dhcp[13640]: DHCPACK(roaming) 192.168.8.60 00:21:6a:32:7c:1c X301









# PLATFORMS='rb532 ar71xx atheros au1000 brcm47xx brcm63xx kirkwood mpc85xx ramips x86_64'
# PLATFORMS="$( find /var/www/firmware -maxdepth 1 -type d -exec basename "{}" \; | tail -n+2 | grep -v 'broadcom' )"
# vi info.txt; for ARCH in $PLATFORMS; do cp info.txt ../../../$ARCH/images/testing; cp -v /tmp/tarball.tgz ../../../$ARCH/images/testing; done
#
# pwd: /var/www/firmware/ar71xx/images/testing
# md5sum /tmp/tarball.tgz

# detect change of defgw, add reason (COST-values)
# ip monitor route | while read LINE; do let I+=1; case "$LINE" in default*) echo "$I: $LINE"; traceroute -m5 -w1 -n 8.8.8.8;; esac; done

# speedtest samba: http://examplenow.com/smbclient/usage
# smbclient //10.63.195.161/freigabe -I 10.63.195.161 -c 'prompt; ls ; cd bla; mget *;'
# smbclient //10.63.195.161/freigabe -I 10.63.195.161 -c 'prompt; cd bla; ls; get goflex_2_7_1_firmware.zip /dev/null;'
# smbclient //10.63.195.161/freigabe -I 10.63.195.161 --no-pass -c 'prompt; cd bla; ls; get ubuntu-13.04-desktop-i386.iso /dev/null;'
# smbclient //10.63.195.161/freigabe -I 10.63.195.161 --no-pass -c 'prompt; cd bla; ls; put file;'


Fri Aug 22 22:12:21 2014 user.emerg syslog: iptables v1.4.21: host/network `192.168.276.0' not found
Fri Aug 22 22:12:21 2014 user.emerg syslog: Try `iptables -h' or 'iptables --help' for more information.
Fri Aug 22 22:12:21 2014 user.emerg syslog: uci: Entry not found


# pan/tilt: https://www.adafruit.com/products/1967


# traceroute/ping is not the same:
root@AlexLaterne:~ traceroute -n 8.8.8.8
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 38 byte packets
 1  10.63.8.65  1.026 ms  1.196 ms  4.459 ms
 2  10.63.93.65  12.845 ms  5.870 ms  10.084 ms
 3  192.168.171.1  9.638 ms  6.801 ms  8.797 ms
 4^C

root@AlexLaterne:~ ping 10.63.8.65
PING 10.63.8.65 (10.63.8.65): 56 data bytes
64 bytes from 10.63.8.65: seq=0 ttl=64 time=1397.935 ms
64 bytes from 10.63.8.65: seq=1 ttl=64 time=1296.531 ms
64 bytes from 10.63.8.65: seq=2 ttl=64 time=1243.560 ms
64 bytes from 10.63.8.65: seq=3 ttl=64 time=964.065 ms
64 bytes from 10.63.8.65: seq=4 ttl=64 time=921.009 ms
64 bytes from 10.63.8.65: seq=5 ttl=64 time=835.110 ms
^C
--- 10.63.8.65 ping statistics ---
7 packets transmitted, 6 packets received, 14% packet loss
round-trip min/avg/max = 835.110/1109.701/1397.935 ms

root@AlexLaterne:~ _wifi minstrel 10.63.8.65 debug
lq=0.399;nlq=0.921;cost=2.712;Aug 12 17:05:08 ' [up 46565s 4853760 bytes free] TERM:screen -ash [daemon.debug] minstrel_out() output of /sys/kernel/debug/ieee80211/phy0/netdev:wlan0-1/stations/64:66:b3:de:d9:8f/rc_stats
type         rate     throughput  ewma prob   this prob  retry   this succ/attempt   success    attempts
HT20/LGI     MCS0            6.1       98.4       100.0      3              0(  0)     96243      157081
HT20/LGI  tP MCS1            9.1       78.3       100.0      4              1(  1)     26257       51860
HT20/LGI T   MCS2           11.1       67.3        50.0      5              3(  6)    140430      249218
HT20/LGI     MCS3            0.0        0.0         0.0      0              0(  0)         6        2225
HT20/LGI     MCS4            0.0        0.0         0.0      0              0(  0)         0        2226
HT20/LGI     MCS5            0.0        0.0         0.0      0              0(  0)         0        2226
HT20/LGI     MCS6            0.0        0.0         0.0      0              0(  0)         0        2226
HT20/LGI     MCS7            0.0        0.0         0.0      0              0(  1)         0        2226



# Debug info is already staged in staging_dir/target-*/root-*. This path is used by scripts/remote-gdb, which also accepts corefiles.
# https://dev.openwrt.org/attachment/ticket/17782/fw3.1861.11.1410301939.core.txt
# e.g. staging_dir/target-*/root-*/usr/sbin/wpad

# ip monitor route | while read LINE; do case "$LINE" in '192.168.1.1 via'*) ip route del $LINE ;; esac; done

# dell truemobile 2300: tftp geht nur bis 6170 = 3.159.040 bytes = 48.bischen erase-blocks

# check: /sbin/snapshot

# noIPv6:
Making all in iptables
make[6]: Entering directory `/home/bastian/openwrt/openwrt/build_dir/target-mipsel_mips32_uClibc-0.9.33.2/linux-brcm47xx_generic/iptables-1.4.21/iptables'
/bin/bash ../libtool --tag=CC   --mode=link mipsel-openwrt-linux-uclibc-gcc -Wall -Waggregate-return -Wmissing-declarations     -Wmissing-prototypes -Wredundant-decls -Wshadow -Wstrict-prototypes    -Winline -pipe -DALL_INCLUSIVE -DENABLE_IPV4  -Os -pipe -mno-branch-likely -mips32 -mtune=mips32 -fno-caller-saves -fhonour-copts -Wno-error=unused-but-set-variable -msoft-float -I/home/bastian/openwrt/openwrt/build_dir/target-mipsel_mips32_uClibc-0.9.33.2/linux-brcm47xx_generic/iptables-1.4.21/include -I/home/bastian/openwrt/openwrt/build_dir/target-mipsel_mips32_uClibc-0.9.33.2/linux-brcm47xx_generic/linux-3.10.44/user_headers/include -ffunction-sections -fdata-sections   -L/home/bastian/openwrt/openwrt/staging_dir/target-mipsel_mips32_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/openwrt/staging_dir/target-mipsel_mips32_uClibc-0.9.33.2/lib -L/home/bastian/openwrt/openwrt/staging_dir/toolchain-mipsel_mips32_gcc-4.8-linaro_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/openwrt/staging_dir/toolchain-mipsel_mips32_gcc-4.8-linaro_uClibc-0.9.33.2/lib -Wl,--gc-sections  -o xtables-multi xtables_multi-xtables-multi.o xtables_multi-iptables-xml.o xtables_multi-iptables-save.o xtables_multi-iptables-restore.o xtables_multi-iptables-standalone.o xtables_multi-iptables.o  xtables_multi-xshared.o ../extensions/libext.a ../libiptc/libip4tc.la ../extensions/libext4.a  ../libxtables/libxtables.la -lm
OpenWrt-libtool: link: mipsel-openwrt-linux-uclibc-gcc -Wall -Waggregate-return -Wmissing-declarations -Wmissing-prototypes -Wredundant-decls -Wshadow -Wstrict-prototypes -Winline -pipe -DALL_INCLUSIVE -DENABLE_IPV4 -Os -pipe -mno-branch-likely -mips32 -mtune=mips32 -fno-caller-saves -fhonour-copts -Wno-error=unused-but-set-variable -msoft-float -I/home/bastian/openwrt/openwrt/build_dir/target-mipsel_mips32_uClibc-0.9.33.2/linux-brcm47xx_generic/iptables-1.4.21/include -I/home/bastian/openwrt/openwrt/build_dir/target-mipsel_mips32_uClibc-0.9.33.2/linux-brcm47xx_generic/linux-3.10.44/user_headers/include -ffunction-sections -fdata-sections -Wl,--gc-sections -o .libs/xtables-multi xtables_multi-xtables-multi.o xtables_multi-iptables-xml.o xtables_multi-iptables-save.o xtables_multi-iptables-restore.o xtables_multi-iptables-standalone.o xtables_multi-iptables.o xtables_multi-xshared.o  -L/home/bastian/openwrt/openwrt/staging_dir/target-mipsel_mips32_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/openwrt/staging_dir/target-mipsel_mips32_uClibc-0.9.33.2/lib -L/home/bastian/openwrt/openwrt/staging_dir/toolchain-mipsel_mips32_gcc-4.8-linaro_uClibc-0.9.33.2/usr/lib -L/home/bastian/openwrt/openwrt/staging_dir/toolchain-mipsel_mips32_gcc-4.8-linaro_uClibc-0.9.33.2/lib ../extensions/libext.a ../libiptc/.libs/libip4tc.so ../extensions/libext4.a ../libxtables/.libs/libxtables.so -ldl -lm
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x44): undefined reference to `ip6tables_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x4c): undefined reference to `ip6tables_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x54): undefined reference to `ip6tables_save_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x5c): undefined reference to `ip6tables_save_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x64): undefined reference to `ip6tables_restore_main'
xtables_multi-xtables-multi.o:(.rodata.multi_subcommands+0x6c): undefined reference to `ip6tables_restore_main'
collect2: error: ld returned 1 exit status



# nvram show | grep ^ff_ | sed 's/./nvram unset &/' | cut -d'=' -f1 | sh

# openwrt-build: iwinfo -> do not build when no wireless is there

# monitor changing defgw:
# ip monitor route | while read L; do case "$L" in def*) IP="$( echo "$L" | cut -d\  -f3 )"; echo "$(date) $HOSTNAME: defgw: $( n | grep $IP )";; esac; done

# etx * mqmult -> fixed math
# 4.047 * 0.7 = 2,832
# 4047  * 7   = 28329 -> rule: '.' -> '' and '0.' -> ''

# IPv6-Watchdog:
# - coldboot: interval = 15 mins (auch wenn kein ping kommt Zwangsausloesung)
# - erster ping: -> 2ter/Xter ping: (countdown)
#   - Abstand ergibt erwarteten Zeitpunkt für nächsten + % Schummelfaktor
#   - Faktor z.b. 1 sec / 5 sec / oder 5 min max?
# - nach X mal Router Reboot ohne erfolg: aufhören? -> oder interval erhoehen
# - ueber TTL der "ICMP"-Antwort anzeigen ob ausgeloest wurde
#   - so kann man bei einem unbekannten reboot rausfinden, ob es die Watchdog war oder was anderes
# - ueber SIZE interval einstellen

# delete route to 192.168.1.1
# while :;do sleep 1; R="$( ip r | grep ^'192\.168\.1\.1' )" && ip r d $R; done


# high load during tar.gz
Mem: 106556K used, 19960K free, 0K shrd, 3084K buff, 79984K cached
CPU:  75% usr   8% sys   0% nic   0% idle   0% io   0% irq  16% sirq
Load average: 1.59 1.89 2.11 3/39 6351
  PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
 6345  6344 root     R     1732   1%  67% {exe} gzip -f
 2980     1 root     R     4160   3%  25% /usr/sbin/olsrd -f /var/etc/olsrd.con


# I=wlan0; ssh-keygen -f "/home/bastian/.ssh/known_hosts" -R fe80::ff:ffff:feff:0%$I; ssh root@fe80::ff:ffff:feff:0%$I
# ping6 -L -c 1 -W 2 ff02::1%$iface
# ping6 ff02::1%$LANDEV

# howto:
# wget -O - http://[f8:d1:11:a9:c8:e0%25wlan0] -> http://tools.ietf.org/html/rfc6874
# wget -O - "http://[fe80::f6ec:38ff:fe9d:856e%wlan0]/cgi-bin-tool.sh?OPT=startshell"
# use curl!

# ubus list
# ubus call network.interface dump
# ubus call service list '{"verbose": true}'
# ubus -v list log	// show methods


# check changing AP:
# when 'Not-Associated', output = 'dBm'
# while true; do set -- $( iwconfig wlan0 | fgrep 'Access Point: ' ); MAC=$6; test "$4" = 'Not-Associated' && continue; test "$MAC" = "$OLD_MAC" || { echo "$( date ): $MAC"; OLD_MAC="$MAC"; }; sleep 5; done
# or
# iw event -t

# wget -O /dev/null http://10.63.45.1/cgi-bin/luci/freifunk/status/zeroes

# echo 0 > /sys/kernel/debug/ieee80211/phy0/ath9k/ani

# https://etherpad.mozilla.org/mesh-networking
# http://www.reddit.com/r/Hocnet
# https://ezcrypt.it/QE8n#uTi265vSsfshFqDVsy4BzFs6
# https://groups.google.com/forum/#!topic/portland-meshnet/lBjLJHLBHUs

# http://wiki.freifunk.net/IPv6:Prefixe
# http://wiki.freifunk.net/IPv6/IPv6Concepts


Wed Jun 18 00:35:50 2014 daemon.notice hostapd: wlan0-1: STA 00:21:6a:32:7c:1c IEEE 802.11: did not acknowledge authentication response
Wed Jun 18 00:35:54 2014 daemon.notice hostapd: wlan0-1: STA 00:21:6a:32:7c:1c IEEE 802.11: did not acknowledge authentication response
Wed Jun 18 00:35:58 2014 daemon.notice hostapd: wlan0-1: STA 00:21:6a:32:7c:1c IEEE 802.11: did not acknowledge authentication response
Wed Jun 18 00:36:01 2014 user.notice root: debug: phy: phy0 interval: 60 avg: 20 avg_overall: 27 change: 35%
Wed Jun 18 00:36:02 2014 daemon.info hostapd: wlan0-1: STA 00:21:6a:32:7c:1c IEEE 802.11: authenticated
Wed Jun 18 00:36:06 2014 daemon.notice hostapd: wlan0-1: STA 00:21:6a:32:7c:1c IEEE 802.11: did not acknowledge authentication response
Wed Jun 18 00:36:06 2014 daemon.info hostapd: wlan0-1: STA 00:21:6a:32:7c:1c IEEE 802.11: associated (aid 1)
Wed Jun 18 00:36:09 2014 daemon.info dnsmasq-dhcp[2515]: DHCPDISCOVER(wlan0-1) 10.63.22.78 00:21:6a:32:7c:1c 
Wed Jun 18 00:36:09 2014 daemon.info dnsmasq-dhcp[2515]: DHCPOFFER(wlan0-1) 10.63.22.78 00:21:6a:32:7c:1c 
Wed Jun 18 00:36:11 2014 daemon.info dnsmasq-dhcp[2515]: DHCPREQUEST(wlan0-1) 10.63.22.78 00:21:6a:32:7c:1c 
Wed Jun 18 00:36:11 2014 daemon.info dnsmasq-dhcp[2515]: DHCPACK(wlan0-1) 10.63.22.78 00:21:6a:32:7c:1c X301



# http://wiki.openwrt.org/doc/uci#file.syntax
# http://wiki.openwrt.org/doc/uci#uci.paths


# TODO: check during write_config() if at least 1 interface has
#       an fd24:31bb:f31c::1/60 ULA
#
# olsrd2 --load /etc/olsrd2.conf --schema=log.debug 
# olsrd2 --load /etc/olsrd2.conf --set log.debug=os_system
# olsrd2 --load /etc/olsrd2.conf --set domain.table=233
#
# make package/oonf-api-git/clean
# make package/olsrd2-git/clean
# make package/olsrd2-git/compile
#
# auf loopback: option ip6assign 60 -> gives ULA = uci set network.loopback.ip6assign=60
#
# echo "/nhdpinfo link" | nc 127.0.0.1 2009
# echo "/olsrv2info edge" | nc 127.0.0.1 2009
# echo "/netjsoninfo route" | nc 127.0.0.1 2009
# old:
# echo "/nhdp iflink"    | nc 127.0.0.1 2009
# echo "/nhdp neighlink" | nc 127.0.0.1 2009
# echo "/layer2 net"     | nc 127.0.0.1 2009



uci add network  cityVPN
uci set network.@cityVPN[-1].interface='tap0'
uci set network.@cityVPN[-1].proto=static

uci set network.cityVPN=interface
uci set network.cityVPN.proto=static
uci set network.cityVPN.interface=tap0


# profiling in scheduler_run()
# olsr-uptime/neustarts zeigen


vtund_build_type()
{
	local file='/tmp/vtund_build_type'

	[ -e "$file" ] || {
		set -- $( ldd /usr/sbin/vtund )
		case "$@" in
			*'liblzo'*'libcrypto'*)
				echo >"$file" 'LZOSSL'
			;;
			*'liblzo'*)
				echo >"$file" 'LZOnoSSL'
			;;
			*)
				echo >"$file" 'noLZOnoSSL'
			;;
		esac
	}

	cat "$file"
}

# vtund: noSSL, noLZO
# root@bebelplatz4-triererstr:~ ldd /usr/sbin/vtund
	libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x77761000)
	libc.so.0 => /lib/libc.so.0 (0x776f4000)
	ld-uClibc.so.0 => /lib/ld-uClibc.so.0 (0x77784000)
# vtund: noSSL, LZO
# root@EG-labor-AP:~ ldd /usr/sbin/vtund
        libz.so.1 => /usr/lib/libz.so.1 (0x774c6000)
        liblzo2.so.2 => /usr/lib/liblzo2.so.2 (0x774a4000)
        libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x77480000)
        libc.so.0 => /lib/libc.so.0 (0x77413000)
        ld-uClibc.so.0 => /lib/ld-uClibc.so.0 (0x774e4000)
# vtund: SSL + LZO
# bastian@X301:~$ ldd /usr/sbin/vtund
	linux-gate.so.1 =>  (0xb7771000)
	libz.so.1 => /lib/i386-linux-gnu/libz.so.1 (0xb7739000)
	liblzo2.so.2 => /usr/lib/i386-linux-gnu/liblzo2.so.2 (0xb7716000)
	libcrypto.so.1.0.0 => /lib/i386-linux-gnu/libcrypto.so.1.0.0 (0xb756a000)
	libutil.so.1 => /lib/i386-linux-gnu/libutil.so.1 (0xb7566000)
	libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb73b2000)
	libdl.so.2 => /lib/i386-linux-gnu/libdl.so.2 (0xb73ad000)
	/lib/ld-linux.so.2 (0xb7772000)




# cron.min-ping fails -> inet_stable
# shoutbox jenaplan 

# 24h-tickets adagio

# vpn zwischen zwei entfernten nodes?
# tap0 als olsr-interface
# ipip-tunnel?

# auf 10.63.19.97 (Matterhorn)
list inkQualityMult '10.63.45.2 0.5'           # christian
list LinkQualityMult '10.63.95.65 0.8'          # matterhorn -> wachturm (soll ethernet)
list LinkQualityMult '10.63.19.65 0.7'          # F36dach


# https://wiki.ubuntu.com/DashAsBinSh


# dcf77
# ln -s /dev/ttyUSB0 /dev/refclock-0
#
root@703n:~ cat /etc/ntp.conf 
# use a random selection of 4 public stratum 2 servers
# see http://twiki.ntp.org/bin/view/Servers/NTPPoolServers
#restrict default nomodify notrap noquery
#restrict default noquery
driftfile  /var/lib/ntp/ntp.drift
server 127.127.8.0 prefer mode 14
restrict default ignore
restrict 127.127.8.0 nomodify
restrict 127.0.0.1 nomodify
restrict 10.0.0.0 mask 255.0.0.0 nomodify
logfile /tmp/ntp.txt
logconfig =all
#
#
ntpq -c clocklist
ntpq -c peers
ntpq -c cv -c rv





test -e /tmp/HHH || {
 set | grep -v ^strong_debug= | grep -v ^logfile= | grep -v ^line= | grep -v ^funcname= | grep -v ^file= | grep -v ^board= | grep ^[a-z] >/tmp/HHH2 && {
  cat /tmp/HHH2 >/tmp/HHH
  echo "$line" >>/tmp/HHH
  date >>/tmp/HHH
 }
}



root@KG-serverraum-MESH:~ ip n|grep 00:19:99:d0:da:e8
fe80::1c4:ee8c:6f32:7bf5 dev eth0.1 lladdr 00:19:99:d0:da:e8 STALE
10.63.4.53 dev eth0.1 lladdr 00:19:99:d0:da:e8 REACHABLE
10.63.4.55 dev eth0.1 lladdr 00:19:99:d0:da:e8 STALE



root@4900erHybrid-kueche:~ ip n|fgrep 10.63.222.
10.63.222.3 dev wlan0 lladdr 64:70:02:d3:24:0c STALE
10.63.222.1 dev wlan1 lladdr 64:70:02:d3:24:0b STALE
10.63.222.1 dev wlan0 lladdr 64:70:02:d3:24:0c STALE



Wed Apr 16 11:33:06 2014 daemon.info dnsmasq-dhcp[2505]: DHCPDISCOVER(eth0.1) 00:23:8b:a5:18:dc
Wed Apr 16 11:33:06 2014 daemon.info dnsmasq-dhcp[2505]: DHCPOFFER(eth0.1) 10.63.11.113 00:23:8b:a5:18:dc
Wed Apr 16 11:33:06 2014 daemon.info dnsmasq-dhcp[2505]: DHCPREQUEST(eth0.1) 10.63.11.113 00:23:8b:a5:18:dc
Wed Apr 16 11:33:06 2014 daemon.info dnsmasq-dhcp[2505]: DHCPACK(eth0.1) 10.63.11.113 00:23:8b:a5:18:dc InaMichalski-PC
Wed Apr 16 11:33:24 2014 daemon.alert fff+ /etc/dhcp-script.d/10dhcpscript netfilter_user_reachable(): no_success: mac: 00:23:8b:a5:18:dc ip: 10.63.11.112 devlist: 'eth0.1  wlan0  wlan0-1 '
Wed Apr 16 11:33:24 2014 daemon.info fff+ /etc/dhcp-script.d/10dhcpscript netfilter_user_add(): [ERR] unreachable - mac: '00:23:8b:a5:18:dc' ip: '10.63.11.112'
Wed Apr 16 11:33:24 2014 daemon.info fff+ /etc/dhcp-script.d/10dhcpscript dhcp_del(): '00:23:8b:a5:18:dc' is from 'eth0.1' = lan-DEV
Wed Apr 16 11:33:24 2014 daemon.info fff+ /etc/dhcp-script.d/10dhcpscript dhcp_add(): '00:23:8b:a5:18:dc' is from 'eth0.1' = lan-DEV
Wed Apr 16 11:33:24 2014 daemon.info fff+ /etc/dhcp-script.d/10dhcpscript mac_is_from_lan(): mac 00:23:8b:a5:18:dc is from LAN
Wed Apr 16 11:33:24 2014 daemon.info fff+ /etc/dhcp-script.d/10dhcpscript EG-steinmetzBuero_dhcp-add(): [OK] _weblogin login_check 00:23:8b:a5:18:dc
Wed Apr 16 11:34:01 2014 user.notice root: debug: phy: phy0 interval: 60 avg: 245 avg_overall: 225 change: -8%
Wed Apr 16 11:35:01 2014 user.notice root: debug: phy: phy0 interval: 60 avg: 223 avg_overall: 227 change: 1%
Wed Apr 16 11:35:47 2014 daemon.debug fff+ TERM:screen -ash netfilter_user_reachable(): probing: mac: 00:23:8b:a5:18:dc ip: 10.63.11.113 dev: 'eth0.1'
Wed Apr 16 11:35:47 2014 daemon.info fff+ TERM:screen -ash netfilter_user_add(): mac: 00:23:8b:a5:18:dc ip: 10.63.11.113



# https://dev.openwrt.org/ticket/15572
For small memory kernel optimized routing                                                                             
 {{{                                                                                                                   
 vm.min_free_kbytes=1                                                                                                  
 vm.vfs_cache_pressure=500                                                                                             
 vm.dirty_ratio=50                                                                                                     
 vm.overcommit_memory=0                                                                                                
 vm.overcommit_ratio=10                                                                                                
 vm.dirty_ratio=20                                                                                                     
 vm.dirty_expire_centisecs=1500                                                                                        
 vm.drop_caches=3                                                                                                      
 }}}                 





# txpower:
# iw dev "$ifname" set txpower fixed "${txpower%%.*}00"
# iw dev "wlan0" set txpower fixed "2000"

# nodejs:
# https://code.google.com/p/v8/wiki/BuildingWithGYP
# https://github.com/paul99/v8m-rb
# https://github.com/paul99/v8m-rb/pull/19
# http://fibasile.github.io/compiling-nodejs-for-arduino-yun.html
# http://linino.org/doku.php?id=wiki:nodejsbuild#the_easy_waydownload_the_compiled_linino_toolchain_and_the_openwrt_sdk
# http://stackoverflow.com/questions/22914681/cross-compiling-node-js-modules-on-mips-big-endian
# https://forum.openwrt.org/viewtopic.php?id=34410
# https://github.com/brimstone/nodejs-openwrt

# RippleOS: http://www.right.com.cn/forum/thread-134949-1-1.html

# openwrt-desktop
# https://github.com/larsclausen/

# find . -type f -name Makefile | xargs fgrep 'rb532'

# USB/3G-Modems/Openwrt: http://ofmodemsandmen.com/downloads.html

# openwrt: USB: 5 ghz: https://forum.openwrt.org/viewtopic.php?id=48248

# bluetooth-networking: http://giovanni.wordpress.com/2007/04/06/how-to-use-tcpip-over-bluetooth/

# javascript: http://wiki.openwrt.org/toh/start

# store data:
Please don't use /var/state for more network related stuff like this.                                                                          
You can use something like the following:                                                                                                      
ubus call network.interface.<name> set_data '{ "name": "value" }'                                                                              
                                                                                                                                               
That way you can store name/value pairs in the per-interface data in                                                                           
netifd, which you can retrieve via interface status. When the interface                                                                        
goes down, the data is cleared again, so cleanup is easy.          

# 60 GHz:
# http://wireless.kernel.org/en/users/Drivers/wil6210
# https://wikidevi.com/wiki/List_of_802.11ad_Hardware
# http://wilocity.com/products/reference-designs


# http://news.gmane.org/gmane.comp.embedded.pandaboard

# eigenes paket anlegen, z.b.
# package/utils/arduino-serial
# Makefile reinkopieren
# make menuconfig -> aktivieren
# make package/arduino-serial/compile	# achtung: ohne 'utils'
#
# e.g.: menuconfig -> lang
define Package/node
  DEPENDS:=+libpthread +librt +uclibcxx
  SECTION:=lang
  CATEGORY:=Languages
  TITLE:=Node.js is a platform built on Chrome's JavaScript runtime
  URL:=http://nodejs.org/
endef




# 

# checkout: darkstat

# Dave Taht: Re: [Battlemesh] recommendations for 40Km Link
# http://snapon.lab.bufferbloat.net/~cero2/jimreisert/results.html
# netperf-wrapper -l 60 --disable-log -p all_scaled -o mytest.svg -H                                                                                           # server -t 'test title' rrul_be # or rrul                 

# http://de.wikipedia.org/wiki/Andrew_File_System

# openwrt / panda / target = omap4430
# list files on ext2 on part2:
# ext2ls mmc 0:2
# load:
# load mmc 0:2 0x80300000 openwrt-omap-zImage
# bootz 0x80300000
#
# partition1 = fat16 -> files: 'MLO' + 'u-boot'
# partition2 = ext4  -> files: rootfs + /boot + /boot/zImage + /boot/*.dtb



# https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/tree/arch/mips/boot/compressed/decompress.c?id=refs/tags/v3.10.58
# patch / upgrade new kernel:
# git checkout -n kernel_upgrade
#
# (loop starts here)
# vi target/linux/ar71xx/Makefile
# make target/linux/clean		# clean kernel tree
# make -j5 target/linux/compile		# rebuild kernel
#
# make -j5 target/install		# rebuild kernel + image files
# 
# ??? make package/kernel/mac80211/clean + compile
#
# make package/kernel/linux/clean


URL='https://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.10.50'
shortlog() {
clear; echo "$URL"; echo; wget -qO - "$URL" |
 while read LINE; do
	case "$LINE" in
		'commit'*|'Signed-off-by: '*|'Acked-by: '*|'Cc: '*|'Reported-by:'*|'Link: '*|'Fixes: '*|'['*)
			PARSE=
		;;
		'Date:'*)
			PARSE=1
		;;
		*': '*)
			test -n "$PARSE" && echo "$LINE"
		;;
	esac
done | sort
}
shortlog "$URL"

# git rm/add $changed/deleted_patchfiles
# git add target/linux/ar71xx/Makefile
# git diff --cached --color
# git commit
  base-files: show hint when JFFS2-partition is full and overlayfs mounted read-only

  [ar71xx/kernel] upgrade 3.10.49 to 3.10.50 - released 2014-07-28

  [ar71xx/kernel] upgrade 3.10.49 to 3.10.50 - released 2014-07-28

  compile tested. runtime tested.

  shortlog from https://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.10.50
  ...

# (or loop here)
# git format-patch -s -1
# git checkout master
#
# git apply --reject --whitespace=fix mychanges.path

# /sys/kernel/debug/ieee80211/phy0/ath9k/dump_nfcal
# /sys/kernel/debug/ieee80211/phy0/ath9k/reset
# /sys/kernel/debug/ieee80211/phy*/ath9k/interrupt
# /sys/kernel/debug/ieee80211/phy0/ath9k/queues
# /sys/kernel/debug/ieee80211/phy0/queues
# for W in reset interrupt queues;do for F in /sys/kernel/debug/ieee80211/phy*/ath9k/$W /sys/kernel/debug/ieee80211/phy*/queues; do echo "### $F"; cat $F; done; done
#
# echo 1 >/sys/kernel/debug/ieee80211/phy0/ath9k/disable_ani
# more debug: (https://dev.openwrt.org/ticket/15320#comment:29)
# echo 0x4409 >/sys/kernel/debug/ieee80211/phy0/ath9k/debug
# echo 0x48   >/sys/kernel/debug/ieee80211/phy0/ath9k/debug	(ATH_DBG_ANI + ATH_DBG_CALIBRATE)
# echo 0x40   >/sys/kernel/debug/ieee80211/phy0/ath9k/debug	(ATH_DBG_ANI)
# echo '0xffffffff' > /sys/kernel/debug/ieee80211/phy0/ath9k/debug
#
# https://github.com/cjdelisle/athdrvrs/blob/master/ath.h
#  * The debug level is used to control the amount and type of debugging output
 * we want to see. Each driver has its own method for enabling debugging and
 * modifying debug level states -- but this is typically done through a
 * module parameter 'debug' along with a respective 'debug' debugfs file
 * entry.
 */
enum ATH_DEBUG {
	ATH_DBG_RESET		= 0x00000001,
	ATH_DBG_QUEUE		= 0x00000002,
	ATH_DBG_EEPROM		= 0x00000004,
	ATH_DBG_CALIBRATE	= 0x00000008,
	ATH_DBG_INTERRUPT	= 0x00000010,
	ATH_DBG_REGULATORY	= 0x00000020,
	ATH_DBG_ANI		= 0x00000040,
	ATH_DBG_XMIT		= 0x00000080,
	ATH_DBG_BEACON		= 0x00000100,
	ATH_DBG_CONFIG		= 0x00000200,
	ATH_DBG_FATAL		= 0x00000400,
	ATH_DBG_PS		= 0x00000800,
	ATH_DBG_BTCOEX		= 0x00001000,
	ATH_DBG_WMI		= 0x00002000,
	ATH_DBG_BSTUCK		= 0x00004000,
	ATH_DBG_MCI		= 0x00008000,
	ATH_DBG_DFS		= 0x00010000,
	ATH_DBG_WOW		= 0x00020000,
	ATH_DBG_ANY		= 0xffffffff
};







# TEMPer2:
# https://github.com/s-leroux/TEMPer2/blob/master/Makefile
# https://github.com/s-leroux/TEMPer2
# http://dp.nonoo.hu/measuring-temperature-using-openwrt/
# openwrt 0c45:7401
# https://dev.openwrt.org/ticket/10577
# https://dev.openwrt.org/attachment/ticket/10577/temper.zip



root: ich = 'dnt3' nachbar = '/tmp/dnt1.log' : signal: -56 [-56] dBm
root: ich = 'dnt3' nachbar = '/tmp/dnt1.log' : signal avg: -56 [-56] dBm
root: trying ec:88:8f:c6:69:3a
root: ich = 'dnt3' nachbar = '/tmp/dnt2.log' : signal: -53 [-53] dBm
root: ich = 'dnt3' nachbar = '/tmp/dnt2.log' : signal avg: -53 [-53] dBm
root: trying 6c:e8:73:eb:2b:90
Failed to connect to generic netlink.

   

92 root         0 SW   [kswapd0]
  137 root         0 SW   [fsnotify_mark]
  152 root         0 SW<  [ath79-spi]
  228 root         0 SW<  [deferwq]
  232 root         0 SW<  [kworker/0:1H]
  283 root         0 SW   [khubd]
  320 root         0 SWN  [jffs2_gcd_mtd3]
  381 root       908 S    /sbin/ubusd
  382 root       772 S    /sbin/askfirst ttyS0 /bin/ash --login
  623 root      2056 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
  838 root         0 SW   [kworker/u2:1]
  839 root         0 SW   [kworker/0:1]
 1570 root         0 SW<  [cfg80211]
 1662 root      1344 S    /sbin/logd
 1693 root      1488 S    /sbin/netifd
 1711 root      1160 S    /usr/sbin/odhcpd
 2036 root      1372 S    udhcpc -p /var/run/udhcpc-lo.pid -s /lib/netifd/dhcp
 2402 nobody    1020 S    /usr/sbin/dnsmasq -C /var/etc/dnsmasq.conf -k
 2421 root       976 S    /usr/sbin/dnsmasq -C /var/etc/dnsmasq.conf -k
 2548 root         0 SW   [kworker/u2:0]
 2675 nobody     904 S    /sbin/fakedns --address=/#/10.10.2.129 -p 5353
 2872 root      1100 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p
 2921 root      1672 S    /usr/sbin/uhttpd -f -h /www -r EG-INETrezeption-MESH
 2989 root      1380 S    /usr/sbin/crond -L /dev/null
 4246 root         0 SW   [kworker/0:0]
 4960 root      1544 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
 4967 root      1352 S    sleep 30
 4971 root      1352 S    sleep 30
 4975 root      1352 S    sleep 30
 4979 root      1352 S    sleep 30
 4983 root      1352 S    sleep 30
 4989 root      1352 S    sleep 30
 4991 root      1352 S    sleep 30
 4995 root      1352 S    sleep 30
 5005 root      1352 S    sleep 30
 5031 root      1360 R    ps
 5298 root      2120 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
 7265 root      1376 S    /usr/sbin/olsrd -f /var/etc/olsrd.conf -nofork
10387 root      2060 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
17601 root      2064 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
21168 root      2048 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
23580 root      2068 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
25042 root      2052 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
28763 root      2056 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
30385 root      2068 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL


# dynamic-client-portfw:
# list of mac's + mapping extern -> intern port (can be one than once per device)
# e.g. 00:11:22:33:44:55 -> 10080 -> 80 + 10443 -> 443


# build old kernel with git://nbd.name/aa-mac80211.git

Mar 06 08:53:10 ' [up 7626s 5140480 bytes free] /bin/sh [daemon.alert] olsr_daemon() start: has_crashed
Mar 06 08:53:12 ' [up 7628s 4583424 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/olsrd.6188.11.1394092386.core)
Mar 06 09:00:09 ' [up 8044s 4308992 bytes free] /bin/sh [daemon.alert] olsr_daemon() start: has_crashed
Mar 06 09:00:11 ' [up 8046s 3788800 bytes free] /bin/sh [daemon.alert] olsr_daemon() start: has_crashed
Mar 06 09:00:12 ' [up 8047s 3575808 bytes free] /bin/sh [daemon.alert] olsr_daemon() start: has_crashed
Mar 06 09:00:13 ' [up 8048s 2912256 bytes free] /bin/sh [daemon.alert] olsr_daemon() start: has_crashed
Mar 06 09:00:14 ' [up 8049s 2580480 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/olsrd.4551.10.1394092805.core)
Mar 06 09:00:15 ' [up 8050s 5816320 bytes free] /bin/sh [daemon.alert] watch_coredump() cron died, restarting
Mar 06 09:00:16 ' [up 8051s 5246976 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/r39139.ar71xx.crond.2510.10.1394092811.core
Mar 06 09:00:16 ' [up 8051s 3977216 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:16 ' [up 8051s 3944448 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.5893.11.1394092812.core)
Mar 06 09:00:16 ' [up 8052s 4493312 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:17 ' [up 8052s 3747840 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6130.11.1394092816.core)
Mar 06 09:00:17 ' [up 8052s 4337664 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:17 ' [up 8053s 3624960 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6129.11.1394092816.core)
Mar 06 09:00:17 ' [up 8053s 4198400 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:18 ' [up 8053s 2920448 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6320.11.1394092817.core)
Mar 06 09:00:18 ' [up 8053s 3432448 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:19 ' [up 8054s 3350528 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6244.11.1394092817.core)
Mar 06 09:00:19 ' [up 8054s 3977216 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:19 ' [up 8054s 2662400 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6397.6.1394092818.core)
Mar 06 09:00:19 ' [up 8055s 3403776 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:20 ' [up 8055s 3092480 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6392.11.1394092818.core)
Mar 06 09:00:20 ' [up 8055s 3723264 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:20 ' [up 8056s 3698688 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6547.11.1394092819.core)
Mar 06 09:00:20 ' [up 8056s 4276224 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:21 ' [up 8056s 3657728 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6546.11.1394092819.core)
Mar 06 09:00:21 ' [up 8056s 4227072 bytes free] /bin/sh [daemon.alert] watch_coredump() segfault in script, removing lockfiles
Mar 06 09:00:21 ' [up 8057s 4165632 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/sh.6759.11.1394092821.core)
Mar 06 09:16:15 ' [up 9010s 2756608 bytes free] /bin/sh [daemon.alert] watch_dns_resolution() dnsmasq died, old PIDs: '2549', restarted, PID now '11712 11710'
Mar 06 09:17:06 ' [up 9061s 4362240 bytes free] /bin/sh [daemon.alert] olsr_daemon() start: has_crashed
Mar 06 09:17:09 ' [up 9064s 3563520 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/olsrd.5961.11.1394093825.core)
Mar 06 09:20:41 ' [up 9277s 2961408 bytes free] /bin/sh [daemon.alert] olsr_daemon() start: has_crashed
Mar 06 09:20:44 ' [up 9279s 2756608 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/null (low storage: was: /tmp/olsrd.12054.11.1394094035.core)
Mar 06 09:20:44 ' [up 9279s 5136384 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/r39139.ar71xx.hostapd.5813.11.1394094038.core
Mar 06 09:20:44 ' [up 9280s 5275648 bytes free] /bin/sh [daemon.alert] watch_coredump() cron died, restarting
Mar 06 09:20:45 ' [up 9281s 4767744 bytes free] /bin/sh [daemon.alert] watch_coredump() wrote: /dev/r39139.ar71xx.crond.6081.10.1394094041.core
Mar 06 09:21:32 ' [up 9328s 2121728 bytes free] /bin/sh [daemon.alert] scheduler_allow_run() removing lockfile, which seems to be left by accident
root@boltenhagendh-ap--75:~ date
Fri Mar  7 11:33:56 CET 2014
root@boltenhagendh-ap--75:~ reboot
root@boltenhagendh-ap--75:~ _system crashreboot




# how to configure the order of languages in captive portal
# HTTP_ACCEPT_LANGUAGE=de-DE,de;q=0.8,en-US;q=0.6,en;q=0.4
# reverse ssh tunnel
# sixxx.net / tunnelbroker.net 
# local repo for keys/design, so only 1 node must change
# password is in profile -> how profile looks like
# automount: ext2/vfat/btrfs


# nping -c1 --data-string "Geheimcode1234" 10.63.2.1

root@dhsylt-adhoc--72:~ ps
  PID USER       VSZ STAT COMMAND
    1 root      1344 R    /sbin/procd
    2 root         0 SW   [kthreadd]
    3 root         0 SW   [ksoftirqd/0]
    5 root         0 SW<  [kworker/0:0H]
    7 root         0 SW<  [khelper]
   58 root         0 SW<  [writeback]
   60 root         0 SW<  [bioset]
   62 root         0 SW<  [kblockd]
   92 root         0 SW   [kswapd0]
  137 root         0 SW   [fsnotify_mark]
  152 root         0 SW<  [ath79-spi]
  228 root         0 SW<  [deferwq]
  280 root         0 SW   [khubd]
  318 root         0 SWN  [jffs2_gcd_mtd3]
 1516 root         0 SW<  [bat_events]
 1617 root         0 SW<  [cfg80211]
 3284 root      1160 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p 22
 3315 root      1664 S    /usr/sbin/uhttpd -f -h /www -r dhsylt-adhoc--72 -c /etc/httpd.conf -x /cgi-bin -t 60 -T 30 -A 1 -E /cgi-bin-404.sh
 5298 root         0 SW   [kworker/0:0]
 5300 root         0 SW   [kworker/u2:2]
 6591 root      2192 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
10432 root         0 SW<  [kworker/0:1H]
12880 root      2204 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
17673 root      2204 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
18670 root      2176 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
19622 root      2184 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
20736 root      2184 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
20738 root         0 Z    [fgrep]
20739 root         0 Z    [cut]
20799 root      2204 R    /bin/sh -c . /tmp/CRON_IS_CAREFUL
21197 root      2204 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
21198 root      2204 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL
21199 root      1484 S    fgrep FILE: 'tarball.tgz'
21200 root      1484 S    cut -d  -f2
21204 root      1304 S    /sbin/logd
21205 root       880 S    /sbin/ubusd
21208 root         0 RW   [kworker/0:1]
21209 root         0 SW   [kworker/u2:0]
21210 root         0 SW   [kworker/0:2]
21211 root         0 SW   [kworker/u2:1]
21212 root      1204 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p 22
21213 root      1676 S    -ash
21218 root         0 SW   [kworker/u2:3]
21308 root      1488 R    ps
25156 root      1536 S    /sbin/netifd
25234 root         0 Z    [udhcpc]
29751 root      2192 S    /bin/sh -c . /tmp/CRON_IS_CAREFUL




# uh! r99:
root@EG-labor-AP:~ _firmware update_pmu
-ash: /tmp/kalua/firmware: line 6: _firmware_conf: not found
-ash: /tmp/kalua/firmware: romGwrootbin/db_backup.tgz: not found
-ash: /tmp/kalua/firmware: /www/NETFILTER_AUTOADD: not found
-ash: /tmp/kalua/firmware: /www/NETPARAM: Permission denied
-ash: /tmp/kalua/firmware: /etc/HARDWARE: Permission denied
-ash: /tmp/kalua/firmware: /www/switch.txt: Permission denied
-ash: /tmp/kalua/firmware: /www/SIMPLE_MESHNODE_FORCE_DHCP_LAN: not found
Connection to 10.63.99.33 closed.



# ethernet tot: 1043nd:
root@R5orange-E1technik-MESH:~ dmesg 
[28531.430000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[28533.760000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[28536.940000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[28546.430000] eth0: link down
[28546.450000] ar71xx: pll_reg 0xb8050014: 0x1a000000
[28546.450000] eth0: link up (1000Mbps/Full duplex)
[28547.820000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[28550.100000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[28562.400000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[28562.730000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready


# ubus call network.interface.lan status


# git clone git://nbd.name/aa-mac80211.git


# capture hostapd management traffic
http://wiki.openwrt.org/doc/devel/debugging#capture.management.traffic

# unstripped bauen:
make package/odhcpd/{clean,compile} STRIP=/bin/true

# alle originatoren:
set -- $( batctl o ); while [ -n "$1" ]; do case "$1" in *'/'*) ;; *']'*) ;; *':'*) echo $1 ;; esac; shift; done | sort
set -- $( batctl o ); while [ -n "$1" ]; do _sanitizer run "$1" mac check && echo "$1"; shift; done | sort -u
set -- $( batctl o ); while [ -n "$1" ]; do _sanitizer run "$1" mac check && echo "$1"; shift; done | cut -b12- | sort -u

# procd:
# init_debug=4 in cmdline

# Use the source, luke.
# A Ship Is Safe In The Harbor,  But That's Not What Ships Are For
# http://www.youtube.com/watch?v=JNi-2ehPU1U = 'X Farnhams Legende: Kapitel 1'

# check arp-table size:
# http://www.serveradminblog.com/2011/02/neighbour-table-overflow-sysctl-conf-tunning/

# 4900erV1-kueche / jede minute:
usbcore: deregistering interface driver snd-usb-audio
usb_audio: Warning! Unlikely big volume range (=4096), cval->res is probably wrong.
usb_audio: [5] FU [Mic Capture Volume] ch = 1, val = 0/4096/1<6>[16415.356306] usbcore: registered new interface driver snd-usb-audio


# report: r39404
up: 28428.35 load: 0.28 rest: 0.33 0.29 3/41 12489
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
EG-labor-AP
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
up: 28488.06 load: 0.10 rest: 0.27 0.28 2/41 12541
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
EG-labor-AP
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
up: 28548.28 load: 0.39 rest: 0.33 0.30 4/41 12594
procd: watchdog_timeout_cb(37): Ping
procd: instance_exit(203): Instance ubus::instance1 exit with error code 11 after 28572 seconds
procd: instance_exit(203): Instance odhcpd::instance1 exit with error code 11 after 28555 seconds
procd: instance_start(174): Started instance ubus::instance1
procd: instance_exit(203): Instance log::instance1 exit with error code 10 after 28558 seconds
procd: watchdog_timeout_cb(37): Ping
procd: instance_start(174): Started instance odhcpd::instance1
parent: /bin/sh system_crashreboot() reason: 'olsrd_missing'
procd: instance_start(174): Started instance log::instance1
procd: watchdog_timeout_cb(37): Ping
procd: watchdog_timeout_cb(37): Ping
[28596.450000] SysRq : Trigger a crash
[28596.450000] CPU 0 Unable to handle kernel paging request at virtual address 00000000, epc == 801a6f2c, ra == 801a72f4
[28596.450000] Oops[#1]:
[28596.450000] CPU: 0 PID: 12721 Comm: ux4,1390925890, Not tainted 3.10.28 #5



# report: r39139
Wed Jan 15 13:29:37 2014 kern.info kernel: [32900.550000] eth0: link down
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Removing interface eth0.1
Wed Jan 15 13:29:37 2014 kern.debug kernel: [32900.580000] ar71xx: pll_reg 0xb8050014: 0x1a000000
Wed Jan 15 13:29:37 2014 kern.info kernel: [32900.580000] eth0: link up (1000Mbps/Full duplex)
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Removing interface eth0.2
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Writing '0' (was 0) to /proc/sys/net/ipv4/conf/eth0.1/send_redirects
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Writing '0' (was 0) to /proc/sys/net/ipv4/conf/eth0.1/rp_filter
Wed Jan 15 13:29:37 2014 daemon.notice netifd: Interface 'lan' is now up
Wed Jan 15 13:29:37 2014 daemon.notice netifd: Interface 'loopback' is now up
Wed Jan 15 13:29:37 2014 daemon.notice netifd: Interface 'wan' is now up
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Adding interface eth0.1
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Writing '0' (was 0) to /proc/sys/net/ipv4/conf/eth0.2/send_redirects
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Writing '0' (was 0) to /proc/sys/net/ipv4/conf/eth0.2/rp_filter
Wed Jan 15 13:29:37 2014 daemon.info olsrd[2585]: Adding interface eth0.2
Wed Jan 15 13:29:37 2014 daemon.warn 6relayd[2622]: Termination requested by signal.
Wed Jan 15 13:29:37 2014 daemon.warn 6relayd[2622]: Failed to relay to ff02::1%eth0.1 (Cannot assign requested address)
Wed Jan 15 13:29:38 2014 kern.info kernel: [32901.540000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
Wed Jan 15 13:29:38 2014 kern.info kernel: [32901.560000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
Wed Jan 15 13:29:41 2014 daemon.notice netifd: radio0 (16174): Bus error (core dumped)
Wed Jan 15 13:29:41 2014 daemon.notice netifd: radio0 (16174): Device setup failed: HOSTAPD_START_FAILED
Wed Jan 15 13:29:42 2014 daemon.debug olsrd_hotplug: [OK] already_active: 'lan' => 'eth0.1'
Wed Jan 15 13:29:42 2014 daemon.err 6relayd[16266]: Unable to open interface wan6 (No such device)
Wed Jan 15 13:29:42 2014 daemon.debug olsrd_hotplug: [OK] already_active: 'wan' => 'eth0.2'
Wed Jan 15 13:29:42 2014 daemon.info olsrd_hotplug: [OK] ifup: 'loopback' => 'lo'
Wed Jan 15 13:29:42 2014 daemon.debug olsrd_hotplug: [OK] interface 'loopback' => 'lo' not used for olsrd
Wed Jan 15 13:29:55 2014 kern.info kernel: [32917.040000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
Wed Jan 15 13:29:55 2014 kern.info kernel: [32919.290000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
Thu Jan 16 07:44:10 2014 authpriv.info dropbear[16426]: Child connection from 10.10.39.25:39313
Thu Jan 16 07:44:13 2014 authpriv.notice dropbear[16426]: Password auth succeeded for 'root' from 10.10.39.25:39313
# -> no coredump found, but coredump of crond found














# batman-adv
# general device config structure:
config device
  option type device-type  # e.g. "macvlan"
  option name virtual-ifname  # e.g. "macvlan0"
  list ifname lower-device  # e.g. "eth0"
  # one or more type specific options, e.g. "option macaddr" for macvlan
 
# example for batadv:
config device
  option type batadv
  option name bat0  # this is the virtual batiface that is to be created
  list ifname wlan0 # these are the devices bat0 should contain
  list ifname wlan1 # ...
  # zero or more options that apply to bat0
 
# example for batadv-vlan:
config device
  option type batadv-vlan
  option name bat0.1  # we want to make a vlan1 on top of bat0
  list ifname bat0 # this is the base device for bat0.1
  # zero or more options that apply to batman vlans




# bluetooth:
# http://h-wrt.com/en/doc/bluetooth
# https://forum.openwrt.org/viewtopic.php?id=22343
# https://forum.openwrt.org/viewtopic.php?id=29977
# http://www.ebay.de/itm/Ampire-BLU100-BLK-AMPIRE-Bluetooth-Aktivlautsprecher-mit-Akku-schwarz-/141131890603?pt=DE_Lautsprecher_Martin&hash=item20dc1dbfab


# ssh $IP wird sofort wieder beendet, das steht dann im log:
Sun Jan  5 10:11:52 2014 authpriv.info dropbear[30105]: Child connection from 192.168.2.1:52923
Sun Jan  5 10:11:59 2014 authpriv.notice dropbear[30105]: Password auth succeeded for 'root' from 192.168.2.1:52923
Sun Jan  5 10:12:00 2014 authpriv.err dropbear[30106]: ioctl(TIOCSCTTY): Input/output error
Sun Jan  5 10:12:00 2014 authpriv.err dropbear[30106]: /dev/pts/0: No such file or directory
Sun Jan  5 10:12:00 2014 authpriv.err dropbear[30106]: open /dev/tty failed - could not set controlling tty: No such device or address




# IRC: list users in channel: /names

# airport graphit:
# http://web.archive.org/web/20031207071236/http://www-hft.ee.tu-berlin.de/~strauman/airport/airport.html
# http://web.archive.org/web/20031211141153/http://www-hft.ee.tu-berlin.de/~strauman/airport/airport_etherboot.html

# mailinglist:
# https://lists.openwrt.org/pipermail/openwrt-devel/2013-October/021752.html
#
# loader.c -> reset when halt():
# ./target/linux/ar71xx/image/lzma-loader/src/ar71xx_regs.h
# #define AR71XX_APB_BASE         0x18000000
# #define AR71XX_RESET_BASE       (AR71XX_APB_BASE + 0x00060000)
#
 #define AR71XX_RESET_REG_RESET_MODULE           0x24
 #define AR913X_RESET_REG_RESET_MODULE           0x1c
 #define AR724X_RESET_REG_RESET_MODULE           0x1c
 #define AR933X_RESET_REG_RESET_MODULE           0x1c
 #define AR934X_RESET_REG_RESET_MODULE           0x1c
#
 #define AR71XX_RESET_FULL_CHIP          BIT(24)
 #define AR934X_RESET_FULL_CHIP          BIT(24)
# 
# target/linux/ar71xx/image/lzma-loader/src/loader.c
# arch/mips/include/asm/mach-ath79/ath79.h
# -> ath79_device_reset_set -> ath79_reset_wr(unsigned reg, u32 val) -> 
#  __raw_readl(ath79_reset_base + reg);
#  __raw_writel(val, ath79_reset_base + reg);


# flashbank:
#  1. brcm47xx = wrt54g + wap?
#  2. brcm63xx = speedW500V/Targa-WR-500-VoIP
#  3. ar71xx = tplink 1043nd + 841nd + Bullet 5M
#  4. atheros = ar231x = ar2315-fonera + 5312-nanostation5 + dlink-dir300
#  5. au1000 = meshcube/tmobilebox
#  6. ar7 = alte fritzbox?
#  7. mpc85xx = 4900er
#  8. x86 = Soekris NET
#  9. kirkwood = NAS/seagate
# 10. imx23/mx2 = chumbyOne
# 11. s3c24xx   = openmoko (removed @34767)
# 12. Marvell/Intel PXA2xx/ARM   = zipit
# 13. omap4 = pandaboard
# 14. brcm2708 = raspberryPi
# 15. Cobalt = SunCobalt-RaQ4i
# 16. rb532 = routerboard/boltenhagen
# 17. gemini = Wilibox WBD-111 (kaufen)
# 18. arm5l = WiFiSD-Card
# 19. sparc = SUN Enterprise 250 UltraSparc
# 20. imx21 = VP6500
# 21. ???   = horstbox

# empfang schlechter: txpower?: iw dev wlan0 set txpower fixed 2300
# vorher: r35300
root@hauptstrasse52-dach:~ n
Table: Links
Local IP	Remote IP	Hyst.	LQ	NLQ	Cost
10.10.36.1	10.10.2.1	0.00	0.701	0.364	3.905	
10.10.36.25	10.10.225.33	0.00	1.000	1.000	0.100		# OK
10.10.36.1	10.10.157.1	0.00	0.607	0.454	3.616	
10.10.36.1	10.10.12.1	0.00	0.592	0.753	2.242		# OK
10.10.36.1	10.10.17.1	0.00	0.306	0.000	INFINITE	
10.10.36.1	10.10.4.1	0.00	0.497	0.713	2.813	
10.10.36.1	10.10.22.1	0.00	0.000	0.000	INFINITE	
# nachher: r39139
root@hauptstrasse52-dach:~ n
Table: Links
Local IP        Remote IP       Hyst.   LQ      NLQ     Cost
10.10.36.1      10.10.2.1       0.00    0.701   0.000   INFINITE
10.10.36.25     10.10.225.33    0.00    1.000   1.000   0.100   	# OK
10.10.36.1      10.10.157.1     0.00    0.701   0.000   INFINITE
10.10.36.1      10.10.12.1      0.00    0.514   0.725   2.683   	# OK (wenig schlechter)
10.10.36.1      10.10.17.1      0.00    0.074   0.000   INFINITE
10.10.36.1      10.10.4.1       0.00    0.211   0.000   INFINITE
10.10.36.1      10.10.22.1      0.00    0.000   0.000   INFINITE
# spaeter nochmal / r39139:
root@hauptstrasse52-dach:~ n
Table: Links
Local IP        Remote IP       Hyst.   LQ      NLQ     Cost
10.10.36.1      10.10.2.1       0.00    0.804   0.259   4.806   	# etwas schlechter
10.10.36.25     10.10.225.33    0.00    1.000   1.000   0.100		# OK
                10.10.157.1
10.10.36.1      10.10.12.1      0.00    0.713   0.776   1.804		# OK
                10.10.17.1
10.10.36.1      10.10.4.1       0.00    0.031   0.717   INFINITE
                10.10.22.1
10.10.36.1      10.10.72.1      0.00    0.682   0.271   5.416   


# RAM/memory-fragmentation:
# echo m > /proc/sysrq-trigger
# http://stackoverflow.com/questions/4863707/how-to-see-linux-view-of-the-ram-in-order-to-determinate-the-fragmentation
#
# maybe set 'CONFIG_COMPACTION', so we can use 'echo 1 >/proc/sys/vm/compact_memory'

# memleak global vars?
# http://landley.net/notes-2006.html#24-10-2006

# be strict:
# https://sipb.mit.edu/doc/safe-shell/
# set -e

# styleguide?
# http://google-styleguide.googlecode.com/svn/trunk/shell.xml

# how does this work, maybe join?: http://oops.kernel.org/
# https://lkml.org/lkml/2013/8/22/208


# generische beschreibung eines routers / der komponenten. = mailingliste: mal raussuchen, gabs schonmal was
TP-LINK TL-WDR4900 {
{
	SoC: Atheros AR9342 rev 2
	arch:
	endianess:
	switch: AR8327v4
	ram: 128
	flash: 32
	cpu:
	radio0:
	radio1:
}


TODO-important:
# read quilt: http://wiki.openwrt.org/doc/devel/patches
# openwrt: git grep 'md5sum -'
# openwrt: git grep ' '$	// space + tabs
# openwrt: git grep 'case "\${#'
# openwrt: git grep 'case \$'
# openwrt: failsafe via crashlog
# openwrt: git grep ' () {'
# openwrt: git grep -e '((\$'	// wrong parenthesis
# openwrt: git grep ' -le "'	// do not calc wit ""
# openwrt: git grep '=""'	// enforce empty var is enough with: A=
# openwrt: refactor postinst()
# openwrt: cleanup 'package/base-files/files/bin/login.sh'
# openwrt: include/download.mk - cleanup: prepare_download()
# openwrt: git grep " -ot " ... git grep " -nt "
#
# 
# patches liefern:
# openwrt: git ls-files | while read FILE; do grep -HPzo 'return \$\?\n}' "$FILE";done
# openwrt: hotplug: do not export _C= + SHVLV= + CONFIG_APPEND= + LIST_SEP= + LOAD_STATE= + LOGNAME= + board= + script=
# openwrt: maintain atftp/atftpd / oldpackages
# openwrt: show crash when login
# openwrt: repair '/bin/board_detect'
# openwrt: AIX: 
           - /usr/bin/gmake
	   - md5sum http://www-01.ibm.com/support/docview.wss?uid=swg21496703
	   - seq -> /home/bastian/bin -> not POSIX:
	     - http://intercity-vpn.de/seq
             - http://stackoverflow.com/questions/25919339/seq-missing-operand-try-seq-help-for-more-information
	   - getopts_long:
             - http://stchaz.free.fr/getopts_long

#
# http://patchwork.openwrt.org/project/openwrt/list/?order=submitter
#
# git: patch for 'git fgrep' = 'git grep -F'
#
#
#

# showstopper before release:
  - RRD
  - VDS
  - 1043er - only powerled/freeze https://dev.openwrt.org/ticket/12121
  - 4300er / mixed VLAN		 https://dev.openwrt.org/ticket/12181
  - tcpdump-segfault:            https://dev.openwrt.org/ticket/17753#comment:6 -> compiler-thing
  - ppp-crash:                   https://dev.openwrt.org/ticket/18118 + https://dev.openwrt.org/ticket/7793#comment:44 + https://dev.openwrt.org/ticket/18799
  - switch 1043/10mbit all ports https://dev.openwrt.org/ticket/12491
  - logd/logread/ubus:		 https://dev.openwrt.org/ticket/18364
  - logd/klog                    https://dev.openwrt.org/ticket/18419
  - netifd-crash:                https://dev.openwrt.org/ticket/18204 - r44150 still affected
  - ath9k-fix: "hangs"           https://dev.openwrt.org/ticket/17364 - r43060/r43210 still affected
  - ath9k-fix: "gets slower"     https://dev.openwrt.org/ticket/17582 - r43102 still affected
  - ath9k-fix: TX DMA            https://dev.openwrt.org/ticket/11862 - r43102 still affected
  - atk9k-fix: WDS/packetloss	 https://dev.openwrt.org/ticket/17354 - r43209
  - atk9k-fix: reboots	 	 https://dev.openwrt.org/ticket/18497
  - ath9k-signal-strength        https://dev.openwrt.org/ticket/17565
  - hostapd-crash:               https://dev.openwrt.org/ticket/18126 - r44150 still affected
  - odhcp6c-crash: test: r43056+ https://dev.openwrt.org/ticket/18212 - r44011 still affected -test!
  - ag71xx-fix:                  https://dev.openwrt.org/ticket/6754
                                 https://dev.openwrt.org/ticket/14035
                                 https://dev.openwrt.org/ticket/11217
  		       	         https://dev.openwrt.org/ticket/19085 + https://dev.openwrt.org/ticket/19579
				 https://dev.openwrt.org/ticket/10269
  - ar8216-fix:			 https://dev.openwrt.org/ticket/17800 - still issues with 3.14
  - atheros-watchdog:		 ???				      - r43781 still affected (dhfl) -> ath5k -> no 'wifi up'
  - pppoe/autoreconnect fails:   https://dev.openwrt.org/ticket/18026
  - archerC7 v2:		 https://dev.openwrt.org/ticket/16589#comment:86
  - x86Wrap/geode-Fix		 https://dev.openwrt.org/ticket/13004
  - vtun-patch-machen		 https://dev.openwrt.org/ticket/18872
  - btrfs:			http://www.mail-archive.com/linux-btrfs@vger.kernel.org/msg42422.html

#
#
# change domain to 'wlan'?
# das WLAN 10.10.0.0/16 darf auf 172.17.0.28
445
137
139
35255
4343
8059

exchange = 0.23 port 999

dns/ntp eigentlich 172.17.0.21/22 aber besser gleich die 0.1 fragen
test: ejbw-ex01.ejbweimar.lan -> 172.17.0.23
test: mail.ejbweimar.de
test: email.ejbweimar.de
mac-schutz ejbw ausschalten
pbx: main kann ping auf ersatz: fe80::225:90ff:fe38:2eb6:eth0 + 172.20.20.2
     ersatz braucht manuell default route?
     - ip route add default via 172.17.0.1
     - echo "nameserver 172.17.0.22" >/etc/resolv.conf

# fix olsrd2-build: v.0.6.0
# vtund: link up/down
  - make sure IF is not blocked by olsrd: before 'up', clean old ifs or even kill olsrd
  - check in intervals, if all tap's have an ipv6 - if not - kill olsrd
  - script can hang:
  root@server1:~# lsof | grep tun|grep -v vtun
  tincd      2852          root    4u      CHR             10,200      0t0 1269554737 /dev/net/tun
  sh        24056          root    4u      CHR             10,200      0t0 1269554737 /dev/net/tun
  olsrd     24059          root    4u      CHR             10,200      0t0 1269554737 /dev/net/tun
  - ps:
  24056 ?        S      0:00 sh -c . /tmp/loader; _vpn; _vpn_innercity_master_iface up   tap81
  #
dev_ok()
{
  cut -d':' -f1 /proc/net/dev | while read DEV; do
    case "$DEV" in 'tap'*|' tap'*)
      ip address show dev $DEV | grep -q 'inet6 ' || return 1
    esac
  done
}

dev_ok || olsr_restart


busbox-fix:
root@box:~ arping -D -c 1 -I "lo" -f "1.1.1.1"
arping: interface eth0 is not ARPable
root@box:~ echo $?
0

root@box:~ arping    -c 1 -I "lo" -f "1.1.1.1"
arping: interface eth0 is not ARPable
root@box:~ echo $?
2


busybox-fix:
root@box:~ arping -D -c 1 -I 3 -f 10.10.2.33
arping: interface eth0 not found: No such device


busybox-idea:
udhcpc -> support for destination broadcast for sending to specific neigh
       -> maybe rewrite with iptables?


root@boltenhagendh-ap--46:~ ls -l /
drwxr-xr-x    2 root     root           709 Jan 26 16:53 bin
drwxr-xr-x    3 root     root             0 Jan 28 02:50 database
drwxr-xr-x    6 root     root           860 Jun 30 08:25 dev
drwxr-xr-x    1 root     root             0 Jun 30 06:27 etc
drwxr-xr-x   11 root     root           757 Jan 26 16:50 lib
drwxr-xr-x    2 root     root             3 Jan 26 16:50 mnt
drwxr-xr-x    9 root     root             0 Jun 30 08:28 overlay
dr-xr-xr-x   46 root     root             0 Jan  1  1970 proc
drwxr-xr-x   16 root     root           223 Jan 26 16:54 rom
drwxr-xr-x    1 root     root             0 Jun  9 08:04 root
drwxr-xr-x    1 root     root             0 Jan 28 02:31 sbin
dr-xr-xr-x   11 root     root             0 Jan  1  1970 sys
drwxrwxrwt   20 root     root          1480 Jun 30 08:29 tmp
-rw-r--r--    1 root     root             0 Jun 25 01:20 tmp[0].fixedarp
drwxr-xr-x    1 root     root             0 Jan 26 16:49 usr
lrwxrwxrwx    1 root     root             4 Jan 26 16:53 var -> /tmp
drwxrwxr-x    1 root     root             0 Jun 30 08:24 www
-rw-r--r--    1 root     root             0 Jun 24 04:33 #;7���m*mm�,|���?����f?]?;?�&�s??�Y?��AYy0.x?�.�?�H?:�X? סr��|~?e:~ 
root@boltenhagendh-ap--46:~ 


leonardo: am WAN:
11:26:37.985680 IP (tos 0x0, ttl 255, id 29953, offset 0, flags [none], proto UDP (17), length 328)
    10.5.64.1.67 > 255.255.255.255.68: [udp sum ok] BOOTP/DHCP, Reply, length 300, xid 0x574081a2, Flags [Broadcast] (0x8000)
      Your-IP 10.64.112.246
      Gateway-IP 10.128.128.1
      Client-Ethernet-Address 8c:73:6e:b2:4c:ce
      Vendor-rfc1048 Extensions
        Magic Cookie 0x63825363
        DHCP-Message Option 53, length 1: ACK
        Server-ID Option 54, length 4: 172.20.3.10
        Lease-Time Option 51, length 4: 604800
        Subnet-Mask Option 1, length 4: 255.255.240.0
        Default-Gateway Option 3, length 4: 10.64.112.1
        Domain-Name-Server Option 6, length 12: 217.68.161.141,217.68.161.171,8.8.8.8
        Router-Discovery Option 31, length 1: Y
    0x0000:  4500 0148 7501 0000 ff11 fb9d 0a05 4001  E..Hu.........@.
    0x0010:  ffff ffff 0043 0044 0134 3994 0201 0600  .....C.D.49.....
    0x0020:  5740 81a2 0000 8000 0000 0000 0a40 70f6  W@...........@p.
    0x0030:  0000 0000 0a80 8001 8c73 6eb2 4cce 0000  .........sn.L...
    0x0040:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x0060:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x0070:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x0080:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x0090:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x00a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x00b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x00c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x00d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x00e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x00f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
    0x0100:  0000 0000 0000 0000 6382 5363 3501 0536  ........c.Sc5..6
    0x0110:  04ac 1403 0a33 0400 093a 8001 04ff fff0  .....3...:......
    0x0120:  0003 040a 4070 0106 0cd9 44a1 8dd9 44a1  ....@p....D...D.
    0x0130:  ab08 0808 081f 0101 ff00 0000 0000 0000  ................
    0x0140:  0000 0000 0000 0000                      ........
Tue Jun 30 11:26:56 2015 kern.warn kernel: [71299.620000] IN=eth0.2 OUT= MAC=ff:ff:ff:ff:ff:ff:88:43:e1:38:75:d9:08:00:45:00:01:48 SRC=10.5.64.1 DST=255.255.255.255 LEN=328 TOS=0x00 PREC=0x00 TTL=255 ID=30002 PROTO=UDP SPT=67 DPT=68 LEN=308 


strange musl things:
Thu Jul  2 13:31:01 2015 daemon.info kalua: /etc/dhcp-script.d/10dhc: '00:00:00:00:00:00' is from 'lo' = loopback-DEV HOST: lo-alias
arping -> MAC = UPPERCASE

===============================================
# stockmann aufruestung+portfw, fitnessCam, rene/werbemat, text/pension/lpz, adagio steckdose 
# demokratie: dns muss: 192.168.2.1 - check auf .2.14 und .2.15
===============================================

=== kkk ===
##### SHOWSTOPPER for release:
 - ethernet/bullets: http://p.tet.rtu.lv/pbzn5sspm/wvtsep/raw => https://dev.openwrt.org/ticket/19085#comment:37
 - include mtd-show-writes-patch
 - tcp-cubic-fix: https://github.com/torvalds/linux/commit/30927520dbae297182990bb21d08762bcc35ce1d
 - tc-fix: https://bugzilla.kernel.org/show_bug.cgi?id=84661
    - https://www.mail-archive.com/search?l=netdev%40vger.kernel.org&q=subject:%22%5C%5BRFC+PATCH%5C%5D+tc+filter+not+show+last+u32+filter%22&o=newest&f=1

#### fakemon ibfleesensee

# olsr-procd: https://github.com/openwrt-routing/packages/pull/78
##### before next PMU
#### xoai: do not reboot + update
#### marinabh: update
#
# include netjson.org into splash? and error-page? statuspage
# PERMDIR ganz am anfang schreiben
# PERMLOG -var in class log ="$PERMDIR/everlasting_syslog.txt"
# loader: method 'unload' -> unset -f $funcname
# loader: method 'help'
# loader: show stats for each call: sed -n "s/^\(.*\) ().*/\1/p" $BASEDIR/$CLASS | wc -l | sed 's/ //g'

# vpn/evernet: first olsr run: ln: failed to create symbolic link ‘/var/etc/olsrd.conf’: File exists
#### option name_change_script '/tmp/bla.sh' -> nameservice -> watchdog
#### pidof crond -> pidof cron fuer vpn-server!
######### convert texts for weblogin_htmlout_rules() on server and update all mydesign.ipk
#### gian: 2nd section for 2.4ghz wifi + apply profile
#### --pool $download
# TMPDIR: alle vorkommen von /tmp durch $TMPDIR ersetzen
#### monitoring: show scheduler_queue length
#### monitoring: fix ffweimar-dnt (only symlink) if we had an update
#### eventlistener: check cron
#### rehungen: nachts auf 1mbit?
#### roaming: net dhcp-lease / was alien node -> how to call event?
#### roaming: iw: err1?
#### do not hardcode 4.v.weimarnetz.de
#### introduce simple-roam (always NAT)
#### bandbus internet: antenne bestellen + USB-stick 
#### zram-patch: https://dev.openwrt.org/ticket/19586 - http://stackoverflow.com/questions/4586405/get-number-of-cpus-in-linux-using-c
#### besser mit ausfall monitoring-server klarkommen!
#### call '/etc/dhcp-script.d/10dhcpscript' mit DNSMASQ_INTERFACE=xy $scriptname
######## cron.wireless: make it non-blocking + aware of interface restarts (route setting!)
         -  nat/roaming-clients kann verloren gehen: (ifup lan?) -> reapply
#### CLASS roaming() + introduce roaming_server() -> reducing load on authserver
#### slow wifi: 'expected throughput:	6.416Mbps' -> wifi -> 'expected throughput:	30.166Mbps'
#### _file age "$file" -gt 18000 -> RC = 0 if file does not exist -> db_lock
# openwrt: send patches for removing 'ifconfig' + route + arp'
#### traffic-sperre beachten bei malchow
#### portfw rehungen: 2 x NetIO
#### force-arp_perm -> NetIO?
#### use 'adjust_conntrack()' again
#### patch netifd to launch each 60 sec a hotplug-event for cron
#### hideandseek-NAT does not work! ute!
#### cgi-bin-sql: repair for relaying / ejbw
#### where does it come from?: db_lock() task 'db_user() login add 6    2  1' must wait 1 sec for 'db_user() login index_gen|Sat Aug  8 05:28:06 CEST 2015'
#### splash: do not intercept HTTPS?
#### remove 'exit' in dnsmasq-hotplug + provide helper 'is_enabled dnsmasq' which runs nonforking
#### generic rmdir() -alias?
#### kick bad clients (bad avg signal, no ping)
#### zombiecheck into udhdpc-script
#### daemon.err uhttpd[3736]: sed: unsupported command I
#### daemon.err uhttpd[3736]: cat: write error: Broken pipe
     logger "[$$] REMOTE_ADDR: $REMOTE_ADDR"
#### db_restore() gibt bei OK auch 1 zurueck?
#### make maint_mode() fuer 3-4:30 o'clock and avoid a lot of tests:
Oct 21 04:08:42 ' [up 86253s 3710976 bytes free] /usr/sbin/cron.monitoring [daemon.alert] watch_dns_resolution() after DNS fail: sending SIGHUP to dnsmasq: 3485 (reread config)
Oct 21 04:10:03 ' [up 86334s 4771840 bytes free] /usr/sbin/cron.monitoring [daemon.alert] wifi_phy_restart() doing newstyle wifi-up, because 'force: mode: 'inet_broken' wifi_change_essid_ap'
Oct 21 04:10:26 ' [up 86357s 3899392 bytes free] /usr/sbin/cron.monitoring [daemon.alert] net_inet_seems_stable() unstable inet fixed after: 39sec
Oct 21 04:10:28 ' [up 86359s 4194304 bytes free] /usr/sbin/cron.monitoring [daemon.alert] wifi_phy_restart() doing newstyle wifi-up, because 'force: mode: 'original' wifi_change_essid_ap'
Oct 21 04:10:34 ' [up 86365s 3186688 bytes free] /usr/sbin/cron.monitoring [daemon.alert] watch_dns_resolution() after DNS fail: sending SIGHUP to dnsmasq: 9089 (reread config)
Oct 21 04:11:03 ' [up 86394s 3915776 bytes free] /usr/sbin/cron.monitoring [daemon.alert] watch_dns_resolution() after DNS fail: sending SIGHUP to dnsmasq: 11871 (reread config)
Oct 21 04:11:34 ' [up 86425s 3923968 bytes free] /usr/sbin/cron.monitoring [daemon.alert] watch_dns_resolution() after DNS fail: sending SIGHUP to dnsmasq: 12395 (reread config)
Oct 21 04:12:05 ' [up 86456s 3895296 bytes free] /usr/sbin/cron.monitoring [daemon.alert] watch_dns_resolution() after DNS fail: sending SIGHUP to dnsmasq: 12871 (reread config)
Wed Oct 21 04:12:47 CEST 2015 [OK] reboot reason: 'nightly_reboot'


+# tell DHCP clients to not ask for proxy information
+# some clients - like Win7 - will constantly ask if not told "No!"
+# configuration found in /etc/dnsmasq
+#
+dhcp-option=252,"\n"

# work around missing rc.common on vps-server
# fix reporting of USB-stick size: only count mounted or say -1
# use https://github.com/danvk/dygraphs/ for monitoring? rrd?
# use ndpi?: 
  - https://dev.openwrt.org/ticket/12598#comment:11
  - https://github.com/heil/owrt-package/tree/master/net/iptables-mod-ndpi
  *** https://github.com/betolj/ndpi-netfilter
  - https://github.com/vel21ripn/nDPI
# when called _weblogin ticket_mail_text() from mailsend, we have '0 bytes free' in log
# FUNC -> funcname
# simulate devstatus() ifstatus() etc. when missing?
# build: check some generated HTML-files
# build: check() count shell and non-shell files in log
# check: openwrt: DansGuardian - 400 Bad Request
# olsr: own section for 2/5ghz, so we can lqmul a whole band
# avoid calling e.g. _db or '/www/cgi-bin-sql.sh' if missing (weimarnetz)
# pbx: ejbw: root: cd /home/ejbw/backups ; ls -1 | while read FILE; do case "$FILE" in *'01_'*|*'31_'|*'15_'*);;*) rm "$FILE";;esac; done
# use printf instead of echo with args: https://github.com/koalaman/shellcheck/issues/461
# roaming: 100.64.0.0/10 = rfc6598
# add private net / SSID
# live patch: http://www.drinksmixer.com/drink9026.html
# check: https://github.com/freifunk-leipzig/solarfestival-packages/blob/master/rpcd-mod-alfred/rpcd/usr/libexec/rpcd/alfred
#### woher kommen die? boltenhagendh schon 6 min after boot: rm -fR /tmpon /tmptori /tmpcpuload_is_low
# netjson vom 1nen OLSR-knoten
# flapping-nexthop: 1 is very bad: auto mqmult-adust? (e.g. giancarlo-4)
# check: http://adaway.org/hosts.txt + http://hosts-file.net/ad_servers.txt
# check: basher bpkg
# rrd: enforce every minute -> cron (via uci var)
# buero: kurt: absendernummer
# automatically announce wan-ip via HNA4? limona!
# http://ffka.xylou.info/#/dashboard/file/ffka.json !
# tunneldigger! 
# https://github.com/wlanslovenija/nodewatcher-agent
# SQM/shaper:
  - https://github.com/openwrt/packages/blob/master/net/sqm-scripts/files/usr/lib/sqm/functions.sh
  - http://www.linuxquestions.org/questions/linux-networking-3/limit-bandwidth-rate-for-scp-using-tc-htb-linux-825684/
  - cake? http://www.bufferbloat.net/projects/codel/wiki/Cake

# ganz oft?
Wed Jul 29 16:59:09 2015 daemon.info kalua: /usr/sbin/cron.wireless_: [OK] mac->IP: 84:55:a5:4e:09:03 -> 192.168.235.119 from 'http://10.10.111.129/cgi-bin-collect.sh?action=roaming_querymac&mac=84:55:a5:4e:09:03'
  -> ignore later events in queue?

# conntrack aus?
# fix: Please re-run make with -j1 V=s to
# try to plot: https://github.com/thuehn/RegMon/issues/4#issuecomment-129130155
# netJSON -> schema -> UI -> http://jeremydorn.com/json-editor/
# read about the pipe problem: http://superuser.com/questions/554855/how-can-i-fix-a-broken-pipe-error
# beliebige infos in blockchain verteilen? http://blocktech.com/
# think about setting 'func_${FUNCNAME}_result=...'
# mark CF7-packets on the download/incoming side (for e.g. wireless)
# patch openwrt: sysupgrade: complain if file is missing with better message
# klog: icmp6_send: no reply to icmp error -> needs reboot -> https://dev.openwrt.org/ticket/14173 ???
# schoeneck: 5-tages-tickets gehen nicht?
# db: autogenerate? -> easy list which pages are generated for later resend
# patch-openwrt:4900:dts: ethernet-mac muss 1 *weniger* sein (:ED ist es gerade, aber :EC steht auf dem sticker)
# giancarlo: hna4 - 192.168.178.0/24
# http://www.olsr.org/mediawiki/index.php/OLSR_network_deployments#IPv4_or_IPv6_only_mesh_network_with_olsrd2
# measure speed: disable shaping or allow specifc rule to override?
# build: parse_case_patterns() allow revert12345
# longshot: support for: iw dev wlan0 set bitrates ht-mcs-5 7
# rrd: show retry + failed in %?
# ejbw: roaming!
# passwort falsch? code einblenden!
# https://dev.openwrt.org/ticket/20163 -> net.ipv4.conf.{default,all}.rp_filter=2 ???
# local_inet_offer: mark with file for early execution and remove file after late call?
# kurzstatistik beim einloggen: user seit X, traffic etc.
# write lo-watchdog via hotplug call after first ifup?
# monitoring: show timestamp of latest message
# dhcp-script: call a function, so we can better schedule it
# scheduler: remove doubles / detect if >xxx jobs
# /etc/dhcp-script.d/10dhcpscript stopwatch_stop(): timefile '/tmp/STOPWATCH_tmpCRON_LASTCALL'... not found - abort
# dhcp-old via scheduler? 
# job: distributed scan for specific SSID (lost nodes)
# cron.minutely: check kalua-files? or 1 kalua_function? || reboot
# cgi-bin-sql: overload -> send OK + exit?
# longhot: "Coverage class: 1 (up to 450m)" -> multiply by 450, e.g. 2 = 900m ... up to 255 - see handle_distance() in nl80211.h
# cron.pingchecker: fix packets/failed%
# longshot: missing_neigh/framecounter: frag=256/rts=on,distance=10000,txpwrMAX,mcast off,beacon=100
# loginseite kommt nach login wieder! overload bei authserver?
# user has more than X traffic? -> DSCP ultra low
# ejbw: J4-RF: HNA40/0
# monitoring: add meta/autorefresh for next exspected round
# stopwatch should understand: cat /proc/uptime >$file
# many of '/tmp/STOPWATCH_download_10.63.17.1_14170' ?
# giancarlo: vlan 'lan2' 192.168.2.200/24 auf master + postrouting in/out in das netz
# nanostation xw -> HARDWARE wagenplatz anpassen
# tarball fuer jedes netz einzeln -> besseres testen -> _links firmware_url_get tarball + hash
# leonardo: uci delete dhcp.@dnsmasq[0].notinterface
  # wan2: allow DHCP? INPUT -p udp --dport 67:68 --sport 67:68 -j
# kick bad wifi-clients (once) -> low estimated throughput?
# too much reboots/crashdumps -> disable wifi + vorsichtig machen...
# schoeneck: 4tage-tickets kommen, aber 2 tage sind alle?
# ejbw43 = weblogin off
# rotate: /www/PINGCHECK
# fix _wifi_forwarding_still_active (do not count tap or ppp)
# [ 3908.050000] IPv6: ADDRCONF(NETDEV_UP): roaming0: link is not ready
# 4150% Inselbetrieb
# crash -> /tmp/FREE ???
# dnsmasq: sequential_ip=1?
# do not complain about unstableLAN/WAN if remote is now a slave


# giancarlo: ssid: 'Elephant Guest Room'
# think about PID in wireless_events and wget:
  - http://stackoverflow.com/questions/1652680/how-to-get-the-pid-of-a-process-that-is-piped-to-another-process-in-bash
# rrd: vpnserver: traffic + tap's? (2nd graph)
# rrd: server: temp + fanspeed?
# rrd: no signal (no wifi) -> plot pingtime on inet_offer?
# rrd: olsr: get best 10 neighs? -> wait till uptime_is_short() and make a static list of the 10 best.
# rrd: plot load (on upload-line ist space enough)
# rrd: gfx = fullhd-resolution?
# vpn-server: summarize interface-counters (do not delete during ifup/ifdown)
# sanitizer: lowercase/uppercase: use 'tr'? tr "[a-z]" "[A-Z]"
# use iptables -j MARK for classifing packets for qdisc
  - http://lartc.org/howto/lartc.qdisc.filters.html
  - MARK = 6 = arbitrary
  - iptables -A PREROUTING -t mangle -i eth0 -j MARK --set-mark 6
  - tc filter add dev eth1 protocol ip parent 1:0 prio 1 handle 6 fw flowid 1:1
    - icmp 64 bytes = 1
    - icmp 65       = 2
    - icmp >65      = 3

# build: send: rXXXXX + usecase + hardware when good
# check all 'sed -i $onflash' if this is needed
# read: https://wiki.debian.org/ferm + http://ferm.foo-projects.org/download/2.2/ferm.html#remote_ferm
# rrd: use STACK:over#FF0000:"Over speed" + HRULE:656#000000:"Maximum Available Memory - 656 MB"
  - http://netkiller.github.io/developer/graphics/rrdtool.example.html
# store wan-speed onmonitoring server when it changes?
# build: beliebige rezepte sourcen
# warning when: _classfile notexistent_function -> only when build with debug
# monitoring / kalua: define global path for tmpfs to TMPDIR?
# vpn: hideandseek: 10.63.0.0/16 only in community-mode?
# cron.evaluate -> _vds() class
# tarball: https://wiki.debian.org/ReproducibleBuilds/About -> gzip -n
# Airdroid: warum geht kein Zugriff von 192.168.2.x auf 192.168.222.x?
# _system_reboots() too_much? -> do not check ubus -> disable wifi!
# check iptables: string-match
# lan missing? -> eth0 + loopback missing? -> enforce
# install MTR in debug-mode? tcpdump? horst?
# dnsmasq: unterschied: no-dhcp-interface=eth0 + except-interface=wlan0-1

# check: https://github.com/FreifunkAdvanced/ff-advanced-feed/blob/master/ffadv-hbbp/Makefile
  # https://wiki.freifunk-rheinland.net/Firmware/Dokumentation#P2P_table_format
  # https://github.com/FreifunkAdvanced/p2ptbl
  # https://github.com/L337hium/gitmirror/blob/master/git
  # https://github.com/battlemesh/wibed/blob/master/feeds.conf
  # https://wiki.c3d2.de/Echt_Dezentrales_Netz/Geekend
  # https://pad.freifunk.net/p/ffweimar_2015_06_09

# build: support WIKI="http://..." -> for webui/js-tricks
# think about "dropbearkey" + "iwconfig" which are not always there

# monitoring-interface im client zu sehen mit dem man nicht assoziert ist:
# 19:30:39.158959 8061571978us tsft 1.0 Mb/s 2437 MHz 11b -63dB signal antenna 1 BSSID:ff:ff:ff:ff:ff:ff DA:ff:ff:ff:ff:ff:ff SA:xx:xx:xx:xx:xx:xx Probe Request (myssid) [1.0 2.0 5.5 11.0 Mbit]

# olsr: mac/ip-tupel via latlon?
  # uci set olsrd.@LoadPlugin[1].latlon_infile='/tmp/latlon.txt'
  # uci set olsrd.@LoadPlugin[1].latlon_file=/var/run/latlon.js
  # echo '12345,6789' >/tmp/latlon.txt
  # echo '8976,4321'  >/tmp/latlon.txt
  # echo '50.979546,11.324382' >/tmp/latlon.txt
    # grep 12345 /var/run/latlon.js
    # Node('10.63.2.33',12345.000000,6789.000000,0,'10.63.42.125','EG-labor-AP');
  # echo "12.3456789,17.890123456" >/tmp/latlon.txt
       -> 12.345679 ,17.890123 kommt an
  # echo "123456789.3456789,17123456789.890123456" >/tmp/latlon.txt
  #    -> 123456792.000000,17123457024.000001
    - evtl. nur hash uebertragen und jeder muss sich drum kuemmern das er den aktuellen hash von nodeX hat
      JAAA!


# patchfile for our /etc/profile - or wait for profile.d?

# use knowledge of TOPO for delivering/flooding macs/ip-tupels

# FIX! /sbin/hotplug-call [daemon.alert] ifup.wan6() local inet offer, add missing OLSRd HNA 0/0

# bootup: weblogin_authserver -> kann leer sein und trotzdem $? = 0 -> use cache?

# dual-radio:
  /www/cgi-bin-tool.sh tool_download(): 
  REMOTE_ADDR: 10.10.2.3 - cannot stat '/sys/kernel/debug/ieee80211/phy0/netdev:wlan1/stations/14:cc:20:2b:8c:d2/rc_stats'
  -> is in real:                        /sys/kernel/debug/ieee80211/phy0/netdev:wlan0/stations/14:cc:20:2b:8c:d1/rc_stats
                                                                      ^^^                                     ^^^

### fix all functions with 'func=...' or FUNC=... or FUNCNAME=...
  # git grep "\$func "

# build:
  suqashfs: -alway-use-fragments -sort
# build: squash1024 should be in filename/usecase(?)

# review: https://github.com/openwrt-routing/packages/pull/78

# build: meta: LuCIfreifunk

# wireless_events: show if mac2ip comes from arp|local_dhcp|local_roaming|server
# wireless_events: worker to '_net roaming_worker'...

# build: mybuild.sh build_kalua_update_tarball
# build: mybuild.sh config_diff

# roaming: ibfleesensee: uebergang kabel -> wifi? durchdenken

### always report mac/ip to master, if we could detect it later (howto get lease lifetime?)

# roaming: while changing interface, the connection breaks (e.g. labor UFO -> LAN/WAN flapping)

# sendmail if longshot very high retry-rate (>25%)

### roaming: check if unsplashed

# openwrt: Mercury1200 does not need USB-support

# apply_profile: remove some 'case "${NODE}_${INSTALLATION}" in'

# cron.monitoring: opkg-lock?

# configure_keep_files: do not include db-backup, fetch from server?

# openwrt: sysupgrade: do not complain about missing 'opkg'

# variable fuer: hinweis anzeigen / nur auf knopfdruck aktualisieren -> mit timeout (100 Tage? wenns keiner anschaut)
  - fuer neue firmware ja/nein -> default = ja

    - 0 = nein
    - stable   | stabil
    - beta     | beta
    - testing  | avantgarde
	- evtl. auch neue beta im stable modus anzeigen? -> beim flashen bleibt alter modus ("stable") erhalten


# build: untracked files -> 'git clean' -> KALUA_HISTORY KALUA_REPO_URL kalua/
  - https://git-scm.com/book/en/v2/Git-Basics-Recording-Changes-to-the-Repository -> .gitignore
# build: support for own download-repo
# build: support for CONFIG_PACKAGE_netdiscover=m

# db: helper: send all tickets

# /www/NETFILTER_AUTOADD -> autoremove if older than X days?
  - important for non-dhcp clients!
  - only use boottime = 4-5 o'clock?

# build: show each commit in "openwrt_patches"
# build: show busybox-tweaks and all applied symbols -> fix 'openwrt_build'-details
# build: add 'IO usage mtd' patch

# wgetdo: sometimes is ready, but is not! (must block till end)

# check.klog: detect specials, like: "irq 40: nobody cared"

# build: store .config for '$usecase' + '$rev' - so rebuilding is much faster

# leonardo: several reboot without reason: -> disable wifi for safing power and autoenable after X mins
  - add wan2: iface = @wan mit 192.168.6.1/24 + wan2-dhcp (radio)
  - allow DHCP from wan2-interface (dnsmasq + firewall)

# watch_storage: also work with 'sdbX'

# EJBW:
  pbx: ip route add 192.168.0.0/24 via 172.17.0.1
       - ping auf reithaus/voip: 192.168.0.245 oder 0.110 klappt dann
       ip route add 10.10.100.0/26 via 172.17.0.1
       ip route add 10.10.101.0/26 via 172.17.0.1
       - ping auf router klappt dann auch
  J2dach = 192.168.112.2: - route zur pbx?


# build rss-feed for firmware update

# wireless_event: move to class: wifievents()

# applyprofile: always store: contact/geo/ssid?

# build: spy: send all calls? send all failures? sucess? times?

# build: minify: optional use 'bash_obfus.pl' and remove comments etc.

# fix '..;do' -> '..; do' and let detect it via 'check' or 'unittest'

# netifd: proto fuer vtund

# $IPT: store MASQ-rules with timestamp/reason/origin-function
        always make 'firewall restart' work (hotplug-reapply)

# track_ap: show IP-changes

# https://developers.google.com/speed/pagespeed/insights/?url=http%3A%2F%2Fbwireless.mooo.com%2Fcgi-bin-welcome.sh

# fakedns: FIXME! 192.168.1.1? 192.168.0.1? LANADR? WIFIADR? nobody? see 18257dfa0c7d79126be6e67147673f9a1af119a6 

# keine roaming in NETFILTER_AUTOADD

# build: store 'last_build_hardware' somewhere 8-)

# build: explizit use of step 'prepare'?

# openwrt: make $PWD -> $CURDIR

### roaming: get IP from nameservice-plugin (via DNS?) but really try to reach, otherwise fallback to normal arp-listener
  - http://olsr.org/git/?p=olsrd.git;a=blob;f=lib/nameservice/README_NAMESERVICE

# wie kann man es machen das tickets bei ablauf (roomtype) oder nutzer voll verschickt werden (fackel)

# tickets: mehrere Seiten PDF's generieren, wenn >32 stueck ("print alle")

# knopf: 'alle tickets auswaehlen'

# userdbGUI: wenn 15 tickets angelegt werden, dann auch immer nur 15 verschicken?

# userdbGUI: Wochen

# 4300 minuten = 3 tage : USERDB-GUI

# NPTv6 - RFC2296 -> 7 + 1 + 48 + 16 + 64 bit 

### helper: testmail + testbackup + testsms

### why is mydesign/sshkey.postinst not removed? -> maybe only keep it in ramdisc?
  - try: opkd -d ram
  - https://dev.openwrt.org/ticket/19699

# IC: same method like on Medion for auth-keys

# UML: add tap-config like intercity-tap:
[    0.070000] Netdevice 8 (3a:77:51:f4:8d:01) : 
[    0.070000] TUN/TAP backend - IP = 192.168.0.254


# firstboot: show hint on prompt

# 'pidof scp' is not enough, pidof dbclient?

# speed: "ignore" slow olsr-neighs via lqmult and remove this entry if ok again

# build: freifunk8mb, freifunk4mb

# remove /etc/config/profile_kiberpipa if last word != $PROFILE or  $PROFILE - ff (e.g. ffweimar -> weimar)

# set force_link=0 on e.g. WAN, where changing link state should trigger something (proto!=static)

# auto-hideandseek, when community-button in weblogin

# S140/kaffee: port 25 darf nicht raus? wie am besten machen...?
  - /etc/firewall.user

# build: support for 'BarrierBreaker14.07'

# shaping affects other users on the same device

# firmware_keep_files: explizit remove, when not adding - otherwise it's maybe in safed list

# helper: test login/scp mail/backup_db

# FIXME! wget is ready, but file not fully written  (cron.check_inet / USERDB)

# loader: "$@" = "$1" "$2" "$3" ...

# build: noUSB (+autoapply for devices which have no USB)

# before reboot, sendout magic packet (on all/all wired? interfaces) via hotplug shutdown
  - when iptables-filter has seen this, do not complain about switch change

# aptrack: show band/mhz/channel

# roaming: arp-master:
  - renew dhcp -> IP change -> remove route
  - show band/mhz/channel
  - bei 'new' oder dhcp_renew() -> announce
  - alle koennen fragen:
    - ip_of_macX
    - last_seen where?
  - oder nameservice? mac/ip?
  - leasetime hoch, dann stimmt zuordnung besser...
  - netfilter wenn nicht freigeschaltet
  - during bootup we have wrong events: (del on AP -> wlan1 = adhoc = up)
    # Wed May 13 14:52:18 CEST 2015 start listening on ' wlan0-1  wlan1-1 '
    # Wed May 13 14:53:34 CEST 2015 EVENT: 'wlan1-1: del station 64:70:02:d3:24:0c'




### reachable muss schneller sein (faststart...slower)
### NETFILTER_AUTOADD leeren? (ibfleesensee)

# monitoring-server: write mail to all - and use kalua_mail for that?

# monitoring: show last active client lan/wifi per radio?

# FAT-fs (sda1): Volume was not properly unmounted. Some data may be corrupt. Please run fsck.

### fix version x...y for monami/old routers

# schoeneck: bad olsr values on wire/233?

# liszt28/21.97: wenn userdb geholt wird: daemon.err uhttpd[3323]: cat: write error: Broken pip -> redirect 302

# ibfleesensee: short dhcp-leasetime (30min)
  - automatisches anpassen, wenn >X% vom range verbraucht wurden?
# ibfleesensee: pidof 10dhcpscript -> ganz viele -> netfilter_user_reachable() laeuft lange -> hohe load?!

# pingcheck/cron: dynmaisch durch hotplug aktivieren

# autocreate tickets: do not fall back to gmx, if scp host is not in known hosts

# iface_ifupdate(): cron hangs, restarting - when zombies are there - crashreboot: ps  | grep '0 Z' | wc -l > 1?
root@EX-springer-MESH:~ ps
+ ps
  PID USER       VSZ STAT COMMAND
    1 root      1396 S    /sbin/procd
    2 root         0 SW   [kthreadd]
    3 root         0 SW   [ksoftirqd/0]
    5 root         0 SW<  [kworker/0:0H]
    7 root         0 SW<  [khelper]
   58 root         0 SW<  [writeback]
   61 root         0 SW<  [bioset]
   63 root         0 SW<  [kblockd]
   95 root         0 SW   [kswapd0]
  142 root         0 SW   [fsnotify_mark]
  159 root         0 SW   [spi0]
  254 root         0 SW<  [deferwq]
  276 root         0 SW   [khubd]
  346 root         0 SWN  [jffs2_gcd_mtd3]
  422 root       888 S    /sbin/ubusd
  423 root       772 S    /sbin/askfirst /bin/ash --login
 1460 root         0 SW<  [ipv6_addrconf]
 1549 root         0 SW<  [cfg80211]
 1657 root      1040 S    /sbin/logd -S 16
 1698 root      1552 S    /sbin/netifd
 1722 root      1160 S    /usr/sbin/odhcpd
 2016 root      1364 S    udhcpc -p /var/run/udhcpc-lo.pid -s /lib/netifd/dhcp.script -f -t 0 -i lo -C
 2340 nobody     916 S    /sbin/fakedns --address=/#/10.10.52.33 -p 5353
 2644 root      1152 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p 22 -K 300
 2696 root      1732 S    /usr/sbin/uhttpd -f -h /www -r EX-springer-MESH -c /etc/httpd.conf -x /cgi-bin -t 60 -T 30 -A 1 -E /cgi-bin-404.sh -n 3 -p 80 -i .sh=/bin/ash -I cgi-bin-404.sh -C /etc/uhttpd.c
 2843 root      1516 S    /usr/sbin/olsrd -f /var/etc/olsrd.conf -nofork
 6750 root         0 Z    [sh]
 6777 root         0 SW   [kworker/0:1]
 7894 root         0 SW   [kworker/u2:0]
 8547 root         0 SW   [kworker/u2:2]
 8592 root      1364 R    ps
 9654 root         0 SW   [kworker/0:2]
16152 root      1372 S    /usr/sbin/crond -L /dev/null
16254 root         0 Z    [sh]
20508 root         0 Z    [sh]
25476 nobody    1020 S    /usr/sbin/dnsmasq -C /var/etc/dnsmasq.conf -k
25478 root      1000 S    /usr/sbin/dnsmasq -C /var/etc/dnsmasq.conf -k
25724 root         0 Z    [sh]
30606 root      1196 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p 22 -K 300
30611 root      2192 S    -ash
32299 root         0 SW   [kworker/u2:1]
32407 root         0 Z    [sh]


# leonardo: crash: icmpv6_send: no reply to icmp error

# mark functions which need root




### check arp-cache of mastergate and set routes, if nonlocal:

root@MartinsPlastebomber:~ ip n|grep 21
fe80::221:6aff:fe32:7c1c dev br-mastergate lladdr 00:21:6a:32:7c:1c REACHABLE
fe80::221:6aff:fe32:7c1c dev wlan1-1 lladdr 00:21:6a:32:7c:1c STALE
192.168.115.61 dev br-mastergate lladdr 00:21:6a:32:7c:1c STALE
192.168.74.61 dev br-mastergate lladdr 00:21:6a:32:7c:1c REACHABLE

  - 
  - ip route add 192.168.162.61 dev br-mastergate

root@dannyEXwombel:~ cat /proc/net/arp 
IP address       HW type     Flags       HW address            Mask     Device
10.63.6.65       0x1         0x2         10:6f:3f:0e:31:8e     *        wlan0
10.63.98.193     0x1         0x0         00:00:00:00:00:00     *        wlan0
10.63.34.193     0x1         0x2         f4:ec:38:9d:81:f0     *        wlan0
192.168.162.61   0x1         0x2         00:21:6a:32:7c:1c     *        br-mastergate
                                         ^^^^^^^^^^^^^^^^^ new
10.63.157.131    0x1         0x2         c0:4a:00:50:fb:11     *        wlan0

  - iw event -r
0.000000: wlan0-1 (phy #0): mgmt TX status (cookie 817eb000): acked
0.020647: wlan0-1 (phy #0): mgmt TX status (cookie 80e34a80): acked
0.027638: wlan0-1 (phy #0): mgmt TX status (cookie 8097f3c0): acked
0.015810: wlan0-1 (phy #0): mgmt TX status (cookie 80928780): acked
0.745147: wlan0-1 (phy #0): mgmt TX status (cookie 80e34cc0): acked
0.039123: wlan0-1 (phy #0): mgmt TX status (cookie 8170d300): acked
4.273707: wlan0-1 (phy #0): mgmt TX status (cookie 80b40540): acked
5.117657: wlan0-1 (phy #0): mgmt TX status (cookie 817eb780): acked
0.020302: wlan0-1 (phy #0): mgmt TX status (cookie 809b1840): acked
0.024685: wlan0-1 (phy #0): mgmt TX status (cookie 81a33f00): acked
0.018572: wlan0-1 (phy #0): mgmt TX status (cookie 81813a80): acked
0.750898: wlan0-1 (phy #0): mgmt TX status (cookie 8170dd80): acked
0.021178: wlan0-1 (phy #0): mgmt TX status (cookie 80929240): acked
7.361254: wlan0-1 (phy #0): mgmt TX status (cookie 8097fe40): acked
10.245739: wlan0-1 (phy #0): mgmt TX status (cookie 80928480): acked
2.040165: wlan0-1 (phy #0): mgmt TX status (cookie 809be900): acked
0.019658: wlan0-1 (phy #0): mgmt TX status (cookie 8170d9c0): acked
0.025758: wlan0-1 (phy #0): mgmt TX status (cookie 80bd0c00): acked
0.019949: wlan0-1 (phy #0): mgmt TX status (cookie 817eb300): acked
0.071482: wlan0-1 (phy #0): mgmt TX status (cookie 81a33a80): acked
0.576436: wlan0: del station 10:fe:ed:65:4b:ae
0.127384: wlan0-1 (phy #0): mgmt TX status (cookie 8170d300): acked
4.276588: wlan0-1 (phy #0): mgmt TX status (cookie 80b413c0): acked
0.018791: wlan0-1 (phy #0): mgmt TX status (cookie 8170d9c0): acked
0.029723: wlan0-1 (phy #0): mgmt TX status (cookie 80e34a80): acked
0.089855: wlan0-1 (phy #0): mgmt TX status (cookie 80929840): acked
0.025095: wlan0-1 (phy #0): mgmt TX status (cookie 80e36d80): acked
0.650280: wlan0-1 (phy #0): mgmt TX status (cookie 80ae2a80): acked
0.015861: wlan0-1 (phy #0): mgmt TX status (cookie 81813d80): acked
1.743272: wlan0: new station 10:fe:ed:65:4b:ae
2.547077: wlan0-1 (phy #0): mgmt TX status (cookie 80b41600): acked
0.018543: wlan0-1 (phy #0): mgmt TX status (cookie 8170d9c0): acked
0.030081: wlan0-1 (phy #0): mgmt TX status (cookie 80b40480): acked
0.018775: wlan0-1 (phy #0): mgmt TX status (cookie 80928480): acked
0.074119: wlan0-1 (phy #0): mgmt TX status (cookie 80e34840): acked
0.011518: wlan0-1 (phy #0): mgmt TX status (cookie 80e34d80): acked
0.673404: wlan0-1 (phy #0): mgmt TX status (cookie 80e34f00): acked
0.001948: wlan0-1 (phy #0): mgmt TX status (cookie 80ae2300): acked
7.365971: wlan0-1 (phy #0): mgmt TX status (cookie 817eb3c0): acked
0.018326: wlan0-1 (phy #0): mgmt TX status (cookie 80b41e40): acked
0.026478: wlan0-1 (phy #0): mgmt TX status (cookie 80ae2a80): acked
0.018030: wlan0-1 (phy #0): mgmt TX status (cookie 80929480): acked
0.092465: wlan0-1 (phy #0): mgmt TX status (cookie 809e9780): acked
0.649942: wlan0-1 (phy #0): mgmt TX status (cookie 80e36b40): acked
0.231742: wlan0-1 (phy #0): mgmt TX status (cookie 809beb40): acked
0.020647: wlan0-1 (phy #0): mgmt TX status (cookie 80e34a80): acked


  - iw event -t
1430408943.914574: wlan0-1 (phy #0): mgmt TX status (cookie 809becc0): acked
1430408943.936851: wlan0-1 (phy #0): mgmt TX status (cookie 80ae23c0): acked
1430408943.963624: wlan0-1 (phy #0): mgmt TX status (cookie 809176c0): acked
1430408943.982092: wlan0-1 (phy #0): mgmt TX status (cookie 80e36e40): acked
1430408944.030191: wlan0-1: del station 78:d6:f0:45:eb:55
1430408945.041635: wlan0-1 (phy #0): mgmt TX status (cookie 80928cc0): no ack
1430408980.689541: wlan0: new station 10:fe:ed:65:4b:ae




  - iw event -f
root@EG-labor-AP:~ iw event -f
wlan0-1 (phy #0): mgmt TX status (cookie 809179c0): acked
wlan0-1 (phy #0): mgmt TX status (cookie 809bec00): acked
wlan0: del station 10:fe:ed:65:4b:ae
wlan0-1 (phy #0): mgmt TX status (cookie 80929180): acked
wlan0-1 (phy #0): mgmt TX status (cookie 809e9840): acked
wlan0-1 (phy #0): mgmt TX status (cookie 80b41e40): acked
wlan0-1: new station 78:d6:f0:45:eb:55
wlan0: new station 10:fe:ed:65:4b:ae



  - iw event
wlan0-1 (phy #0): mgmt TX status (cookie 815ad600): acked
wlan0-1: del station 00:21:6a:32:7c:1c
wlan0-1 (phy #0): mgmt TX status (cookie 80efae40): no ack
wlan0-1 (phy #0): mgmt TX status (cookie 80f63840): acked
wlan0: del station dc:9f:db:02:b8:ee
wlan0 (phy #0): IBSS 02:be:ef:20:01:00 joined
wlan0: new station dc:9f:db:02:b8:ee
wlan0-1 (phy #0): mgmt TX status (cookie 8182d900): acked
wlan0-1 (phy #0): mgmt TX status (cookie 816bda80): acked
wlan0-1 (phy #0): mgmt TX status (cookie 80fdfcc0): acked


# mark functions with "void" ?
# watch_wifistuff() check roaming-client if allowed -> splash if not
# rrd: DERIVE -> GAUGE?
# watchdog/schoeneck: 10.10.2.34
# check/integrate: usign
# aenderungn: lE/pension
# sysupgrade: patch for crashreboot
# better timeout for wget/scp... http://www.pixelbeat.org/scripts/timeout
# IPv6 hostnames: https://dev.openwrt.org/ticket/12384#comment:6
# IPv6 weimarnetz uebernehmen

# build: split into small peaces and show individual needed time (e.g. make tools)

# missing: /tmp/CRON_IS_CAREFUL - load >2 und volles log, jede sekunde:
  Mon Apr 27 10:10:09 2015 daemon.err dnsmasq-dhcp[7392]: ARP-cache injection failed: Invalid argument
  Mon Apr 27 10:10:09 2015 daemon.info dnsmasq-dhcp[7392]: DHCPDISCOVER(lo) 127.0.0.2 00:00:00:00:00:00 
  Mon Apr 27 10:10:09 2015 daemon.info dnsmasq-dhcp[7392]: DHCPOFFER(lo) 127.0.0.2 00:00:00:00:00:00 

# build: git-hook: autoadd function list on top of each kalua-file
  grep ^[a-z_]*'()'.* openwrt-addons/etc/kalua/olsr | cut -d'(' -f1
# do not let dnsmasq crash, when we have no internet (ping?)
# olympia-problem: master does ping, but inet does not work?
  - clients do not have def-gw? (no HNA? from master?) -> 1hop-neigh should reanimate?

### boltenhagen: win-anzeige wlan?
####### bh: neustart: 231 (ex63 - nur wo?)
### easy external monitoring: e.g. surfstation bolt + switche ibo
### use uci_defaults for apply_profile
### 3.18.13 -> itzehoe
# www.internet
### bestellen: stromzaehler/lichtschranke
### bestellen: pins: http://www.rpelectronics.com/36-140g-2-pc-header-0-10-single-row-pkg-2.html
### kamera: http://www.idealo.de/preisvergleich/OffersOfProduct/4435863_-m1025-axis.html
    - anderes objektiv?
### monitoring/server: crontab_example.txt:
  - fetch at least once after error, even when there is no data
  - show big message "this is old"
# hw-detection: use /tmp/sysinfo/model -> good name
# ipv6-watchdog: every peer can "dump" a payload (e.g. config) and ask for it later
# helper for restore safed/uploaded config
# ath10k / ibss / adhoc
  - http://www.candelatech.com/downloads/ath10k-fw-beta/
  - https://github.com/kvalo/ath10k-firmware
  - http://wireless.kernel.org/en/users/Drivers/ath10k/firmware
  - https://wireless.wiki.kernel.org/en/users/Drivers/ath10k/firmware
# alles ueber userdbGUI muss force sein (auch backup-knopf)
# DNS, ICMP, UDP nicht durch vtund-tunnel?




# rm /overlay/upper/www/images/* + see /overlay/upper/etc/config + apply + reboot?
# nach "komischen" reboot / virgin / per telnet drauf: -> like 'firstboot', settings to default/reset
# ausversehen firstboot/jffs2-format: r44945 -> 12h leasetime dhcp - auch gesehen mit r45568 - auch mit r44918/marinabh
# virgin-boot? ask my neighs for knotennummer?
# notfall-apply_profile-timeout: knoten 999? oder zufall?
# hotplug -> forbid DHCP if 192.168.1.1? -> br-lan
root@OpenWrt:/# uci show network|grep lan
network.lan=interface
network.lan.ifname=eth0.1
network.lan.force_link=1
network.lan.type=bridge
network.lan.proto=static
network.lan.ipaddr=192.168.1.1
network.lan.netmask=255.255.255.0
network.lan.ip6assign=60
network.@switch[0].enable_vlan=1
network.@switch_vlan[0]=switch_vlan
network.@switch_vlan[0].device=switch0
network.@switch_vlan[0].vlan=1
network.@switch_vlan[0].ports=1 2 3 4 5t
network.@switch_vlan[1]=switch_vlan
network.@switch_vlan[1].device=switch0
network.@switch_vlan[1].vlan=2
network.@switch_vlan[1].ports=0 5t
root@OpenWrt:/# uci show dhcp.lan
dhcp.lan=dhcp
dhcp.lan.interface=lan
dhcp.lan.start=100
dhcp.lan.limit=150
dhcp.lan.leasetime=12h
dhcp.lan.dhcpv6=server
dhcp.lan.ra=server




# scripts must not fail, without debugfs
# check e.g. on WR710n

# alter failsafe ip? = firstboot-ip? -> testit
  CONFIG_IMAGEOPT=y
  CONFIG_PREINITOPT=y
  CONFIG_TARGET_PREINIT_IP="192.168.178.2"
  CONFIG_TARGET_PREINIT_BROADCAST="192.168.178.255"

# 3rd SSID = 'Telekom'/'KD WLAN Hotspot+' + splash = Guthaben alle, freifunk nehmen 8-) -> herausfinden ueber welche SSID ein client verbunden ist?
  - "attwifi" des Carriers AT&T.
  - starbucks

# _weblogin_authserver_message: make sure to reschedule if it fails - make sure authserver is not empty?
# monitoring: signal() from next_hop
# dnsmasq: inet-offer via wan => nexthop is next_resolver - why? -> override only via /etc/init.d/dnsmasq
# use builtin-olsr feature for "olsrd.@meta[0].nexthop_dns"
# ath25 = atheros
# woher kommt das?!: [  512.940000] sh (12532): drop_caches: 3
# ejbw: DNS vom netzwerk nehmen, nicht ueber provisionierung?
  - zaenker@weimarer-republik.net, huenniger@weimarer-republik.net 
  - EJBW-Monitoring@ejbweimar.de, ejbw-pbx@ejbweimar.de -> technik@bittorf-wireless.de

# switch_show() when interactive = \n
# build: add short/long description to each option (e.g. squash64)
# _reboot reason() _reboot crash()
# api: www.mac2vendor.org/net/info - frei
# profile for x86_wifiall ->laptop
# frag-test: ping -M do -s 1472 172.17.0.81
# default-ip != 192.168.1.1 + dhcp OFF + dauerhaft 'help' via ipv6? -> after 10 reboots without success?
# use 'simple command syntax' for set, e.g. IFS=xy set -- $bla
  or introduce 'split' X '$list'
# switch to whatsapp instead of sms? -> androidVM?
  - maybe a jabber gateway?
# introduce CLASS _monitoring with list_networks()
  - arg1 = network or 'maintenance' or <empty> = all and 'smallest size first' + 'allow_symlinks' (do not filter -> )
  - arg = show_small?
# do not send mail, when bwireless is not in known hosts (berlinle)
# _netfilter_portforwarding_request: use also for static arp entries?
# 1043nd: support profile with 4mb flash (for broken NAND)
# apply_profile: update DMESG during jffs2-search
# apply_profile: uci -q get !!!
# apply_profile: args: $network $number = $network hybrid $number
# datentarif/monitoring/ssh
  - prepaid: 24ct/mb: https://www.simyo.de/tarif/starter-9cent.html
  - http://www.surf-stick.net/freier-surfstick-offen-fuer-alle-sim-karten.html
  - Huawei E353 = 31 Euro
# bolt: 10.10.159.129 - kein ping auf 10.10.2.129 ->
  - nexthop = wired? ->ping? -> seems not good -> change ssid 
# monitoring: mini-page for mini-devices: OK/ERROR - x/100% good, wireless: X wired: Y
# monitoring: join + workflow
# ejbw: 192.168.2.11-20/24 - pbx = .1 (fuer demokratie 571/572)
  sudo ip route add 192.168.2.0/24 via 172.17.0.1 dev eth1
  # fuer schulkino:
  sudo ip route add 192.168.112.0/30 via 172.17.0.1

  # ejbw: force WAN olsr on 50

  # ejbw: 0.0.0.0/0 auf 100
  # ejbw: ssh only from priv ip an master

  # apply_profile: ejbw: n43:
    - lan_alias => normale IP, lan = 192.168.0.1/24
    - lan-dhcp_ignore=0
      - start = 192.168.0.2 / limit = 230
      - HNA: 192.168.0.0/24
    - 192.168.0.240 ... 254 = schaeferM
    - list_server: 172.17.0.21 + 22

# make calls to 'iwconfig' fakultativ
# make calls to 'iwinfo' fakultativ
# make calls to ath/debugfs fakultativ
# default google.de -> .it -> .com -> i18n
# p910 -> enable + config usb + start
# channel=auto + acs-scan possible? every ~45 mins when idle restart phyX
# build: Standard8mb, Standard4mb?
# olsr_gateways sorted
# xoai + apphalle = roaming
# roaming-IP: 172.16.0.0/12 -> 1024 nodes * 1024ip's = /22er netze
  node1: 172.16.0.1 - 172.16.3.254
  node2: 172.16.4.1 - 172.16.7.254
         ...
  - unnoetig kompliziert: einfach 172.18.0.0/16 nehmen

# dbGUI: logout-knopf
# dbgui: namensraum jeweils fuer profil speichern
# ibfleesensee:
  a0:48:1c:8a:ff:92 sf-rechts
  a0:48:1c:8b:2d:3a sf-links
  00:08:22:c0:fe:48 zeit/rezeption
  28:6a:ba:08:4b:47 djukebox restaurant
  28:6a:ba:87:6d:48 djukebox bar
# dbGUI: schrift groesser oder anderer font -> IE
# emailaddresse an die geschickt werden soll direkt in profile. verschiedene mails fuer verschiedene profile
# auto-reverse-ssh-tunnel if inet offer and never logged in?
# dhcp: send ntp-server ("same router"): list dhcp_option 'option:ntp-server,0.0.0.0'
# all actions in hotplug must be stored in a file, so that 'netfilter restart' applies this actions again
# apply_profile: always write hybrid? -> adhoc- or ap-only = disable sections
# periodically change channel in ap-mode to a non congested one
  -> (when cleanup after client) -> scan + choose new channel
  - http://nitlab.inf.uth.gr/NITlab/index.php/testbed/instructions/experimentation/482-ahteros-spectral-scan?start=4
  - google: ath9k spectral scan use least congested channel
  - https://wiki.freebsd.org/dev/ath_hal(4)/SpectralScan
  - https://dev.openwrt.org/ticket/17392
    - channel=auto since r42682 on athXXX
      - how to restrict to channel 1-11? otherwise 14 is selected
      - hs20_operating_class=5373 (operating class 83 -> 0x53 = channel 1-9 + 115 -> 0x73 = channel 36-48)
        - needs full hostapd? -> error
      - chanlist=1 2 3 4 5 6 7 8 9 10 11 36 40 44 48
        - reinpatchen in '/lib/netifd/hostapd.sh' -> scheint auch nur bei 'full' beachtet zu werden
# helper-function: reboots/day -> use it for e.g. switch/dontreboot
# fswebcam:
  - http://stackoverflow.com/questions/5452286/fswebcam-unable-to-load-font-luxisr-libgd-was-not-built-with-freetype-font-s
  - use config file: http://www.r3uk.com/index.php/38-tech-tips/software/100-webcam-capture-using-fswebcam
# dmesg() -> cat /tmp/dmesg.log when interactive
# if last state before shutdown was "maintenance", keep it till good again
# db_lock: same reason must wait? ignore call? ("index_gen")
# kalua-loader: force lowmem?
# no over_uptime when inet_offer?
# limona: steckdose: iptables -t nat -I POSTROUTING -d $ip_steckdose -j MASQUERADE
# build: cdp-tools
# build: mii-tool only if needed for switch of this model -> ask _switch
# measure traffic in phyX without olsr and report to master
# monitoring: http://en.wikibooks.org/wiki/Unicode/List_of_useful_symbols
  - USB-symbol: 2646 Neptune
  - WiFi: 26A1 high voltage sign
    - Unicode number: U+16C9
    - http://shapecatcher.com/unicode/info/128246 -> 0x1f4f6 -> does not show on chrome
  - wired: http://shapecatcher.com/unicode/info/10203 = 0x27db

# datenbank beim allerersten mail wird auf DISK abgelegt! (+ /database /db_backup)
# send mail = important when from GUI
# do not show cisco-auth in log
# generalize cron.dead-detector + higher timeout (60mins?)
# fix fw-download for liszt28
# ls -1 usecase/TP-LINK\ TL-WR1043ND.openwrt\=r43* | grep -v Small | while read LINE; do cp /root/1.bin "$LINE";done

# longlasting jobs must 'bump' cron-checker (e.g. cisco = 446 sec -> 300 sec border)
# enable init-scripts and remove all hacks about it: caused by https://dev.openwrt.org/changeset/42470
# db locked? -> reschedule job (when via scheduler anyway and we have time)
# alle startup-skripte als boot() + rc.common umbauen, damits beim make nicht kracht...
# ffweimar: make a special stable tarball with a 'backdoor' via a small file which gets included (wget + execute?)
# nslookup: look which server gives answer -> monitoring
# weblogin: minimal freifunk-theme + rules
  - http://freifunk.net/wp-content/themes/freifunk_base/img/logo_freifunknet.png
  - http://wiki.freifunk.net/Freifunk-Styles#Logo
    - https://upload.wikimedia.org/wikipedia/commons/9/9c/Freifunk_logo.gif
    - http://augsburg.freifunk.net/uploads/RTEmagicC_freifunk-ab.gif.gif (ohne text)
  - oder von der 48 / wireless weimar?
# unittest: test javascript
# unittest: generate all html-outputs and check these

# db: regen index  bei aenderung username oder password?
# monitoring: only send when changed something (trigger!), otherwise only heartbeat
# 2 x RF -> dhf
# wieviel logins pro ticket? -> reh
# email = uci
# telefon = uci
# abtpark: mcast
# adhoc: hidden ssid: '2ghz' + '5ghz' + hidden=1
# do: _wifi get any mode ap -> _wifi get 2ghz mode ap
# indoor: distance = 100m?
# autobuild mydesign-minimal during apply_new_network
# autobuild mydesign
# autossh-tunnel: new inet-offer + privateIP + ?
# vtun: debian nethack-patch? https://www.mail-archive.com/vtun-devel@lists.sourceforge.net/msg00012.html
# lowmem: use 64k squashfs-blocksize or even on 8mb-routers?
# hostapd -> set ssid via ubus? -> or via SIGHUP http://www.raspberrypi.org/forums/viewtopic.php?f=91&t=64505
# opkg: high load: kill after 1h
# NETPARAM: WIFIAPDEV? WIFIAP_DEVS?
  -> hostapd.conf
  -> oder es gibt eine VARIABLE
  -> alles by hotplug/ifup abwackeln
# apply_profile: new net: reset SSID's + hostname + pass
# full_trace: deliver cached? + cache once when GW changes
# unittest?
  - boot openwrt in qemu?
    - python sslyze.py --regular 10.63.22.65:443
# via macvlan nur ein DHCP-pool? (ueberall gleiche mac + gleiches DHCP-interface?)
# vpn: server: restart olsrd when interface up, but no neigh
# email an xy@... -> verteiler rehungen (ueber userdb-gui!)

SWITCH-E2-POE24#show env all
FAN is OK
TEMPERATURE is OK

POWER is OK
RPS is NOT PRESENT

show power inline -> watts + ALL neighs
show cdp neighbor detail -> hostname
show cdp neighbors


# cdptools/sending CDP:
  - cdp-send -m ar71xx -n $HOSTNAME $WANDEV
  - cdp-send -o -t 999 -m TPL1043ND -n $HOSTNAME $WANDEV
  - test with tcpdump -v -s 1500 'ether[20:2] == 0x2000' -i $LANDEV
Device ID        Local Intrfce     Holdtme    Capability  Platform  Port ID
AP-E4-426        Fas 0/7           139           T I      AIR-AP124 Fas 0
AP-E4-435        Fas 0/9           151           T I      AIR-AP124 Fas 0
AP-E2-216        Fas 0/11          169            H       ar71xx    eth0.2
AP-E4-443        Fas 0/10          152           T I      AIR-AP124 Fas 0
AP-E4-434        Fas 0/8           122           T I      AIR-AP124 Fas 0
AP-E2-211        Fas 0/2           175           T I      AIR-AP124 Fas 0
AP-E4-401        Fas 0/6           132           T I      AIR-AP124 Fas 0
AP-E2-201        Fas 0/3           175           T I      AIR-AP124 Fas 0
AP-E4-419        Fas 0/4           122           T I      AIR-AP124 Fas 0
AP-E2-219        Fas 0/1           179           T I      AIR-AP124 Fas 0
SWITCH-E2-24PORT Gig 0/1           124           S I      WS-C2960- Gig 0/2
SWITCH-E3-24PORT Gig 0/2           147           S I      WS-C2960G Gig 0/23


# SWITCH-E5-POE24 = .249 -> port13 = Fa0/13 -> AP-E4-527 (alles andere = Cisco)
# SWITCH-E3-POE24 = .230 -> port12 = Fa0/12 -> AP-E3-311 (alles andere = Cisco)
                            port19 = Fa0/19 -> AP-E3-306
# SWITCH-E2-POE24 = .254 -> port5  = Fa0/5  -> AP-E4-411 
                         -> port11 = Fa0/11 -> AP-E2-216 
                         -> port12 = Fa0/12 -> AP-E2-206 
                         -> port13 = Fa0/13 -> AP-E4-406
                         -> port14 = Fa0/14 -> AP-E4-416
                         -> port15 = Fa0/15 -> AP-E4-427


# fix uci-defaults/lowmem: 
# check: when /tmp/FREE every router asks for USERDB during check_inet
# fulltrace at least once a day and include into myinfo
# switch: support for PoE-Power ON/OFF
# switch: PoE: single port off/on -> enable -> conf terminal -> interface $ID -> power inline never -> power inline auto
# switch: support for 'powerplug', 'console' and 'USB'
# switch: support for 'port with inet_offer' and add 'tooltip'
# switch: support for drawing wobbly lines from port2port: http://stackoverflow.com/questions/442404/retrieve-the-position-x-y-of-an-html-element
# monitoring: switch: use kalua-framework:
# ibo: node2: lan-alias: 192.168.202.1/24
# liszt28: dns loops?
# store minstrel value after wifi-speedtest and regulary check if it's much lower -> wifi
# checken: Datenschutz und Vorratsdatenspeicherung / Ueberschrift + KurtEisner76-text/grafik 
# usb-stick: automatisch fuer VDS benutzen
# db_report() datenverkehr der topnutzer per mail verschicken
# on AP scan: iw dev wlan0 scan | grep ^'BSS [0-9a-f][0-9a-f]:' -> send a note to routers with "i can see you" - if nobody sends for X minutes: wifi restart (ignore 02:ca:ff:ee:00:11)
# monitoring: lan-inet-offer: show 1st lanport and remove 'red' for nodenumber (tkolleg)

# apply_profile: by accident flashed sysupgrade: "jffs2: Further such events for this erase block will not be printed" + "jffs2: Further such events for this erase block will not be printed" + many: "jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x001f0020: 0x6b91 instead" -> print 'please firstboot'

# apply_profile: do not remove mydesign twice
# monitoring: report suddenly many reboots of a node
# make proper build-support for all devices in HARDWARE/apply_profile and remove the autodetection
# switch_show() mode for terminal ("interactive"), line by line with explanation
# weimarnetz-anonym: alles was aus weimarnetz in ein privates netz will, ueber main abfackeln
# when removing scheduler.log (hanging cron), also remove locked db?
# check bootlogread for 'HOSTAPD_START_FAILED'
# longshot: error_framecounter: safe stats
# limona: wifi_check nur alle X minuten
# while read LINE; do case "$LINE" in *'0');;*) echo $LINE;;esac  ;done </sys/kernel/debug/ieee80211/phy0/ath9k/reset
# _wifi set() -> do not set for 2 x 2.4ghz phy's the same bssid
# longshot() only work on correct band
# status.sh: build_remote_hostname() do not accept 'mywifi' or 'hotel'
# try poormens tcp-shaping (10*1500= 15Kbyte/sec)
  - iptables -I FORWARD -d $USERIP -j DROP
  - iptables -I FORWARD -d $USERIP --state RELATED,ESTABLISHED -m limit --limit 10/second --limit-burst 30 -j ACCEPT
# vpn: delete very old lockfiles on server
# think about sysctl -w net.netfilter.nf_conntrack_skip_filter=0
  - was removed in r44873
# think about android-bug: https://code.google.com/p/android/issues/detail?id=19406
# DHT for macs / ffweimar
# build: option -> 'usecase'
# reh/250/249: _switch not X? = "eth0: no link" -> mii-tool -A 100baseTx-FD eth0 -> "eth0: negotiated 100baseTx-FD, link ok"
# fix crashlog-upload (analyze POST + answer on server + iptables-match for HTTP-OK?)
# cgi-bin-status: warum heissen/hostname manche 'mywifi' ?
# Wartungsmode: keine umlaute (tkolleg)
# sms: use: http://textbelt.com/text
# optimize jffs2 for 2mb-flash: https://forum.openwrt.org/viewtopic.php?id=4039
# gesplasht und google-suche per chrome-url-bar:
  - umleitung auf 'http://gstatic.com/generate_204'
  HTTP/1.1 204 No Content
  Content-Length: 0
  Content-Type: text/html; charset=UTF-8
  Date: Sun, 25 Jan 2015 20:01:34 GMT
  Server: GFE/2.0

# tune makefile: include/kernel-build.mk
  find staging_dir/|grep /lib/modules/ | grep \.ko$ | xargs nm | awk '$1 == "U" { print $2 } ' | sort -u >/tmp/BLA
  find staging_dir/|grep /lib/modules/ | grep \.ko$ | xargs nm -u | tr -d ' U'
# fix pingchecker against empty-output: iptables -I OUTPUT -p icmp -j DROP
# gen_pdf for router tech-facts
# tcpdeny https? http://unix.stackexchange.com/questions/28851/iptables-to-block-https-websites
# check pingwrite rehungen/master
# integrate https://github.com/gitmo/openwifimap.sh/blob/master/openwifimap.sh
# build weblogin-cache for all langs + compressed? http://aktuell.de.selfhtml.org/artikel/grafik/inline-images/ + https://developer.mozilla.org/en-US/docs/Web/HTTP/data_URIs
# report via mail when pinglost on inetoffer each day?
# write hotplug for p910d -> https://dev.openwrt.org/ticket/18773
# vpn: use 'type tun' and 'proto udp'???
# DHT for mac's: full or half and use for splash
# tastatur per USB/funktastatur anschliessen und neuen hostnamen eintippen?
# dnsmasq: option localservice 0	# since r43982
# monitoring: do not show crashs older than X days?
# check minstrel: only slow rates and massiv sampling on alle rates -> HWreset
# fix pdf output: http://www.pdf-tools.com/pdf/validate-pdfa-online.aspx
# build: automatically add new downloads to a git and push - use this git during initial setup
# bad olsr-ip of 44? from NAS? how can that happen?
# http://www.shellcheck.net/about.html

system.vpn.hostname=weimarnetz.de
system.vpn.ipaddr=77.87.48.19
system.vpn.port=5001
system.vpn.enable=1

# HTTP_ACCEPT_ENCODING=gzip, deflate, sdch -> deliver compressed? http://checkgzipcompression.com/?url=https%3A%2F%2Fwww.google.de
  - laptop: nc -l 9999 >request + open in browser 127.0.0.1:9999 + CTRL+C
  - cat request | nc www.google.de 80 >response -> see headers 8-)
    - Content-Encoding: gzip
full:
bastian@X301:~$ more response
HTTP/1.1 200 OK
Date: Thu, 08 Jan 2015 10:10:51 GMT
Expires: -1
Cache-Control: private, max-age=0
Content-Type: text/html; charset=UTF-8
Set-Cookie: NID=67=jXeenU8io_2QnBFCf-0JlEhEXhaTM3fZ_V_nf4OacdZgpEIKZ2ruV_9nNVpBULabLun_3SNPNZIvGiJfkJlCjNtAPzNAlASGq-d0jv_yd5WMsrvQFjXA-X4q_IKXi0TX; expires=Fr
i, 10-Jul-2015 10:10:51 GMT; path=/; domain=.; HttpOnly
P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."
Content-Encoding: gzip
Server: gws
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Transfer-Encoding: chunked
Alternate-Protocol: 80:quic,p=0.02

7872
[...]


00000270  50 72 6f 74 6f 63 6f 6c  3a 20 38 30 3a 71 75 69  |Protocol: 80:qui|
00000280  63 2c 70 3d 30 2e 30 32  0d 0a 0d 0a 37 38 37 32  |c,p=0.02....7872|
                                   ^^^^^^^^^^^
00000290  0d 0a 1f 8b 08 00 00 00  00 00 02 ff ec bd d9 76  |...............v|
          ^^^^^^^^^^^
000002a0  db c8 92 00 f8 5e 5f 41  d1 dd 12 d9 82 28 80 fb  |.....^_A.....(..|

---> gzip = 1f8b - aber vorher kommt noch 0d 0a + 0d 0a + 37 38 37 32 , 0d 0a + 1f 8b



printf "HEAD / HTTP/1.0\r\n\r\n" | nc -n -i1 10.63.96.225 80
printf "HEAD /cgi-bin-status.sh HTTP/1.0\r\n\r\n" | nc -n -i1 10.63.22.65 80
printf "GET /cgi-bin-status.sh HTTP/1.0\r\n\r\n" | nc -n -i1 10.63.22.65 80

00000020  73 65 0d 0a 43 6f 6e 74  65 6e 74 2d 74 79 70 65  |se..Content-type|
00000030  3a 20 74 65 78 74 2f 68  74 6d 6c 0d 0a 0d 0a 3c  |: text/html....<|
                                            ^^^^^^^^^^^ = linebreak
00000040  21 44 4f 43 54 59 50 45  20 48 54 4d 4c 20 50 55  |!DOCTYPE HTML PU|

# transfer-encoding:
bastian@X301:~$ printf "GET /cgi-bin-status.sh HTTP/1.0\r\n\r\n" | nc -n -i1 10.63.22.65 80 | hexdump -C
00000000  48 54 54 50 2f 31 2e 30  20 32 30 30 20 4f 4b 0d  |HTTP/1.0 200 OK.|
00000010  0a 43 6f 6e 6e 65 63 74  69 6f 6e 3a 20 63 6c 6f  |.Connection: clo|
00000020  73 65 0d 0a 43 6f 6e 74  65 6e 74 2d 74 79 70 65  |se..Content-type|
00000030  3a 20 74 65 78 74 2f 68  74 6d 6c 0d 0a 54 72 61  |: text/html..Tra|
00000040  6e 73 66 65 72 2d 45 6e  63 6f 64 69 6e 67 3a 20  |nsfer-Encoding: |
00000050  67 7a 69 70 0d 0a 0d 0a  37 38 37 32 0d 0a 1f 8b  |gzip....7872....|
                      ^^^^^^^^^^^              ^^^^^^^^^^^
00000060  08 00 49 2e b0 54 02 03  ed 5b 7b 73 db 38 92 ff  |..I..T...[{s.8..|

# content-encoding:
bastian@X301:~$ printf "GET /cgi-bin-status.sh HTTP/1.0\r\n\r\n" | nc -n -i1 10.63.22.65 80 | hexdump -C >/tmp/BLA
00000000  48 54 54 50 2f 31 2e 30  20 32 30 30 20 4f 4b 0d  |HTTP/1.0 200 OK.|
00000010  0a 43 6f 6e 6e 65 63 74  69 6f 6e 3a 20 63 6c 6f  |.Connection: clo|
00000020  73 65 0d 0a 43 6f 6e 74  65 6e 74 2d 74 79 70 65  |se..Content-type|
00000030  3a 20 74 65 78 74 2f 68  74 6d 6c 0d 0a 43 6f 6e  |: text/html..Con|
00000040  74 65 6e 74 2d 45 6e 63  6f 64 69 6e 67 3a 20 67  |tent-Encoding: g|
00000050  7a 69 70 0d 0a 0d 0a 37  38 37 32 0d 0a 1f 8b 08  |zip....7872.....|
                   ^^^^^^^^^^^              ^^^^^^^^^^^
00000060  00 49 2e b0 54 02 03 ed  5b 7b 73 db 38 92 ff fb  |.I..T...[{s.8...|



http://www.gzip.org/zlib/rfc-gzip.html#file-format
http://stackoverflow.com/questions/388595/why-use-deflate-instead-of-gzip-for-text-files-served-by-apache
http://www.vervestudios.co/projects/compression-tests/results
http://stackoverflow.com/questions/11584390/on-linux-use-the-compress-and-uncompress-functions-of-zlib-it-sometimes-re
http://stackapps.com/questions/916/why-content-encoding-gzip-rather-than-transfer-encoding-gzip
http://stackoverflow.com/questions/2308389/gzip-without-server-support
http://stackoverflow.com/questions/3894794/node-js-gzip-compression
https://github.com/tomgco/gzippo/blob/master/lib/staticGzip.js


# use 'readonly $var' ?
# announce reboot to neighs via netmsg - e.g. against false positives of switch() / lost olsr neigh
# switch: rb532
# S43ether: alles ist client und alle interfaces die hochkommen werden abgezogen. loest das prob mit .3 = user-lan3-n222 -> soll = node222adhoc?
# opkg install ca-certificates + export SSL_CERT_DIR=/etc/ssl/certs ???
# pdf: font aendern oder einbetten
# stresstest netifd/ulogd
# button: support for pressing e.g. 7 times
# ilm1: mcastrate auf 2.4ghz hoch -> 5ghz bevorzugen
# autoconvert?:
  - option hwmode '11ng' -> 11g
  - list ht_capab -> option path     'platform/ath9k'
# paltstadt: 5/bssid + ffeth
# crashlog2log (init) extra function
# use parser?: http://www.yolinux.com/TUTORIALS/BashShellCgi.html
# remove '$DIR_DATABASE' from flash? (old error) - so we can test -d $DIR_DATABASE && ...
# unstable LAN? rehungen: mii-tool -r eth0 (3 stellen auf 249)
# restoring userdata: wait till tar is good? how can it happen, that a bad tar is uploaded? -> full disc during download/restore
  ### signal/sms when [ERR] untar DB
# newstyle-firmware-update:
  # es sollte moeglich sein eine beliebige konstellation anzufordern und zu checken, also:
    # gibt mir/zeig mir: stable/beta/testing oder
    # bau mir XY mit version r12345 (dann muss update = 0 gemacht werden)

  - pmu:
    https://$monitoringserver/networks/$NET/scripts/testing/tarball.tgz
  - firmware:
    https://$monitoringserver/networks/$NET/firmware/models/$HW/testing/$fullname.bin
  #
  _links firmware_url_get
  _links firmware_url_get tarball
  _links firmware_url_get crc


# dhf: jeder kann master werden (wenn WAN gesteckt wird?)
# RRD-graph for VPN-server
# dynamic_portfw: generate JSON? or sh-script for monitoring-server [xoai]
# think about _scheduler_wait_till_cpuload_is_low()
# firmware_burn: do not complain 'msg3' when network-stuff was not unloaded?
# rmmod: do not try to unload /proc/modules -> 'ipv6                  256705 16 [permanent]'
# monitoring-wifimac = locally_administered -> delete + recreate + correcting on monitoring-server?
# fix au1000-mac: "add a file in /etc/uci-defaults/ these get called on firstboot and are deleted after being run"
# S43ether breaks for kurt/dns/LAN - 10.63.156.161 = 666
# make use of 'ip -details link' for getting type (wireless, tun, ether, vlan)
# checken ob einspeiser wirklich 0.0.0.0/0 hat? -> spbansin7
# tobi/youtube-dl -g
# reduce the "CRON_LASTCALL" -checker to: hotplug/dhcp + www?
# do not complain about unstable LAN
  - for new neighs (report after olsr-newup) + delete from log
# fix: first LOWMEM after first olsr_build_tables
# implement system.@netfilter[0].lan_masquerading = 0
# check if dnsmasq really offers all configured ranges? -> ejbw -> schulkinowoche
# monitoring-server: watch failure of longshot 
# defaultrouter (ppp!) does not work? -> fax/sms via nexthop + remove HNA inet-offer
# nach crash/reboot werden clients nicht automatisch wieder angemeldet
# db: erst mails verschicken, wenn backup erfolgreich?
# db: regen grepable -> signal to all for new download?
# olsr: do not log all unstable neigh's of at least 1 is good or it is our default route
# use image in readme: ![sxiv](http://muennich.github.com/sxiv/img/logo.png "sxiv")

### changed effective gateway? effective nexthop? send message once (with lifetime)?

### howto remotely add/del hideandseek-user?
### autoactivate hideandseek on master for ALL routers...(the master must not be the authserver)
    # hideandseek: add all IP's via trafficsend ... + autoremove old IP's on master
    # master can reboot and everything/rules is lost?
# vpn-server:
  - write default olsr.conf
  - provide minihelper for compile olsrd + vtun + tinc?
# vpn: hide port/ip/mtu/etc in dns-SRV records:
  # wie linken auf vpnserver mit anderem port?
  # echo 'request google.de' | nc -vu 8.8.8.8 53 >/tmp/H
  # http://www.jfranken.de/homepages/johannes/vortraege/netcat_inhalt.de.html#ToC6
  # dig _carddav._tcp.home.andi95.de SRV
# convert to valid reasons: git grep 'system reboot_safe'
# vpn_hideandseek: remove old IPs (same mask) before add 'exclude'
  -> how to check, if 10.63.22.125/26 belongs to 10.63.22.65/26?
  -> ip2long()
  -> calc net-address? http://networkengineering.stackexchange.com/questions/7106/how-do-you-calculate-the-prefix-network-subnet-and-host-numbers
  -> test youtube nongerman/nonblocked with: Tron Legacy - Overture (1) [Daft Punk] 


# tune TCP and lowmem devices: https://dev.openwrt.org/ticket/9304#comment:41
# use statistics from 'iw wlan0 survey dump': http://stackoverflow.com/questions/24161383/how-to-get-wifi-channel-busy-time
# fix S43 for nslookup: 10.63.222.3
# lsusb -> find /sys/devices/platform/ehci-platform|fgrep '/idVendor' + idProduct
# build: use diffconfig.sh?
# adserver: change range to priv-ip
# fix: MESSAGE="startup/ when db cannot be downloaded
# ffweimar -> weblogin nur mit "wegdruecken" + integration grafiken/button ins image?
# log() sms_once + all alert to central master?
# halfduplex when bullet -> 1043 and enforced rate 100mbit?
# bullet: 10mbit -> only switch if error eccured once? 
# always set 'funcname' or let it include from loader? (also $self - so we can call ourself)
# propagate loss of inet on master?
# tunnel: make a NOT possible (e.g. everything through tunnel but NOT xy) -> also make 'mask' part if $1 and $2 = NOT
# towerpower: 0.0.0.0/0 nach uhrzeit?
# wifi: ath9k: track worst/best calibration value
# debugfs knob 'dfs_block_radar_events'
# fix registrator with new API (get_next_free)
# vpn: check_server + check_client: use 'hanging_command vtund'
# win-prob: dns.msftncsi.com
# rechedule: include stub-class? e.g: _vpn; _vpn bla
# olsr-status: kabelnachbarn werden nicht als missing angezeigt
# userdb-gui: suchen 'in allen profilen' geht nicht
# cron.add... show "best" 3
# $IPT -> function?
# vpn-server: ordentliche index-page + robots.txt
# test: env-space gets exhausted with 128k VARS= ??? (including funcs?)
# protection against: NTP-Amplification-Attack
# towerpower: reject all from wan?
# olsr: wird nicht jede minute geprueft?
# youtube-dl: einspeiser fragt vpn-server: ich bin dein "tinyproxy:8888", gibbe URL von VideoX - download X + loop (jedes mal anderer browser?)
# test: usb-stick -> automount -> audiofiles ueber cgi-bin-music.sh freigeben und ankuendigen
# innercity-tunnel:
  - join server + router-skripts
    - alle nodenummern fuer vtun-conf erzeugen
  - verschiedene tunnel:
    - innercity()
      - server
      - client: hideandseek()
    - router2inetoffergw()
      - user2inetoffergw()
    - intercity()
  - vpn_hideandseek_user_add()
  - vpn_hideandseek_user_del()
  - vpn_beim einloggen "ich will" an zentrale (wie tool?) und bei jeder trafficmeldung auch.
    - vpn_askmaster_request_permission()
  - koppeln an ETX 1.000 fuer 5min - nutzer die "wollen" muessen sich vorher anmelden und werden einzeln an/abgeschaltet
    - in olsr_build_tables()
  - youtube-mode: http://stackoverflow.com/questions/9342782/is-there-a-way-to-get-all-ip-addresses-of-youtube-to-block-it-with-windows-firew


# iptables: hotplug: integrate tunnel-traffic https://github.com/weimarnetz/weimarnetz/blob/master/openwrt-addons/etc/kalua/vpn#L160
# longshot-test: check with 'strings' if trash arrived
# block info /dev/sdb -> should fail of n/a
# user_list -> also in e.g. /tmp/OLSR/fixed_arp_10.63.40.97? -> delete user
# code-duplication of watchdns + _net_refresh_dnshosts
# refresh hosts/statistic of dnsmasq sometimes wrong pid
# hash aus downloaddir weg, wird nicht gebraucht. ausserdem order-struktur aufraeumen
# auto-apport of crashdumps
# longshot-report: /sys/kernel/debug/ieee80211/phy0/ath9k/dfs_stats
# log: wenn $funcname da ist, mit anzeigen?
# fix autoreschedule
#
# userdb:
  - zeigen an welche emails verschickt wird
  - pdf/font: arialnarrow gibts nicht ueberall, fallbackfont einbinden (Times)
  - ticket-nummern + seitennummern
  - funktion: sperren/gesperrt
  - abgleaufen anzeigen


#
# olsr-netfilter: -d unneeded? separate wired/2.4/5ghz?
# mydesign: FeWo Wuensch
# mydesign: ffweimar
# mydesign: zwickauerflitzer
# VPN: hotplug -> wan/lan
# called too often: netfilter_masquerade_start
# hostapd oder 'iw event'-script: http://forum.ubuntuusers.de/topic/hostapd-wlan-ap-aufruf-eines-scripts-wenn-ein-/
# fix ADSL broken in monitoring: check inet_gw: pppoe
# jffs2-ready() hook '/sbin/jffs2reset -y'? or /sbin/jffs2mark
# switch: html: detect blink and show it (rebooting neigh)
root@dhfleesensee-adhoc--62:~ while :;do echo "$(date) $(_switch show)";sleep 1;done
Thu Oct 30 14:15:39 CET 2014 -.----
Thu Oct 30 14:15:40 CET 2014 -.----
Thu Oct 30 14:15:41 CET 2014 -.----
Thu Oct 30 14:15:43 CET 2014 -.----
Thu Oct 30 14:15:44 CET 2014 -.C---
Thu Oct 30 14:15:45 CET 2014 -.C---
Thu Oct 30 14:15:46 CET 2014 -.C---
Thu Oct 30 14:15:47 CET 2014 -.C---
Thu Oct 30 14:15:48 CET 2014 -.C---
Thu Oct 30 14:15:50 CET 2014 -.C---
Thu Oct 30 14:15:51 CET 2014 -.C---
Thu Oct 30 14:15:52 CET 2014 -.C---
Thu Oct 30 14:15:53 CET 2014 -.C---
Thu Oct 30 14:15:54 CET 2014 -.C---
Thu Oct 30 14:15:55 CET 2014 -.C---
Thu Oct 30 14:15:57 CET 2014 -.C---
Thu Oct 30 14:15:58 CET 2014 -.C---
Thu Oct 30 14:15:59 CET 2014 -.C---
Thu Oct 30 14:16:00 CET 2014 -.C---
Thu Oct 30 14:16:01 CET 2014 -.C---
Thu Oct 30 14:16:02 CET 2014 -.C---
Thu Oct 30 14:16:04 CET 2014 -.C---
Thu Oct 30 14:16:05 CET 2014 -.C---
Thu Oct 30 14:16:06 CET 2014 -.----
Thu Oct 30 14:16:07 CET 2014 -.----
Thu Oct 30 14:16:08 CET 2014 -.----
Thu Oct 30 14:16:09 CET 2014 -.----
Thu Oct 30 14:16:11 CET 2014 -.----
Thu Oct 30 14:16:12 CET 2014 -.----
Thu Oct 30 14:16:13 CET 2014 -.----
Thu Oct 30 14:16:14 CET 2014 -.C---
Thu Oct 30 14:16:15 CET 2014 -.C---
Thu Oct 30 14:16:16 CET 2014 -.C---
Thu Oct 30 14:16:18 CET 2014 -.C---
Thu Oct 30 14:16:19 CET 2014 -.C---
Thu Oct 30 14:16:20 CET 2014 -.C---
Thu Oct 30 14:16:21 CET 2014 -.C---
Thu Oct 30 14:16:22 CET 2014 -.C---
Thu Oct 30 14:16:23 CET 2014 -.C---
Thu Oct 30 14:16:25 CET 2014 -.C---
Thu Oct 30 14:16:26 CET 2014 -.C---
Thu Oct 30 14:16:27 CET 2014 -.C---
Thu Oct 30 14:16:28 CET 2014 -.C---
Thu Oct 30 14:16:29 CET 2014 -.C---
Thu Oct 30 14:16:30 CET 2014 -.C---
Thu Oct 30 14:16:32 CET 2014 -.C---
Thu Oct 30 14:16:33 CET 2014 -.C---
Thu Oct 30 14:16:34 CET 2014 -.C---
Thu Oct 30 14:16:35 CET 2014 -.----
Thu Oct 30 14:16:36 CET 2014 -.----
Thu Oct 30 14:16:37 CET 2014 -.----
Thu Oct 30 14:16:39 CET 2014 -.----
Thu Oct 30 14:16:40 CET 2014 -.----
Thu Oct 30 14:16:41 CET 2014 -.----
Thu Oct 30 14:16:42 CET 2014 -.----
Thu Oct 30 14:16:43 CET 2014 -.C---
Thu Oct 30 14:16:44 CET 2014 -.C---
Thu Oct 30 14:16:46 CET 2014 -.C---



# make user of '/tmp/sysinfo/board_name' -> tl-wr1043nd
# make use of output/switchtype: swconfig dev switch0 help
# fire memtest before flashing? = 6K -> http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/packages/memtester_4.1.3-1_ar71xx.ipk
# make use of 'test -s $file' (must be greater than zero)
# build.sh: fix --kernel with new VAR
# make use of 'opkg list-changed-conffiles'?
# delete capabilities in CC+: https://dev.openwrt.org/ticket/17849#comment:5
# detect changes in cat /sys/kernel/debug/ieee80211/phy0/ath9k/dfs_stats
# patches: support for revertXY
# smoketest: gen_html? from_logfile? runtime_array + always gen if array changes
# button: use $SEEN in [sec] or hackin SEEN_MS
# olsr: 1st neigh: force probing (for seeing a mac) for making perm: 10.63.40.193 dev wlan0 lladdr dc:9f:db:0c:ca:cc PROBE
# statusseite: SNR: anzeigen wenn longshot und es gibt nur einen nachbarn
# db_restore/db_lock -> kann ewig dauern -> adagio
# tool: messages: collect + mailsend before reboot + in longshot: show distance + e.g. 'no_longshot' ($HOSTNAME) in groups
# tarball-pmu: add possibility to download and install into ramdisc a .autorun (even if flash is full)
# ralf: add default-password for weblogin + autoenable VTUN
# longshot: test also HT40, when signal is better then 60dBm?
# longshot: test a row: e.g. rehungen: 237 -> 254 -> viel daten, forward aus
# longshot: test >5mb e.g. 50? - when maint_window()?
# den nachbarn fragen: alles i.o.? -> dhcp-reanimate -> leonardo
# ipsystem: add IPV6/weimarnetz
# build: Small: disable station-mode? disable ap-mode? -> "CONFIG_PACKAGE_wpad-mini is not set"
# openwrt + kalua: rewrite: A=$(( A + 1 )) instead of A=$(( $A + 1 ))
# enhance syntax: '_wifi set apX 2ghz ssid ROAMING' - if X is set, then explicitely set the 2nd occurrence
# olsrd_build_tables() nicht alle permanent-eintraege bleiben, ab und zu auffrischen?
# nutzen?: /lib/netifd/dhcp.script wird alle 15-30mins mit renew+setup_interface() aufgerufen
# fix RRD
#### fix weekly report
# firmware: include default design (flags!)
# support for login = community (loginmask without username/pass) -> system.@weblogin[0].auth_credentials
# implement: look for new firmware? = write openwrt-revision into info.txt
# portability: replace all calls of: echo -en / echo -n -> dash-problem -> use printf = builtin
# only running service after crash: tweak script?: udhcpc -p /var/run/udhcpc-eth0.2.pid -s /lib/netifd/dhcp.script -f -t 0 -i eth0.2 -r 10.10.6.25 -C
# do ROADMAP.md
# support PRIO in weblogin_auth_message (e.g. spbansin)
# email/phone/etc. in db()
# resarch: ACKs are send with double mcast_rate? 12 -> 24
# start writing tests for all functions, which can be run an a router
  - prevent injection local vars into functions: write a test
# db_restore_from_server() move from VDS to db()
# handle tap0 in build_tables() also fixed arp?
# mv /etc/kalua to /lib/xxx? and rework rc.common?
# inet_unstable on inet_offer: temp. remove && restart
	olsrd.@Hna4[1]=Hna4
	olsrd.@Hna4[1].netaddr=0.0.0.0
	olsrd.@Hna4[1].netmask=0.0.0.0

# debug ulogd2-startup LOGEMU
# implement: _wifi get device ifname 2ghz_1st_ap?
# strip kalua_init: log/measure time in wrapper = cleaner
# style: http://www.softpanorama.org/Scripting/Shellorama/Control_structures/comparison_operators.shtml - "we recommended remove dollar sign from all variables in  double round bracket comparison construct"
# time wget -O /dev/null http://guetersloh.freifunk.net/testfile-10M.img
# remove mybuild.sh - e.g. scripts/diffconfig.sh
# only write those to /www/NETFILTER_AUTOADD, which are not there yet
# longshot: mrate -> lowest basic rate? MCS0 vs 6000 - maybe MCS2?
# no pingcheck/dns/inet-check during longshot_test()
# fix wifi dhcp, if 2.4ghz is radio1 (wlan -> wlanRADIO1)
# abmelden von ror-clients, wenn es keinen dhcp-lease gibt -> liste klein halten
# any failed inet-action raises error-counter for seems_stable() (and vice versa) - e.g. 'killing hard' for 'wget'
# fix ffmpeg-mini
# pingcheck-stats to everlog/Mail + remove pingstat
# _wifi longshot
  - enforces RRD
  - auto-pingcheck?
# ilm1: [ "$MAC" = 'f8:d0:ac:47:fc:94' ] && return 0
# ilm1: [ "$MAC" = '7c:dd:90:43:1a:4d' ] && return 0
# monitoring: check if nexthop can be an IP if it is special
# patch: syslog "uci commit"
# before shutdown, try to determine max_txpower for each phy*/channel
  - (iwinfo needed) and store this, so we can have e.g. uci set txpower=35% 
  - use 'iw phy phy0 set antenna_gain 11' for fighting againt reghack-patch (which always shows 30 dBm)
  - cat /sys/kernel/debug/ieee80211/phy1/power
# fix fail2ban for portfw (boltenhagendh)
# fix net_ping6() -c1 does not work
# speedtest: during monitoring: offload to own function/script
# speedtest: https://github.com/sivel/speedtest-cli
# xoai: mydesign
# EJBW: 10er Netz darf nicht ins verwaltungsnetz
# kernel: overcommit? https://lists.openwrt.org/pipermail/openwrt-devel/2014-September/028004.html
# GIT: remove empty files and unused functions + remove all special 'case $CONFIG_PROFILE in' -> function-graph
# make patchset for weimarnetz for each function
# wifi_speed() -> measure new neigh without asking cron.check_inet? and rename to _net nexthop_speed()?
# use ';' for separating vars in query_string instead of '&'
# detect route-change like pingchecker (refire every minute)
# detect missing cron-runs (last must not be older than 60 sec/uptime)
# ticket: procd startup-timeout?
# Sep 09 04:18:43 ' [up 533s 6123520 bytes free] /bin/sh [daemon.alert] system_reboot_safe() scheduling reboot - reason: 'wifi_watch_phy_restarts: no wifi clients, rebooting'
    # Tue Sep  9 04:19:13 CEST 2014 [OK] reboot reason: 'watchdog_disable'
# network: fewo: http://www.fewo-werbeagentur.de/images/phocagallery/ferienwohnung_logo_1000.jpg
# special_tweaks: leonardo-master
# solve: autoconnect/netfilter/wired neighs
# cgminer: usbreset 0403:6014 -> cgminer-api summary | fgrep '[MHS av] =>' | cut -d' ' -f7 | cut -d'.' -f1
# build: support for alien-repo (bernd)
# olsr: NatThreshold 0.5 -> olsrd.@olsrd[0].NatThreshold=0.5
# sanitizer hostname in kalua_loader
# apply_profile: immer hybrid und selectiv an/aus (dynamic config) -> adhoc = ap off; ap = adhoc off
# DB: when sending many mail, only backup once
# implement: show_path($IP) with all rx/tx-values / speed
# make sure, all radios are on (itze!)

# taskplanner: ohne sleep task alle X aufrufe ausfeuhren: /tmp/OLSR/ROUTE_COUNT -> cron.add_collected_userdata_into_db
# - calculate how often a task must be executed (e.g. every 42 mins)
# - and set marks in future: probe if these marks are reached -> execute and fetch next mark

# build: x86: laptop: echo "conservative" >/sys/devices/system/cpu/cpu0/cpufreq/scaling_governor 
# traffic_control_user_del: make sure wired devices are not deleted?
# who calls cron restart?
# QoS: fast cache for: _net speed gateway $IP <up|down> - can we simple 'change' speed of root-qdisc? achtung: tx muss nicht rx gateway sein!
# button-press: restart cron if needed
# button-press: diagnose senden wenn >5sec?
# SATA/hotplug:
# introduce ipsystem/THRUSTED_NET (fail2ban)
# sysupgrade cannot work, if full flash (moving S51* fails)
# activate/inactivate kmod: check for asterisk (*)
# generic_checker() lowercase must be local vars!
# check if we can use: $_ -> http://web.njit.edu/all_topics/Prog_Lang_Docs/html/ruby/variable.html
# build: http://wiki.openwrt.org/doc/howto/build
# why? [OK] first activity seen on dev wlan0 (0 packets) - marking
# support for HA (no nightly reboot) -> NAS (over_uptime + nightly reboot)
# maintain some packages: https://github.com/openwrt/packages/blob/master/CONTRIBUTING.md
# stop running cron/scripts during shutdown/STOP -> how to detect STOP?
# netfilter: user_add() mkdir /tmp/NETFILTER/USER/$mac - can be missed?
# build: usecase NAS: screen,samba-server,rtorrent,rsync,hdparm + hdidle + smart
#
# tc:
# http://lartc.org/howto/lartc.qdisc.filters.html
# http://lartc.org/howto/lartc.cookbook.ultimate-tc.html
# http://linux-ip.net/articles/hfsc.en/
# http://blog.plenz.com/2012-05/trying-the-codel-bufferbloat-solution-locally.html
# http://serverfault.com/questions/549755/how-can-i-limit-the-upload-download-bandwidth-on-my-centos-server
# https://gist.github.com/akrasic/7242498#file-limit-tc-sh
# default queue: mq: http://serverfault.com/questions/474230/linux-traffic-control-qdisc-mq
# http://linux.die.net/man/8/tc-prio
# http://mailman.ds9a.nl/pipermail/lartc/2003q3/009805.html
#
# make use of hwclock if available: set regulary and read during bootup -> https://www.ibr.cs.tu-bs.de/users/thuerman/time/quick.html
# gen dmesg.boot earlier in startup -> testcase = NAS@home
# check DNS-chain router -> inetoffer?
# profiling for boltenhagendh: which function is called most often / causes load
# rewrite all direct/local calls to cgi-bin-sql -> move into functions
# DNS-check in cgi-bin-sql? why?
# uci-switch for ignore high load ( 2 x cron.minu + 1 x scheduler_allow_run)
# audioplayer: iptables -I OUTPUT -p tcp --dport 80 (port from stream) and check if it raises, if not rekick
# when writing to /www (flash), always check if it fails: cron.check_switch is flapping when flash is full
# cgi-bin-myinfo.sh:
# - ping to each HOP which is on traceroute
# - auto speedtest
# apply_profile: network/node = same? -> remember values: olsrd: LinkQualityMult
# intercept SSL? Loginpage: https://code.google.com/p/chromium/issues/detail?id=402071#c17
# mark "sysupgrade"-reason in crashreboot
# autorenew of https-cert
# adblock 1.1.0.0/20 -> 127.0.53.53? https://www.icann.org/news/announcement-2-2014-08-01-en
# switch:
# - wenn auf halfduplex abfaellt: reboot?
# - generell: warten ob default-route wegfaellt oder route-count dramatisch sinkt -> reboot
# - in case of an switch error, try: swconfig dev switch0 set apply 1
# maybe use: 'make image PROFILE=NBG6716'
# dhcp-script runs parallel - maybe offload via hotplug-event?
# sed-load boltenhagendh
#  - wer benutzt cgi-bin-sql.sh?
# backup-problem loesen (boltenhagendh): 4320 -> 432 8-)

# NETFILTER_AUTOADD: remove old entries, (wired!)
# db_backup() when it fails we have temp-files: /tmp/DB/USER/device/rows[a-zA-Z0-9]*
# audioplayer: mkfifo /dev/myfifo -> https://packages.debian.org/de/source/squeeze/buffer
#  commandB < /dev/myfifo &
#   commandA > /dev/myfifo
#    rm myfifo
# support ping-monitoring via '/bin/netmsg' (also for internal monitoring)
#  - iptables --insert INPUT -p udp --dport 53 \
#     -m string --from 40 --to 51 --algo bm --hex-string '|04706b7473046173696100|' \
#     -j DROP -m comment --comment "DROP DNS Q pkts.asia"
# or: http://www.stearns.org/doc/iptables-u32.current.html
#
# check: http://wiki.openwrt.org/doc/techref/ubus#access.to.ubus.over.http
# _netfilter_portforwarding_start() -> convert to userscript: /etc/firewall.user -> /tmp/firewall.user
# pass fuer sms-versenden (keine ip -> ejbw)
# immer ping (auf gateway? authserver? nexthop?) nach 'scheduler' wenn noch zeit bis zur naechsten runde, statistik fuehren
# howto: ("which neighbour relation seems important?") count traffic which comes FROM or goes TO a neigh (but src or dst is far away)
# db in eigener tmpfs ODER usb-stick
# check path: db_backup_error -> locked -> check()?
# igmp-snooping: https://dev.openwrt.org/ticket/13097#comment:2
# /usr/sbin/cron.add_collected_userdata_into_db: line 139: can't create /tmp/DB/USER/device/stats: nonexistent directory
# abstraction: is_enabled && ... (fuer init-skripte)
# olsr-slave: slave startet neu und master hat sein olsr aus: was dann? -> master muss schauen, ob sein slave noch da ist -> wenn slave, dann?
# switch: buffalo WHR54HP
# switch: 741nd v2
# use the cool wifi-helpers in override() for e.g. _wifi_change_essid_ap()
# wget returncode = 1 on http status code 201 :: https://dev.openwrt.org/ticket/16885 -> testcase registrator
# private monitoring on every node during build_tables() = passiv monitoring (lookout HNA's/nodes/mid's)
# fix report_weekly
# log() use special var instead of $0 maybe introduce include()? - see sourcing of /usr/sbin/cron.registrator_client.sh
# tc: prio for OLSR
  - http://mailman.ds9a.nl/pipermail/lartc/2006q1/017871.html
  - http://ff-firmware.cvs.sourceforge.net/viewvc/ff-firmware/ff-devel/freifunk-olsrd/etc/init.d/S90olsr-prio?revision=1.6&view=markup
  - https://github.com/weimarnetz/weimarnetz/issues/34
### remove old /tmp/vds*
# checkout wifi-greenfield: https://dev.openwrt.org/ticket/16667#comment:6 https://dev.openwrt.org/ticket/16667#comment:8
# implement PPP-Max-Payload: https://dev.openwrt.org/ticket/16805 + https://forum.openwrt.org/viewtopic.php?id=51326
# remove db_lock when crond-lock/scheduler-log is removed
# OLSR-prio: https://github.com/zioproto/fairvpn/wiki/ShapingNotes
# einspeiser muss propagieren, das internet ausgefallen ist (satama!)
# beacon-rate bei longshot-adhoc?
# wenn bei user_add() festgestellt wird, mac gibt es schon: abmelden und neu anmelden. wenn IP = 169.254.216.113 -> sonderbehandlung
# usb-power off: 703n: echo 0 >/sys/class/gpio/gpio8/value
# set custom X-HTTP header for weblogin output
# alle 'case $CONFIG_PROFILE in' nach override_uci_vars

# solve dhcp-with-many-IP's to the same client-issue: http://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2011q2/005041.html
root@EG-steinmetzBuero:~ ip neigh | grep 00:23:8b:a5:18:dc
fe80::b17f:c521:1487:d871 dev eth0.1 lladdr 00:23:8b:a5:18:dc STALE
10.63.11.113 dev eth0.1 lladdr 00:23:8b:a5:18:dc STALE
10.63.11.112 dev eth0.1 lladdr 00:23:8b:a5:18:dc STALE
10.63.11.111 dev eth0.1 lladdr 00:23:8b:a5:18:dc STALE
169.254.216.113 dev eth0.1 lladdr 00:23:8b:a5:18:dc STALE

#
#
# olsr-status: show SNR for missing nodes
# remove HT40- or HT40+ calls
# refresh hotplug_without_exit-patches
# rework khubd-blocked-detector (why?)
# how to avoid: user_add() when user is a router? -> olsr_fixed_arp?
# everywhere: use 'grep -m1' instead of 'grep bla | head -n1' (check which commit enabled this option)
# enforce wifi-speedtest via linklocal IPv6 = forbid route switching -> needs fixed wget
# switch: check all supported models and remove legacy code
# lizst28: when etx_ff, remove 'Mode ether/mesh'
# status.sh: raus/rein: broadcast/echter datenverkehr trennen
# is it portable? echo $((try++))
# loader: can we use $@ = quoted $* instead of $1 $2 $n?
# nightly_reboot wenn eigentlich overup?
# include sorttable.js -> google_closure -> CrunchMe = http://www.bitsnbites.eu/?p=112 -> pngout = http://advsys.net/ken/utils.htm -> 2.8k
# status.sh: ip->32bit int for sorting
# status.sh: highlight each 2nd row with CSS and same for numbering first row
### report to sql: >X gig-users
### satama/fparkssee/marinapark: SSID=wartung, wenn einpseiser fehlt
### sehr oft index_gen?
# build: support for Davicom DM9601 USB Ethernet
# - 0fe6:9700 Kontron (Industrial Computer Source / ICS Advent) DM9601 Fast Ethernet Adapter
# = dm9601,cdc_ether + usbnet
# = DEFAULT_kmod-usb-net-dm9601-ether
### - switch: kueche/UFO: TP-LINK TL-WR841N/ND v7
# - check each function during scheduler_run/debug-mode with: set | grep ^[a-z]
### watch coredump: only restart daemons ONCE + show all dumps first
# usb2ethernet: LogiLink: 9710:7830 MosChip Semiconductor MCS7830 10/100 Mbps Ethernet adapter
# rb532: ath5k: http://patchwork.linux-mips.org/patch/4087/
# 148f:3070 Ralink Technology, Corp. RT2870/RT3070 Wireless Adapter -> dodge/garage = Intellinet wireless 150N usb-adapter rev. 3.04
###### instead of use 'test -e ' -> ls -1 "/var/www/networks/gnm/settings/"*.jpg 2>/dev/null >/dev/null
### join: _net_ip_reachable + _netfilter_reachable()
### via netcat: https://github.com/weimarnetz/openwifimap-api/blob/master/API.md
### schoeneck: etiketten/format
### generic: max,min,avg,leaving_border and use for: mcast-rate, routes-counter etc.
# remove all calls of 'exit'
# kalua-parser fails if:  grep ' # mac: ' $file (do not cut off '#' when not a comment)
# LANADR is NOT always there, e.g. meshcube + no wire -> error during deepcheck of webserver -> use new var 'force_link' from r40456
  - uci set network.lan.force_link=1
# build-server: export HOSTNAME
# - coredump: udhcpc -> ifup wan, when dhcp
# - firmware-update: do not delete /tmp/.uci
# - no uci_commit during new_user()@GUI
# monitoring: show red if pubkey not thrusted
### iface_ifdown() cron hangs, restarting 3mins before reboot
### $count in coredump wird falsch gezaehlt
### add olsr-watchdog-plugin to cron.minutely?
# - userdb: einmaltickets -> automatisches eintragen der mac
# - new dyndns or: '$IP bwireless.mooo.com' in '/etc/local.hosts' + update -> eigener dyndns-dienst: haus12.spbansin.intercity-vpn.de
# - switch_show() defekter switch node12? -> retry nur wenn es schonmal ging
# - ueberlange moni-meldungen mit minimal-heartbeat abschliessen oder keine OK speichern
# - olsr-control counter: do i send out myself?
# - count traffic in same network? e.g. NAS<->MEDION
### - amalienhof: strange situation2: olsr-nexthop != routing-table nexthop: 10.10.80.1/172.20.1.1
### - amalienhof: wireless.@wifi-iface[0].encryption=psk2 wireless.@wifi-iface[0].key=31122014
### - move hotplug-wan-security to netfilter
### - move IP/WAN-stuff into private /tmp/apply_
### - /tmp/user_vdsOK - only accept if not older than X? (against nodes with long uptime)
# - http://twitter.com/#!/Rehungen ?
# - make usage of 'connlimit'?
# - 'pidof dnsmasq' shows also pid of 'fakedns'
# - make sure rrd-update makes no spikes?
### - ejbw: fremd-sms nicht mit "WLAN-SYSTEM" verschicken
# - cupandcoffee: sms-mode aktivieren?
### - Feb 25 04:10:11 ' [up 86191s 3776512 bytes free] /etc/dhcp-script.d/10dhcpscript [daemon.alert] watch_cron() cron died, restarting
# - rework 4900er lan-MAC: https://dev.openwrt.org/ticket/14714#comment:5
### - GeraetX ping der reihenfolge nach immer wieder alle durch, fuer _schnelleres_ monitoring.
      - extra cronjob
      - direkte meldung an monitoring-server
      - evtl. auch ICMP-filewall-dings dann muss es kein extra cronjob sein sondern man schaut nur was ausbleibt.
      - am besten das geraet, wo auch sql/ticket-meldungen hingehen? -> anlegen der ICMP-regeln nach IP
      - Ziel: Monitoring soll schneller Rot zeigen
      - jeder node muss notfallanweisung bereitstellen: e.g. nachbar muss sich mit IP xy verbinden und Z ausfuehren (e.g. wget)
      - was ist wenn MONITORING-node neustartet? Anweisungs/IP-liste muss erhalten bleiben
      - aus abhängigkeitsliste kann auch gleich updateliste erstellt werden.
#
# apply_profile: ejbw50/master: allow WAN-olsr
# apply_profile: community.XY
#
# - ibfleesensee:
#   - tweak dnsmasq-hotplug
#   - disable kmodules: ip6tables + ppp + ulog + usbcommon/core + ath9k
#   - vlan-doku: z111=105, z206=198:ZG3/7, z315=125:EG3/17, z411=220:ZG1/11, z512=152:2OG1/12, z442=150, z542=183
# - reboot_nightly und inet tot? -> speichern und gleich wieder SSID wechseln nach boot
### nexthop regelmaessig bauen/minimoni (fuer batman auch?)
### monitoring: exit wegen [ -z $WIFIDEV ] ?
# - new_build:
#   - add info.txt what means e.g. Standard
#   - add info.txt about buildtime for hole build + each target?
# - shaping: $i + $j -> classid_down/up
# - do not send 'realcrash' to master, if 'watchdog' was the reason
# - reboot/crash ankuendigen durch netmsg $LAN - damit umliegende keinen 'switch_error' werfen
# - crashreboot for: scheduling reboot - reason: 'wifi_watch_phy_restarts: no wifi clients, rebooting'
# - inet_seems_stable() check real internet from time to time too
# - pingplotter in cron.minutely or RRD
#   - DSLer: ping ins internet
#   - ansonsten "ping -c1" auf nexthop. wenn latenz hoch, ping -c 10 + durchschnitt
# - monitoring: rebootknopf?
# - after DMA erro: cat /sys/kernel/debug/ieee80211/phy*/ath9k/interrupt - https://dev.openwrt.org/ticket/11862#comment:187
# - disable 5ghz on non-batman nodes, till we fix ip-system/dhcp
#
# - watch_lowmem_freemem() if simplemesh, keep everything up till hna-slave was there
# - lowmem: only end netifd/ubus after recent uptime/when hna4-slave-question was
#
# - enable wlan-dhcp + enable on correct interface e.g. wlanRADIO1 (former batman-node)
# - count 'events' and show this number in monitoring (e.g. all 'alerts'?)
# - global VAR for $STORAGE_DIR on flash, e.g. STORAGE_DIR='/www'
# - own history for reboot + switch
# - update_pmu/brcm47xx?
# - check all rcS-tasks for 15sec length -> $SCHEDULER  and remove anti-hang-hacks with rTODAY
# - portfw does not go through shaping?
# - mail_resend: nen haufen leichen... readable? -> r99 -> netfilter copy over own pub-ip
# - webcam: motion: snapshot always 60 sec, but upload do not use if there was an event and when no event, adjust according to event-action
# - webcam: store event.log + upload
# - server/monitoring: support for 'autohide' (lisztwe)
# - liszt28: echo 2 >/sys/kernel/debug/mips/unaligned_action
# - splash: check error-code: 511?
# - batman: raise MTU on adhoc - 1560?
# - batman-gwl: dynamic lease, renew every X mins -> dnsmasq reload
# - inet_seems_stable auf inet_offer schlaegt X mal fehl, irgendwie nodes in wartungsmodus versetzen
# - http/ssl-certs: gueltigkeit! -> immer neu generieren?
# - warum kann es mehrere scp-prozesse geben?
# - get shaping/speed from ticket
# - webcam: better sort: img_889.ffmpeg.jpg -> img_88.ffmpeg.jpg
# - if planned overload: fire watch_monitoring()
# - boltenhagendh: stopwatch_stop(): task 'index_gen' lasts 5677.82 seconds (1h 34min 37sec) - wirklich 5 uhr starten? -> besser 2uhr
# - lockfile-remove: show last job which was invoked
# - update_pmu: no_space_left -> watch_flash + prozentanzeige des verlaufs + alphabetische reihenfolge?
# - kein SCP wenn schon scp laeuft/haengt
# - r2: empaengt noch, aber sendet nicht mehr. olsr-check. irgendwie automatisch -> groesse der routentabelle loggen
# - rrd_show wirklich alle 15min?
# - solve scheduler prob: A="logger 'hallo'"; $A -> the call will be: logger "'hallo'"
# - https://bbs.archlinux.org/viewtopic.php?pid=1168667 -> nf_conntrack: automatic helper assignment is deprecated and it will be removed soon.
# - crashdump: disable on lowmem-devices -> otherwise oom happens during crashdump-output
# - crashdump: store in "small" tmpfs, otherwise simultanious crashs can eat up too much mem
# - log pppoe-con losts/downtime via dyndns-hotplug
# - kein firmware-update wenn vor ca. 24h ein neustart war (zeitschaltuhr)
# - dhcp-old -> SCHEDULER
# - taskplanner: do not run every minute, only when low load but build a todo-time-file
# - batman: check if dhcp-users are logged in, if not: splash
# - detect ubusd pid-change
# - wenn 192.168.0.61 -> 192.168.222.1 -> 192.168.76.1 -> olsr-netz, dann nat oder HNA
# - taskplanner: die meisten entscheidungen koennen bei cron.startup getroffen werden
# - taskplanner: include into cron-ram-copy + kein loader mehr noetig
# - 1043nd: watchdog: https://dev.openwrt.org/ticket/12121
# - ping IC: remeber last and only ping once round-robin + use: -W 3?
# - remove 'sleep 30' from netfilter-startup -> hotplug
# - hangs: rmmod xt_tcpudp + rmmod xt_CT + iptable_raw + ipv6
# - WTF: warn netifd: You have delegated IPv6-prefixes but haven't assigned them to any interface. Did you forget to set option ip6assign on your lan-interfaces?
# - do something against stack-corruption/overflow:
#   - http://stackoverflow.com/questions/11861762/stack-corruption-in-c
#   - http://stackoverflow.com/questions/1258550/why-should-you-use-strncpy-instead-of-strcpy
# - logger: send ALL alerts to central server, e.g. crashs
# - cron = procd-service
# - scp_do()
# - coredump: autoupload/remove
# - reboot_safe() fix REASON and fix autorun-call
# - db_backup() calc size needed?
# - cron.check_inet_gw: do not accept "# ignore localhost", when not inet-offer
# - really disable batman if not needed (remove aliases too + changed macs)
# - askconsole: activate when not LOWMEM
# - pmu() too often?
# - check: endlich insmod mit parametern?
# - monitoring: show 'error watch_dns_resolution' -> IFA126
# - schoeneck: 126 = '3e:75:11:b1:02:61'?
#   root@HausA-KellerZimmerEDV:~ batctl tr 192.168.126.1
#   traceroute to 192.168.126.1 (3e:75:11:b1:02:61), 50 hops max, 20 byte packets
# - mailstash = alert?
# - zram via hotplug?: Fri Jan  3 11:34:11 UTC 2014 1: block ACTION: add DEVPATH: /devices/virtual/block/zram0 INTERFACE:  DEVICE:
# - hotplug: cron running?: simple check if cron.minutely was active?
#   - pidof S51crond_fff+  (can hang)
#   - in /sbin/hotplug-call:
#     - echo "$(date) 1: $1 ACTION: $ACTION DEVPATH: $DEVPATH INTERFACE: $INTERFACE DEVICE: $DEVICE" >/dev/console
#     - echo "$(date) 1: $1 ACTION: $ACTION DEVPATH: $DEVPATH INTERFACE: $INTERFACE DEVICE: $DEVICE" >>/tmp/HOTPLUG
#   - in /lib/netifd/dhcpv6.script
#     - echo "$(date) 1: $1 2: $2 3: $3" >>/tmp/LOG
#   - dyndns: ACTION=ifup INTERFACE=wan DEVICE=pppoe-wan $1 = 'iface'
# wget-loop firmware: _watch pppoe/dns in each cycle
#
#
# make use of: ubus call network.device status (we have now: ubus call network.interface.lan status)
# - Link auf interne Ticket-DB vom Rezeptionsrechner: portfw
# batctl trace -> to each laptop from master during assoc
#
# build: all kalua-tweaks via subcall
# DIR300: swconfig eth0: 4 gap 3 2 1 0
# dnsmasq: force interface: DNSMASQ_INTERFACE is wrong on 222: lan -> wlan1-1
# batman: BLA - only activate when needed, it makes extra traffic
# marinapark: HNA/MP-dsler: missing? -> wartungsmodus
# make use of moni-wiredneighs for sorting (grouping real partners)
# radioX disabled? name SSID = off
# profiling for each function via switch?
# speedtest upload via backquestion
# _log view 2h
# viele reboots? -> disable wireless at bootup
# detect bitcoind-traffic
# no internet? bit firmware-upgrade needs hash-download, even when /tmp/fw exists
# OLSR-LAN-strange: 	iptables -I INPUT -p udp --dport 698 -i $LANDEV ! -s $LANADR
#			iptables -nxvL INPUT;sleep 60;iptables -nxvL INPUT
#			-> strange = e.g.: 37 ... 22 ... 20 packets/min
#			-> good =    e.g.: 350 ... 340 ... 353 packets/min	# hotello-B01
#
# build:
# bastian: kalua/openwrt-build/build.sh: apply_symbol() ERROR during 'git am'
# previous rebase directory /home/bastian/openwrt/.git/rebase-apply still exists but mbox given.
# laptops: batctl transglobal | while read line; do set -- $line; echo $2; done | sort -u | wc -l
# tool: show traffic/tc from a single mac
# make mysleep() with internal command : -> use it when critical

# teredo? http://www.heise.de/newsticker/meldung/AVM-aktualisiert-Fritz-Box-7490-Firmware-kleiner-Rueckschritt-inbegriffen-2060590.html
# -> miredo!

# idee: youtube ueber tunnel:
# https://forum.openwrt.org/viewtopic.php?pid=207497#p207497


# dyndns:
# /etc/hotplug.d/iface/99-ifup-wan
# ACTION=ifup + INTERFACE=wan ? -> dyndns

# Tue Dec  3 10:04:06 2013 daemon.notice netifd: cfg114d8f (25410): ./batadv.sh: eval: line 1: can't create /sys/class/net/pppoe-wan/batman_adv/mesh_iface: nonexistent directory
# -> no batman-WAN, if pppoe or DHCP

# sleep for reboots with real builtins?
# http://stackoverflow.com/questions/3224878/what-is-the-purpose-of-the-colon-gnu-bash-builtin

# idee: vermeiden von neustart/switch_check: vorher abmelden bei nachbarn


# idee:
# opkg install kmod-ipt-filter iptables-mod-filter
# iptables -A INPUT   -p udp --dport 53 -m string --algo bm --string "facebook.com"


# ping6 in busybox lack '-L' so it returns loopback: ping6 -c 1 ff02::1%${LANDEV:-eth0}
# also: -p payload: http://superuser.com/questions/569445/which-ping-sends-icmp-echo-as-payload
# timestamp: http://sd.wareonearth.com/~phil/net/ping/

# install htop?

# traffic erst ab X mb shapen: traffic_control_autoapply_speedsuggest()

# iptables -I FORWARD -m ttl --ttl-eq 1

# cgminer: rrd: cgminer-api stats | grep -i temp -> temp1 + temp2 + Vcc1 + Vcc2 + Vmain + Speed + HW-errors

# _log it Ausfall daemon sms "J4-Lueftungskeller-T11 (auf Serverschrank) neustarten"

# research: http://hack-it.org/index.php?title=Mdk3
# MDK is a proof-of-concept tool to exploit common IEEE 802.11 protocol weaknesses.


# disable/enable kmodules, if not needed / needed:
# - ppp
# - wifi
# - batman
# - netfilter

# liszt28:
# check if on *_ap all wifi-clients are in 'batctl translocal'


# 4900er: flash_size incorrect


# new build:
# timer 'prepare'
# timer 'make'

# shell: for octet in ${mac//[\.:-]/ }
# shell: octet="${octet:0:2} ${octet:2:2}"

# idee:
# failsafe via net aktivieren:
# patch failsafe: ping 6.6.6.6? -> ja + meldung
# patch: package/base-files/files/lib/preinit/30_failsafe_wait


# pruefen:
# gegen netrate_ratelimit:
# https://lists.openwrt.org/pipermail/openwrt-devel/2013-November/022559.html
# net.ipv4.tcp_max_syn_backlog = 2048                                                                                                                          # net.ipv4.tcp_synack_retries = 3    

# tuberlin:
# config httpsproxy                 
#        option enabled 1       
#        option ipaddr  auto     # auto = first LAN-DHCP-lease | <ipaddress> OR via FORM_DATA
# cookie support?

# apply_profile:
# - ejbw: WAN+LAN-Olsr auf Einspeiser
# - ejbw: RF bssid?


# pruefen: https://github.com/schuza/openvswitch + http://openvswitch.org/

# konzept: pingtest/watchdog fuer netio230b selber implementieren und per netcat port-reset ausloesen
# - gnm + frenzel + schoeneck
# http://wiki.linuxonlinehelp.de/index.php/Netio-230b
# - ping auf station X, raise counter till Y
# - action = netcat ...
# - 3 werte:
# geht nur, wenn 2 geraete an steckdose sind...


# liszt28: 5ghz: mcast = 1.000 ???

# problem loesen das im monitoring manchmal richtige und manchmal batman-mac steht

# detect non-working scp to monitoring-server and show in monitoring + do not try again?

# interesting batman/dnsmasq-trick: http://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2013q4/007750.html

# http://stackoverflow.com/questions/15372011/configuring-arp-age-timeout
# make use of '/proc/sys/net/ipv4/neigh/eth0.2/gc_stale_time' ?

# LOWMEM: erst in S95done wird '/tmp/CRON_IS_CAREFUL' sichtbar gemacht

# apply_profile.code kann auf /tmp/loader aufbauen

# use ulogd2 / ulogd_output_OPRINT.sh : http://kangran.su/~nnz/pub/nf-doc/ulogd2/i
# or ulogd_output_SQLITE3.so

# LOWMEM:
# - no dhcp on WAN, when apply_profile exists
# - no ntp(d) , when apply_profile exists / /etc/init.d/sysntpd
# - no sleep 300 in S70prep , when apply_profile exists
# - no S69 when apply_profile exists
# - no 6relayd , when apply_profile exists
# - cron.konzept ueberdenken
# - webserver beenden/dropbear starten wenn 'fresh' ohne profile-definitionen
# - wenn nicht fresh, wifi down
# - 15min-cronjob: uhttpd stop

# fix missing "wan/inet-offer" mode in monitoring

# maybe: monitoring: send /proc/net/dev -> rx/tx bytes/packets -> rewrite wifi_tx_and_rx()
# maybe: batman-trace/nextIF: debug-output, e.g. debug="LAN= WAN=$WANDEV was: $nexthop-dev"

# db: nach aufräumen 'eval' test jeder zeile

# rewrite cron-startup

# reverse_ssh-tunnel: make it forceable even without inet-offer (b01/4)

# ubus call network.device status '{ "name": "anygw" }'

# audioplayer: check somehow if '/dev/dsp' is used (hanging wget/madplay)

# build: support for including all mypackages* for specific network

# why 2 empty lines at top of cron.minutely?

# firmware_wget() -> respect bigbrother/usbaudio

# netfilter: check_deps()

# lock() function: + testcase
# better locking: http://wiki.bash-hackers.org/howto/mutex
# mkdir /var/lock/mytask || exit 1
# rm -R /var/lock/mytask
# http://www.cyberciti.biz/tips/howto-keep-file-safe-from-overwriting.html
# http://mywiki.wooledge.org/BashFAQ/045
# http://unix.stackexchange.com/questions/22044/correct-locking-in-shell-scripts

# rrd: ping/latency to nexthop:
# - ping -c 60 $IP
# - 60 packets transmitted, 60 packets received, 0% packet loss
# - round-trip min/avg/max = 2.314/27.849/390.571 ms
# draw: loss/avg/max/metric?

# rrd: forks (each time cron.minutely is called $$)
# rrd: respect phy/phy1/phy2 in one graph - just "change" nulllinie + opaque colors?
# rrd: gateway-node: fat line, change color for each GW, show GWs in legend
# rrd: include add() into CRON_IS_CAREFUL and use the rest via kalua
# rrd: add total-counters: CDEF:ds0total=ds0,$(uptime_sec),*    +    GPRINT:ds0total:AVERAGE:"Total\:%lf"
# rrd: repair no_forward
# rrd: wc -l /tmp/OLSR/ROUTING_TABLE_MAIN *** oder *** batctl originators | wc -l
# rrd: longshot-faker/enforcer for nexthop (rehungen_feld)
# rrd: load: when >1.00 ONLY rrd_load, all other values do not set/collect (um wirklich LOAD zu sehen)
# rrd: longshot/all-mode: show in legend and show rx/tx OR wifi2lan OR lan2lan
# rrd:
#   - bei setup() datei X anlegen.
#   - die ersten 30 mal '#' nach X appenden.
#   - solange X existiert wird default_gw bestimmt.
#   - wenn defgw = wifi, dann 'MAC' bestimmen
#   - von dieser MAC rx/tx plotten
#   - wenn sich MAC nicht aendert, wird /tmp/RRD_MAC geschrieben (und weiterhin genommen)
# longshot-detector: only when first 30mins = longshot -> maybe if wifi-gateway = fix? (f36dach -> schreibtisch)


# USERDB-copy download von node der es nicht hat? -> kein OK, aber was anderes...

# hohe load? rm /tmp/USERDB*.gz ? oder einfach loeschen wenn es ne weile nicht angefasst wurde

# test: b0rken inet -> change essid in batman-mode: it works!? -> deactivate reboot

# reboot-detector: in own file /www/REBOOTS ? und bei year = 1970 beim ersten ntp in diesem file korrigieren

# pubssh.ipk -> auf batman ip's rein 192.168.x.1

# beim abliefern von cron.add-user... kommandos uebergeben? bequemes ausfuehren von befehlen auf allen routern?

# debug high load on r99: http://stackoverflow.com/questions/10846747/origin-of-a-kworker-thread

# git grep reboot_safe -> ordentliche reasons eintragen

# cron: crashreboot.file jede minute schreiben und ausfuehren mit 'reason=bla; . /tmp/CRASHREBOOT'

# check: http://rooter.kyberian.net/tag/adhoc/

# USERDB: support for shorthash (first 8 bytes?): db_hash() echo -n "bla" | md5sum | cut -b1-8

# check: shaper: http://openwrt.pl/doku.php/zastosowania:pasmo

# mail: ticket-tar: besserer name + nicht in /tmp

# high-load? wifi down! -> immernoch? reboot, sonst wifi up

# speedtest/testdownload zu jedem neuen gateway

# die 3 haeufigsten Gateways im monitoring zeigen (prozentualer anteil)

# patch: procd: show module-loading on /dev/console
# patch: procd: minicron

# ejbw: 100: lan_masq needed?

# instead grep JSON: . /usr/share/libubox/jshn.sh; json_load "$(devstatus $WANDEV)"; json_get_var var1 speed; echo $var1

# add macvlan via netifd: http://nbd.name/gitweb.cgi?p=luci2/netifd.git;a=commitdiff;h=5dd87fd8ad3a42c71d90a8fecc893af973e552bf;hp=9585227f1141d9da5a3186df5e10c4521e65083e


# debug in cron.minutley:
# high load? maye loop for more console output?

# build a kernel with 'CONFIG_PERF_EVENTS=y' and use 'perf top'

# bat-tr: node(weblogin_authserver)->192.168.$node.1

# USERDB-copy: from nexthop

# scp: test auf monitoring-server bei _watch_random_node_id()/registrator?

# pruefen:
# root@liszt28-hybrid--222:~ _net ip2dev 192.168.222.61
# br-mybridge
# root@liszt28-hybrid--222:~ ip n|fgrep 192.168.222.61
# 192.168.222.61 dev br-mybridge lladdr 00:21:6a:32:7c:1c PERMANENT
# 192.168.222.61 dev gateway0 lladdr 00:21:6a:32:7c:1c PERMANENT



# cisco-esque

# memtest:
# keine pruefung, wenn crash - ausser bei speziellem crash: nur welcher? (sysrq wird auch bei ALERT benutzt/gebraucht)
# -> "neightly_reboot_crash"
# ungeplanter reboot? -> kein netfilter (ausser NAT wenn inet_offer)

# find a way to check for patched regdb, maybe klog?
# see: apply_profile.code

# check:
# monitors the netfilter conntrack table to help tune the max limit one needs to set:
# https://github.com/QueuingKoala/wrt-nflog
# https://github.com/QueuingKoala/wrt-iptables

# batman: revert change for 'batctl if':
# scp root@intercity-vpn.de:/var/www/files/openwrt/0001-batman-adv-avoid-openwrt_metadata_stripping feeds/routing/batman-adv/patches
# eigentlich:
# cd feeds/routing
# git revert a8e21bf882e1815023b224081843248030f1ad18


# only signal dnsmasq, if something relevant has changed

# git checkout -b feature_abc

# random:
# dd if=/dev/urandom count=1 2> /dev/null | md5sum
# grep -m1 -ao '[0-9]' /dev/urandom
# grep -m1 -ao '[0-1][0-2][0-9]' /dev/urandom

# wificheck: rrd
# wificheck: border muss abhängig sein von avg. bei 20 frames/sec sind 50% was anderes als bei 200 f/s
# wificheck: avg_p_change > border? ...ping 1 or 2 neighs, of not possible: wifi_restart?
# wificheck: max und min festhalten

# wget() convert pause = pause between no data is transfered?

# parse version2date from: https://www.kernel.org/pub/linux/kernel/v3.x/
# http://landley.net/writing/git-bisect-howto.html


# ticketmails: hinweis auf NICHT antworten und ReplyTo: correct setzen?

# URL_PATCH="http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/patch/?id=9c9b415c50bc298ac61412dff856eae2f54889ee"
# URL_PATCH="http://www.intercity-vpn.de/files/openwrt/memtest.patch"
# wget -O target/linux/ar71xx/patches-3.10/$NAME.patch
# make V=99 target/linux/{clean,compile}; make

# olsr-packets on LAN, but no neigh? restart daemon

# rrd: better way for check: longshot? -> if not, hide line

# /www/mybestneigh anlegen und uhrzeit von dort stellen
# wenn reboot NICHT geplant war, logging (kein crash, kein nightly reboot, kein safe_reboot)
# wenn reboot NICHT geplant war: netfilter off?

# reserving runtime for longrunning tasks must include a max (count down)

# ssh-key.ipk
# optimize
# add batman-ips

# batman-adv:
# parse "station dump" and "batctl o" for neigh-list and gateway...
# nexthop?

# monitoring/doku: energieverbrauch errechnen?

# batman/openwrt-fix (module-optimization)

# add wifi and ethernet-performance
# http://wiki.openwrt.org/doc/howto/performance


# mkmime:
CONFIG_BUSYBOX_CONFIG_MAKEMIME=y
CONFIG_BUSYBOX_CONFIG_FEATURE_MIME_CHARSET="n"


# support for http://wireless.kernel.org/en/users/Documentation/acs

# batman: gateway muss immer selber addresse sein, aber es muss eine art metric geben wie die gleiche addresse NOCH liegt?
# also: was passiert bei reboot: es soll weitergehen. das geht nur wenn GW auch erreichbar ist...

# automatically collect bootloader-hashs of 1043nd

# screen: backlog: safe scrollbackbuffer to file: CTRL-A : hardcopy -h <filename>
# screen: backlog: raise scrollbackbuffer size:   CTRL-A : scrollback 10000 <enter>

# memtest:
# http://lkml.indiana.edu/hypermail/linux/kernel/1211.1/00711.html
# https://lkml.org/lkml/2012/11/9/129
#
# memtest early clock:
# http://lists.linaro.org/pipermail/linaro-dev/2013-August/016542.html
# http://lwn.net/Articles/460432/

# HTB: quantum of class 10001 is big. Consider r2q change.
# http://www.linksysinfo.org/index.php?threads/tomato-mod-1-20-8000.26621/page-3#post-125507

# network.mybridge.netmask_dhcpcalc -> muss zu dhcp

# update-reihenfolge anhand hopcount festlegen

# cupandcoffee: profile anlegen / flashen

# use wifi-watchdog:
# /sys/kernel/debug/ieee80211/phy0/statistics/multicast_received_frame_count

# If you are running out of memory (which I suspect you are) the following 3 lines in /etc/sysctl.conf will probably help to prevent that.
# vm.vfs_cache_pressure=1000
# vm.min_free_kbytes=4099
# vm.swappiness=0


# lowmem: nocron_during_client_action: at least send minimal-monitoring
# maybe same abstraction like routers which needs "proof of work" (too much reboots)


# detect suddenly lost auf neighs:
# best would be: average olsr-packets/interval on each interface:
# log/action: if something goes crazy

root@HausA-Wintergarten-MESH:~ n
Table: Links
Local IP        Remote IP       Hyst.   LQ      NLQ     Cost
10.10.211.1     10.10.132.1     0.00    0.897   0.646   1.721   
10.10.211.1     10.10.234.1     0.00    1.000   0.948   1.054   
10.10.211.1     10.10.143.1     0.00    0.948   0.815   1.291   
10.10.211.1     10.10.138.1     0.00    0.901   0.952   1.163   
10.10.211.1     10.10.147.1     0.00    0.948   0.808   1.304   
10.10.211.1     10.10.153.1     0.00    0.854   0.815   1.434   
10.10.211.1     10.10.210.1     0.00    0.948   0.497   2.115   
10.10.211.1     10.10.157.1     0.00    0.765   0.866   1.509   
10.10.211.1     10.10.140.1     0.00    0.701   0.780   1.825   
10.10.211.1     10.10.136.1     0.00    0.736   0.862   1.571   
10.10.211.1     10.10.134.1     0.00    0.619   0.909   1.773   

root@HausA-Wintergarten-MESH:~ n
Table: Links
Local IP        Remote IP       Hyst.   LQ      NLQ     Cost
10.10.211.1     10.10.132.1     0.00    0.000   0.446   INFINITE
10.10.211.1     10.10.153.1     0.00    0.000   0.713   INFINITE
10.10.211.1     10.10.134.1     0.00    0.000   0.909   INFINITE
10.10.211.1     10.10.136.1     0.00    0.000   0.808   INFINITE
10.10.211.1     10.10.143.1     0.00    0.000   0.646   INFINITE
10.10.211.1     10.10.234.1     0.00    1.000   1.000   1.000
10.10.211.1     10.10.157.1     0.00    0.121   0.815   10.084
10.10.211.1     10.10.140.1     0.00    0.000   0.713   INFINITE
10.10.211.1     10.10.147.1     0.00    0.000   0.748   INFINITE
10.10.211.1     10.10.210.1     0.00    0.000   0.329   INFINITE
10.10.211.1     10.10.138.1     0.00    0.000   0.847   INFINITE
10.10.211.1     10.10.145.1     0.00    0.000   0.000   INFINITE

-> lots of 'ath: phy0: Failed to stop TX DMA'



# alle flash-schreiboperationen sperrbar machen: global var: $STORAGE = /www/storage or /tmp/storage

# scp: immer absichern gegen haenger -> cron.webcam

# proof of work: zielmarke 1h update, 2h...4h...12h...dann erst "wifi on"
# bei unerwartetem reboot: erneut
# CONFIG_PROGILE: *_ap + reboots > X -> disabled wifi 

# make target_install -> rebuild images from the customized filesystem
# http://downloads.openwrt.org/docs/buildroot-documentation.html#custom_targetfs

# mon-server: automatically write OFF/Restart-history fuer every router?

# UPGRADE:
# busybox: package/utils/busybox/Makefile -> 1.21.1 -> 795394f83903b5eec6567d51eebb417e

# _switch() own history-file

# [ -n "$BATMAN" ] && ..     # uci get batman-adv.bat0 -> mesh

# ap: limit to 8 devices?

# /www/NETFILTER_AUTOADD: function for writing to disc without stopping firewall
# /www/NETFILTER_AUTOADD: if in DB/mac: direct _netfilter user_add

# sometimes we loose config.tgz - why? also store it on nexthop/linklocal-ping6?

# dmesg: 'net_ratelimit: 115 callbacks suppressed'

# Friwo Tischnetzteil ErP 12V 1A

# build tables: always restart if 0

# git clone git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git linux-git

# find -name '*.sysupgrade.bin' | grep -v "\.r" | while read L; do md5sum "$L"; done

# detect silent hangs (on gateway?)
# track routes: ip r | wc -l
# no forwarded traffic for X minutes: reboot

# bssid_wellformed_fix fuer alle adhoc-netze

# early_boot: sometimes 'kalua_init' does not run -> override_uci does not work?

# reverse.ssh.tunnel: retry 25 times

# wifi/wartungsmodus -> inet_seems_stable

# force olsr-hna-slave: uci set olsrd.@olsrd[0].disabled=1

# button tickets: verfeinern, nur bei "autocreate" und vorrat zeigen

# mips/memtest:
# http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=272b9cad6e7a2f61b13cfcd7dde0010e02e9376e
# http://stackoverflow.com/questions/11640062/how-to-do-memory-test-on-arm-architecture-hardware-something-like-memtest86
# http://unix.stackexchange.com/questions/38887/how-can-i-test-the-ram-for-data-corruption-on-an-arm-based-system

# rrd: ping-time auf node im Netz

# check klog?: CPU 0 Unable to handle kernel paging request at virtual address --> Oops

# build: upload() if images small than 3.6mb, upload ONLY some additionally (e.g. WR-841ND)

# general class: _lock (auto unlock-trap?)


# B01 und allgemein: check incoming WIRED_OLSR: erste stunde = durchschnitt. jede minute pruefen.

# do not spam too much: loady_after_overload

# apply_profile: nanostationM: uci set wireless.@wifi-iface[0].antenna=mode - vertical|horizontal|external

# add a printk to the reghack.patch

# webcam: do not add files to movie when hash already was used before

# before reboot: scan -> file on flash with "mac: lastseen/signal"

# 1043er-Tickets:
# https://dev.openwrt.org/ticket/9654
# https://dev.openwrt.org/ticket/11862

# boltenhagendh: allow olsr-slave with huge OK-window (for not restarting olsr a lot of times)

# DB: index_gen for a single login should not force a full backup _now_ but later

#### incoming_wifi_activity spams log. only once for each changed framecounter

# keine defaultroute in ap-mode? go hybrid (nicht permanent) -> cool_wifi_makro

# rrd: better colors

# case "$( pidof scp )" in *" "*" "*" "*) echo ja;; esac

# rethink uci/log-settings e.g. for leds/syslog

# underload, anderen CRON killen:
# pidof sh
# cat /proc/$PID/cmdline: '/bin/sh-c. /tmp/CRON_IS_CAREFUL'

# during log(): local load="$( _system load 1min )"; test $load -gt 80 && { MESSAGE="LOAD:$load $MESSAGE"; PRIO=alert; }

# IPv6 ausschalten:
* Global build settings -> [ ] Enable IPv6 support in packages
* Kernel modules -> Netfilter Extensions -> [ ] kmod-ip6tables 
* Kernel modules -> Network Support -> [ ] kmod-ipv6
* Network -> [ ] odhcp6c
* Network -> [ ] 6relayd
* Network -> Firewall -> [ ] ip6tables ???
* Libraries -> Firewall -> [ ] libip6tc

# HASH=59d13e5; for F in *; do case "$F" in *git.*) case "$F" in *$HASH*) ;; *) rm "$F"; esac; esac; done
# + link to it!





# mac1200r: 192.168.1.111 - bootloader-pass = tpl
# ip address add 192.168.1.100/24 dev $LANDEV
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp	# with file '/tmp/6F01A8C0.img'
# tftpboot 0x81000000
# erase 0x9f020000 +0x3c0000
# cp.b 0x81000000 0x9f020000 0x3c0000
# bootm 9f020000
#
#
# simple tftp-server: (we can see in log e.g.: dnsmasq-tftp[32648]: sent /tmp/t18.rom to 192.168.0.10)
# 1043nd = 192.168.0.2
# ip address add 192.168.0.5/24 dev $LANDEV
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp	# with file 'code.bin'
# erase 0xbf020000 +7c0000
# tftpboot 0x81000000 code.bin
# cp.b 0x81000000 0xbf020000 0x7c0000
# bootm 0xbf020000
# erase 0xbf020000 +7c0000; tftpboot 0x81000000 code.bin; cp.b 0x81000000 0xbf020000 0x7c0000; bootm 0xbf020000
#
# 4300:
# ip address add 192.168.1.100/24 dev $LANDEV
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp	# with file '6F01A8C0.img'
# on router:
# tftpboot 0x81000000; erase 0x9f020000 +7c0000; cp.b 0x81000000 0x9f020000 0x7c0000; reset
#
# 841nd v8:
# ip address add 192.168.1.100/24 dev $LANDEV
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp	# with file '6F01A8C0.img'
# tftpboot 0x80000000					# use WAN-port
# erase 0x9f020000 +0x3c0000
# cp.b 0x80000000 0x9f020000 0x3c0000
# bootm 0x9f020000
#
# 703n:
# ip address add 192.168.1.100/24 dev $LANDEV
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp	# with file '/tmp/6F01A8C0.img'
# tftpboot 0x81000000
# erase 0x9f020000 +0x3c0000
# cp.b 0x81000000 0x9f020000 0x3c0000
# bootm 9f020000
#
# 4900er: (pass = 'vl' at bootloader-prompt)
# tftp-method works also without serial console		# filename: /tmp/wdr4900v1_tp_recovery.bin
# ip address add 192.168.0.66/24 dev $LANDEV		# with file 'uImage', router has '192.168.0.86' with mac '00:04:9f:ef:01:01'
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp
#
# tftpboot
# sf probe 0
# sf erase 0x60000 0xf80000
# sf write 0x1000000 0x60000 0xf80000
# reset
#
#
#
# tmobile Internetbox / cube:
# ip address add 192.168.0.100/24 dev $LANDEV
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp
# ip neigh add 192.168.0.1 dev eth0 lladdr 00:0e:56:00:0f:c5 nud permanent
#
# wget -O /tmp/1.srec http://downloads.openwrt.org/backfire/10.03.1/au1000/openwrt-au1000-au1500-vmlinux-flash.srec
# wget -O /tmp/2.srec http://downloads.openwrt.org/backfire/10.03.1/au1000/openwrt-au1000-au1500-jffs2-128k.srec
#
# wget -O /tmp/1.srec http://downloads.openwrt.org/snapshots/trunk/au1000/openwrt-au1000-au1500-vmlinux-flash.srec
# wget -O /tmp/2.srec http://downloads.openwrt.org/snapshots/trunk/au1000/openwrt-au1000-au1500-squashfs.srec
#
# sudo ip neigh change 192.168.0.1 dev eth0 lladdr 00:0e:56:00:0e:10 nud permanent
# sudo ethtool -s eth0 speed 10 duplex half autoneg on
# sudo ./ethernet_flash -i eth0
#
# set
# setenv bootserver 192.168.0.100
# setenv ipaddr 192.168.0.1
# setenv gateway 192.168.0.100
# ping 192.168.0.100	# for ARP
# erase -s		# hangs for ~120 seconds
# load /1.srec		# openwrt-au1000-au1500-vmlinux-flash.srec
# load /2.srec		# openwrt-au1000-au1500-squashfs.srec ~ 13mb size
# go
#
# mtd    write /tmp/vmlinux.bin kernel
# mtd -r write /tmp/fs.bin      kernel
#
#
#
# rb532:
# boot-proto = dhcp
# dnsmasq --port 0 --enable-tftp --tftp-root=/tmp	# mit vmlinux, e.g. openwrt-rb532-jffs2-128k.kernel 

URGENT:
- noolsr/ibfleesensee

- 1043ND: md5sum /dev/mtd0 :: strings /dev/mtd0 | grep U-Boot
  - ??? : dab5229a0cbe46160e8b8d0ef093eb2c :: U-Boot 1.1.4 (Nov 17 2009 - 11:56:26)	-> spbansin/haus6
  - ??? : d2acf2a1587e2349d858da14bd9fe445 :: U-Boot 1.1.4 (Nov 17 2009 - 11:56:26)	-> spbansin/haus12
  - good: 31ef3d5fad161ce7affbac0d0ae3293e :: U-Boot 1.1.4 (Nov 17 2009 - 11:56:26)
  - good: 17d63e8edb736df029cf6bc0391a080a :: U-Boot 1.1.4 (Aug  4 2010 - 20:06:51)	-> liszt28-2
  - bad:  12cb02c599ad92ed607d05e65daabd4e :: U-Boot 1.1.4 (Aug  4 2010 - 20:06:51)
    - wget -O /tmp/uboot.bin http://intercity-vpn.de/files/openwrt/bootloader_TL-WR1043ND_17d63e8edb736df029cf6bc0391a080a_WANok_U-Boot_1.1.4_Aug_4_2010.bin
    - mtd write /tmp/uboot.bin u-boot

- hybrid: no_incoming() fails? -> check AP
- always let 2 nodes ping monitoring server
- no shaping under X megabytes
- ticket-speed = real-speed
- multiradio: bssid adhoc varieren: = c11 c36
- multiradio: working dhcp
- index_gen nur bei ticket_gen?
- fix netfilter/splash for batman
- backup's db in die cloud, nicht auf flash
- conntrack auch in sysctl auf alten wert / eigene zeile raus
- check shaping when different interfaces are involved
- rehungen: apply_shaping after X mb
- spbansin: 812 + 908?
- spbansin: replace wrong bootloader
- batman: correct add if 'wlan0' to bridge via ifstatus <ifname>|grep ifname
- wenn load immer weiter sinkt (Tendenz), soll OVERLOAD nicht ausloesen
- cron.minutely: monitore olsr-packets on wire per minute (B01)
- wenn mehrere male 'ath: phy0: Failed to stop TX DMA' dann echo 4 >diag

TODO-next:
# - rrd: show users + overall users
# - rrd: show overall traffic in [mb]
# - master: outgoing with sourceaddress not from me? drop
# - leonardo: wan2 + alias wan + wan-dhcp + wan=free + extended reachable check for wan
# - speed auf pfad anpassen: regelmaessig fuer jeden node den max up/down ermitteln und in max-speed einfliessen lassen bei apply_shaping
# - reverse-ssh-tunnel: autossh?
# - reverse-ssh-tunnel: retry 10 times if conn will not establish
# - rrd: show stations: for S in /sys/kernel/debug/ieee80211/phy0/netdev:wlan0/stations/*; do echo $S; done
# - make use of netfiler 'notrack' for e.g. port53 dns
# - scp to monitoring-server: sometimes we need to regen keys, although everything seems good. the real check is to scp something to server. automate this.
# - patch inittab on LOWMEM for non-user-shell/askfirst
# - reboot not at timeX? message! (during ntp) 
# - ifup wan (when dhcp) before reboot? (to sticky the lease)
# - mail: set replyTO:
# - mail/smtp: implement 3 different smtp-gateways/methods
# - webcam-support UVC 1.00:
#   - HP Webcam HD-4110 (03f0:9207) = Seepark Bansin
#   - Microsoft® LifeCam Studio(TM) (045e:0772) = Buero Fenster
#   - SunplusIT PC Camera (1bcf:0b01) = 2te Lieferung HP?
# - support for specials: e.g. bigbrother (webcam-support), mini (4mb flash)
#   - build/upload: Buffalo WZR-HP-AG300H.bigbrother.r37106-kernel3.8.13-git.fb34ce2.sysupgrade.bin
#   - links() + apply_profile()
# - batman-modus im monitoring senden
# - update-server/monitoring-server: info.txt muss ein script sein, was hashes + files dynmaisch zusammensetzt
# - vtund-check in cron.minutely oder watch(): grep "tap0:" /proc/net/dev || action
# - sysupgrade fuer einzelnen knoten im wartungsfenster aktivieren: touch upgrade_next_window?
# - DHSYLT/K80/Netzwerksteckdose: bei sysupgrade weiter pingbar sein, auch:
    - iptables -I INPUT -p icmp                  -j LOG --log-prefix "ICMP: "
    - iptables -I INPUT -p icmp ! -s 84.38.67.43 -j LOG --log-prefix "ICMP: "
# - list() we always input a space separated list and out put a "\n" one - problems?
# - ath9k-error: cat /sys/kernel/debug/ieee80211/phy0/ath9k + echo 4 >/sys/kernel/debug/ieee80211/phy0/ath9k/diag ==> resetHW
# - firmware-upgrade: cannot unload kmodule IPv6: maybe delete allinet6 fe80::* stuff?
# - dns: change leasetime according to scheduled reboottime
# - switch: check if we can read the expected number of ports. otherwise: portmap: 'B.--C' was: 'B.---C'
# - use flock? http://stackoverflow.com/questions/13551840/bash-flock-why-200
# - NOTICE: /proc/<pid>/oom_adj is deprecated and will be removed, please see Documentation/feature-removal-schedule.txt.
# - myinfo.sh: show token + store_on_flash.$token
# - build: use folder "files" instead of occupy package/base-files
# - /proc/net/dev -> /sys/class/net/
# - boltenhagendh: hybrid = kanal 1 + komische bssid
# - ist olsr-hash wirklich noetig? hotello-B01: hash2: c44b44ba7a3612e2f6be3531ddcba407
# - support/use of 'logread -f -r server:port'
# - netfilter: enforce writing of NETFILTER_AUTOADD
# - nach reboot sehr schnelles monitoring-senden fuer IP _wenn_ local_inet_offer
# - batman for boltenhagendh
# - monitoring: fetch meshrdf if ping_error and ping_good again
# - log each reboot, (crash or manually) and calc real bootdate
# - batman: zweiter IP-Bereich oder groesser
# - faxe: antwort-fax-nummer mit drauf
# - batman: # zeile 512: echo "dhcp-range=bridge,192.168.5.100,192.168.5.120,255.255.255.0,10m" >> $CONFIGFILE
# - monitoring: make switch sortable (e.g. "all with inet-offer", all which are the same), just add +1 for each used port and +2 for inetofferport?)
# - ffweimar: WAN = dhcp + static + OLSR
# - neigh: show wifi/channel humanreadable?
# - each node: accept forwarded, but filter outgoing packets, which have source-address ! ownHna4 (should do each ISP)
# - olsrd: fixup an ipv6 startup/both instances/concept
# - make all neighs arp-permanent
# - nutzen fuer kmdlinetweak: target/linux/ar71xx/Makefile LINUX_VERSION:=3.8.12
# - nach anmeldung umleitung auf "willkommen" + angebot: http://www.dorfhotel.com/angebote/hotelangebote-sport-golf-segeln-fahrrad-nordicwalking-yoga.html
# - apply_profile: no wlan-ifname in network
# - olsrd-init: restart() b0rken?
# - olsrd-init: ipv4 + ipv6
# - 1043er detect "wrong" bootloader/wan-problem
# - rrd: show overall values
# - update: spbansin/cam
# - monitoring: give up, when empty default route AND error
# - monitoring: generic support for "heartbeat"/hb
# - build-support: "bigbrother": multimedia: +fswebcam +ffmpeg +motion  utilities: +v4l-utils  kernelmodules: videosupport: +kmod-video-core +kmod-video-uvc
# - build-support: +rrdtool +kmod-batman-adv +kmod-ipip +kmod-sit +kmod-usb-printer +p910 +luci +mii-tool(9k)
# - crashlog.o: abstraktion: uhrzeit retten? rrd retten? tgz retten!
# - lowmem-device: shut down olsrd-txtinfo-plugin
# - lowmem-device: find more minimal iptables set?
# - Make: all hostapd-switches configurable
# - remove all calls to iwconfig/iwpriv/wext -> without iwconfig, it runs
# - /www/NETFILTER_AUTOADD: check before reboot and enforce readding
# - wan-detect via ifplugd or script
# - crondebug: kerneltasks: fgrep -c "0 SW" /tmp/CRON_PSWORK2
# - build: hostapd:
#   - remove: CONFIG_DRIVER_MADWIFI=y + CONFIG_DRIVER_WIRED=y + CONFIG_DRIVER_HOSTAP=y + CONFIG_RSN_PREAUTH=y + CONFIG_PEERKEY=y + CONFIG_IEEE80211N=y
#   - add: CONFIG_NO_VLAN=y
# - build: lowmem: remove CONFIG_UBUS=y from package/network/services/hostapd/files/hostapd-mini.config
# - cron.minutley: mesh/lowmem: ping -s 1337 = startup uhttpd
#   - iptables -I INPUT -p icmp -m length --length 1365
#   - ping -c 1 -s 1337 10.63.15.33
#   - or: https://github.com/libre-mesh/magic-icmp
# - check /proc/sys/vm/min_free_kbytes - http://lists.centos.org/pipermail/centos/2006-December/030766.html
# - nightly reboot: wait till forwarding is 0 for 60sec
# - crondebug: last longer than 60sec? -> CRONSTATUS + locked ans ende
# - klog: nf_conntrack: automatic helper assignment is deprecated and it will be removed soon. Use the iptables CT target to attach helpers instead.
# - log_debug() handle brdip = ff:ff:ff:ff:ff:ff
# - build: minimal: no package/network/ipv6/6relayd + odhcp6c + ipv6-support 
# - nightly_reboot() only unload/store vds - not fully stop packetfilter
# - wifiscan jede nacht - alle macs/ssid merken -> graph? -> kanalaufteilung? -> olsr-plugin?
# - netfilter_stop() without removing nat and without killing connection
# - netfilter_ror() in extra function
# - rrd: also store load over time
# - rrd: not inet_offer? plot rule 3 + 4
# - store dmesg for later checks?: cp /tmp/dmesg.log "/www/dmesg.log.$( _system date humanreadable )"
# - db_restore() soll auch serverkopie benutzen (und aus cron.evaluate_syslogd rausnehmen)
# - make incoming_framecounter base on 'iw dev $wifidev station dump'
# - repair nodes with broken webserverconfig
# - webcam: [ $( logread | grep -c "uvcvideo: Failed to set UVC probe control" ) -gt 5 ] && reboot
# - webcam: make resolution uci-configurable + fix 450 pixels -> modulo 16 -> 448 px
# - solution for special macs / no shaping: liszt28: nasf36: 02:50:43:ab:1c:91
# - fix watch_random_node_id() during apply_profile
# - generalize live-traffic shower per mac on commandline
# - rrd for inet-gw/wan
# - inactive for >x mins? -> throttling/shape to original values
# - override_uci: 10m leasetime wlan when ipsystem = normal
# - why does stats/yesterday not work?
# - check autostart of webserver, otherwise we always spam the log after each reboot
# - switch() give points per connection-speed so we can better log
# - netfilter: special mode for NETFILTER_AUTOADD + testing
# - log all reboots not @4.00 during successful ntp_set
#   - crashlog or unknown reason?
# - ntp_set via neighbour
# - uci -q get ueberall
# - monitoring: cat $WIFI_RESTARTS.wlan0 2>/dev/null
# - olsr-init: IFS immer retten
# - finetune max_length in monitoring
# - why S01/overrid_uci_vars is not called
# - is S00/generate_kalua_loader really working?
# - integrate new rules for ejbw / lan-dhcp
# - testing if new function client_list() build correct: fix /30 WAN
# - activate patch for rcS-watcher
# - no inet_offer and ! ping_to_nexthop (but not myself) -> reboot
# - cron-replace: while true; do sleep 60; command . /tmp/CRON_IS_CAREFUL; touch /tmp/CRON_IS_CAREFUL; done &
#   - http://intercity-vpn.de/files/openwrt/dmesg_r35300_error_mac80211_ath9k.no_cron_action_anymore.txt
#   - http://intercity-vpn.de/files/openwrt/dmesg_r35300_error_mac80211_ath9k.no_cron_action_anymore-ps.txt
#   - or use dhcpscript to check if cron is running (is correct uptime in file x)?
# - autolearn olsr-neighhash? (K80!)
# - debug 0 byte mailfile r99/l28
# - image smaller, so that image-on-flash works
# - compile/test atheros image with -O0
# - generischer modulloader fuer lowmem-geraete
#   - xt_TCPMSS|xt_REDIRECT|xt_NETMAP|aead|crypto_blkcipher
# - apply zramscript: logger --> _log calls + loglevel same as firmware
# - do not influence oom-score for watchdog (S70prepare)
# - convert _switch() for all known hw-types
# - everybody gets "hybrid", if there is no neigh with ap-mode
#   - if b43 and ap -> mesh
# - build/apply_profile: set IP for hybrid-network
# - mail: http://vger.kernel.org/vger-lists.html#netdev : complain about: ip route list exact 0.0.0.0/0 || action
# - loader: check if multiple args in loader can be $@ instead of $1 $2 $3 ...
# - loader: if a zero-byte class is found, use logger in loader and do not fail (e.g. db() for weimarnetz)
# - if ntp_set was successful, update: head -n1 /www/NETFILTER_AUTOADD (or use a dedicated mechanism)
# - build: auto-activate SWAP in kernel for atheros
# - helper-script: vds: last traffic of $IP or $NODE or $HASH (tar -tvkf "$file.lzma" --force-local)


# idea:
# /www/startsysupgrade: ap-mode? reboot:
# special module loader + leave wifi off + netfilter off + olsr-slave

# idea:
# during scheduler -U, replace crontab with '/usr/bin/scheduler -U'

# 16mb-routers:
# S72 / no monitoring

# 16mb-routers:
# olsr-hna-slave? no NAT modules needed?

# repair all calls to set without "--"
# git grep "set "|grep -v -- "--"|grep -v reset|grep -v "uci set"|grep -v "nvram set"

# R30:
# - laptop eintragen?
# - olsr-error during check_inet?


# build:
# all patches/applymyprofile via git

# weimarnetz-server:
# for M in floppy usbcore usb_common ehci_hcd uhci_hcd cdrom hid usbhid i2c_core i2c_piix4 joydev soundcore snd psmouse snd_timer snd_page_alloc snd_pcm; do echo "blacklist $M" >>/etc/modprobe.d/my-blacklist.conf; done
#


# umount /space; mount -t tmpfs -o size=6G,mode=0777 tmpfs /space
#
# build in /dev/shm, symlink these
# ./bin (2mb) ./build_dir (3.5gb) ./staging_dir (250mb) ./tmp (15mb)
#
# symlink this globally: (~250 mb content)
# mkdir -p /tmp/openwrt-downloads
# chmod -R 777 /tmp/openwrt-downloads
# ln -s /tmp/openwrt-downloads dl 


# http://www.useragentstring.com/pages/Browserlist/
# http://www.useragentstring.com/?uas=Opera/9.70%20(Linux%20i686%20;%20U;%20en-us)%20Presto/2.2.0


# measure size change

# patch_kmodules: mode = remove_file()

# rehungen/userdb:
iptables -t nat -I PREROUTING -p tcp --dport 10080 -j DNAT --to-destination 10.10.8.33:80
iptables -t nat -I PREROUTING -p tcp --dport 10443 -j DNAT --to-destination 10.10.8.33:443
iptables -t nat -I POSTROUTING ! -s 10.0.0.0/8 -d 10.10.8.33 -j MASQUERADE
#
iptables -t nat -D PREROUTING 1
iptables -t nat -D PREROUTING 1
iptables -t nat -D POSTROUTING 1


# olsrd:
# do not start anymore if a stable olsr-master for myself (slave) is already found an safed, just refresh rules

# useful /etc/.vimrc:
set cul
hi CursorLine cterm=none ctermbg=darkgray ctermfg=white
syntax on
set syn=sh


# patch openwrt:
# git clone git://nbd.name/openwrt.git
# git checkout -b feature_abc
# <make some changes>
# git diff --cached --color
# git commit		(respect http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html)
#	subject e.g. '[packages] olsrd: use system-logger instead of dumping to stdout'
#	subject e.g. '[base-files] failsafe-mode: print short help on commandline'
#
# stimmt nicht: Betreffzeile 2 mal schreiben, dann ist es gleich in der Mail richtig
#
#
# git format-patch --subject-prefix="PATCH RFC (vN)"
# git format-patch --cover-letter
# git format-patch -s -1  ('s' means: add signed-off ...)
# git format-patch -s -5
# git format-patch -s $hash_of_last_commit_not_from_me
#
# check before send:
# git apply --stat $file
# git apply --check $file && echo OK
# git am --signoff <$file
#
#
# scp -P 22 000* root@intercity-vpn.de:/var/www/files/openwrt/patches
# scp -P 222 000* bastian@bwireless.mooo.com:/tmp
# wget http://intercity-vpn.de/files/openwrt/patches/000...
# mutt -H "$file"	(http://blog.ndrix.com/2007/05/mutt-and-git-format-patch.html)
#
# testen:
# git send-email --to basti@bla HEAD~3

# patch b43:
# git clone git://git.kernel.org/pub/scm/linux/kernel/git/linville/wireless-testing.git
# <make some changes>
# git add .
# git commit -m "bla"
# git show >/tmp/my.patch
# sed -n '/^---/,$p' /tmp/my.patch >/tmp/841-b43-raise_dma_rx_ringbuffer_to_128.patch


# ideensammlung 'init' -> procd
# - source a shellscript every 60 sec
# - refresh watchdog every x sec
# - syslogd
# - klogd
# - hotplug2
#
# http://www.landley.net/hg/toybox/file/aad12ce05aae/toys/other/oneit.c
# http://spblinux.de/2.0/doc/init.html
# http://busybox.net/~vda/init_vs_runsv.html
# http://www.centos.org/docs/5/html/5.1/Installation_Guide/s2-boot-init-shutdown-init.html
# http://smarden.org/runit/


# monitoring: better show +123 more dmesg lines after boot

# liste aller freigeschalteten macs direkt in dhcp-script aufnehmen
# beim ersten cron.check_inet vom server holen:
# grep "C='..:..:..:..:..:..'" /tmp/DB/USER/login/rows | cut -d';' -f4 | cut -d"'" -f2


# userdb-gui:
# vorrat/ticketsart und in db_ticketcheck beruecksichtigen
# boltenhagendh: mehr 3-tagestickets


# userdb-gui:
# berichte: tages/wochen/monats + email angeben

# userdb-gui:
# berichte: taeglich: top 10 user?

# olsr_hna_slave:
# verbieten wenn master nicht _ipsystem wie ich hat (ejbw, wanolsr)

# why this?
# /etc/init.d/S69watch_olsrd_fff+ [daemon.alert] watch_dhcp_space() clients: lan: 0/150 wifi: 1/0

# make sure to use the password hash in /tmp/vds_user_$mac, even when we
# are freed by "already known on other station"


# bugreport:
# - show normal olsr-neighs-table without error


# rehungen:
# - ask user-data every 3 month,
# - reset passwords 


# myinfo.sh:
# - start test via button and show download-speed in numbers


# rehungen: dns:
# - erzwingen von DNS = 10.10.8.33 ausser auf: sollstedt etc.
# - erlaubenvon wan-dns in Kindergarten
# - remove alias 10.1.0.8 auf kindergarten

# firmware-simpler schneller/sicherer:
  - ZENTRALER NODE = ZN
  - kein update/warten, wenn gerade AP-clients connected
  - ZN gibt firmware-datei raus? nein, muss proxy-cache erledigen
  - vor update: abmelden an ZN nach apply_profile + reboot = anmelden an ZN
  - erst dann freigabe fuer naechsten
  - alles ist gelockt mit angabe in sekunden, wann ca. erneute anfragen gestellt werden darf

# wartungmodus:
  - erstmal manuell per shell-wizard + script auf router
  - alle clients rauswerden
  - startseite = wartungsmodus
  - dnsmasq beantwortet alles mit $WIFIADR


# force minimal olsrd-setup for 16mb routers (only plugin txtinfo)

# apply_profile: use '/cgi-bin/:root:$p$root' if possible for uhttpd

# log/sms: sms.@sms[0].username / sms.@sms[0].password

# patch sysupgrade for also using /dev/console

# when in dmesg: 'failed to initialize PHY', no unloading of wireless stuff before sysupgrade

# kill ubusd, procd before sysupgrade?

# hack: activate shaping only for users which have over >mb

# if we know how long a task will last, feed a "box" with minute-signs, and cron-overload-detector will eat them up over time

# traffic ueber tunnel: config-option, wenn auch ueber lan

# split scheduler jobs into sourceable files, e.g. "w" and "O"

# rootserver: tun/tap per hna4 ankuendigen - pauschal fuer jeden

# remove dead-netfilter users midnight

# always remove dhcpscript for lowmem-devices, except if explicit configured

# deny tool if action?: while :;do ps | fgrep CRON_IS_CAREFUL | fgrep -v grep ; sleep 1; done

# wget: maybe do normal wget, but mark for cron_watcher?

# userdb-copy via wget()

# pdf-versand: seitennummern

# sms bei ticketversand nur 1mal, nicht pro seite


# beim 15min-summary abliefern neue tickets als used markieren/abziehen

# beim 15min-summary abliefern erlaubte mac's/Logins mitliefern


# wenn olsr-nachbarn nud=permanent sind, arp-plugin ausschalten
# sonst haut das plugin immer wieder rein in _net arp_permanent()

# packages automatisch mit passendem datum auschecken wie openwrt-git

# _olsr_uptime() work with uptime instead of date - check other function too

# system_date() to class date()

# check kmodules-hack for working pppoe

# ssh bastian@gcc20.fsffrance.org

# userdb-GUI: force global fuzzy

# [ERR] are wired neighbours LQ/NLQ nearly synchronous? no! REMOTE/LQ/NLQ = '10.10.31.33'/'1000'/'0'
# uci changes | fgrep 10.10.31.0	// ignore hna-slaves

# monitoring: dmesg:
# SQUASHFS error: Unable to read page, block c52d2, size ebb8
# SQUASHFS error: Unable to read fragment cache entry [c52d2]

# watch_random_node_id() really enforce apply_profile, if nodenumber clashes/registrator complains 

# echo 4194304 >/sys/block/zram0/disksize; mkswap /dev/zram0; swapon /dev/zram0

# package: ffweimar-mapstraction-karte

# rehungen: do not allow weblogin <r33726 (after updating hybrid-router)


# find a way to auto-config:
# hybrid
# dualradio: ap/ap
# dualradio: hybrid/ap
# dualradio: ap/adhoc

# liszt28: etx_ffeth + 02:ca:ff:ee:00:11 + kanal 11

# apply_profile: always do bssid_wellformed() even in 11g mode and preset to "02:ca:ff:ee:ba:be"

# sms bei ticketversand konfigurierbar machen

# monitoring: change order if ssid's in hybrid mode (first "Hotello", then 'bb')

# fusionpbx
# ^03643?(\d{5-8})$
# the ^03643 means that the number can start with 03643 but its optional

# rehungen 10.1.0.8 auf richtfunk ändern zu 10.10.254.33
# auf 8/kindergarten: + hna4 10.1.0.8/32

# apply_profile: boltenhagendh: festscheune: free-login

# apply_profie: config: dhcp: list notinterface = wan ::: nur wenn auch einspeiser, netzintern egal (rehungen8)


# on both servers:

# MYDIR="y"; ARCH="brcm47xx"; R=34054; FILE="openwrt-brcm47xx-squashfs.trx"; HARDWARE="Buffalo WHR-HP-G54"; K=3.3.8
# MYDIR="z"; ARCH="ar71xx";   R=34054; FILE="openwrt-ar71xx-generic-wzr-hp-ag300h-squashfs-sysupgrade.bin"; HARDWARE="Buffalo WZR-HP-AG300H"; K=3.3.8
# MYDIR="x"; ARCH="ar71xx";   R=34054; FILE="openwrt-ar71xx-generic-tl-wr1043nd-v1-squashfs-sysupgrade.bin"; HARDWARE="HARDWARE.TP-LINK TL-WR1043ND"; K=3.3.8

# on build-server:
$DO r$R "$HARDWARE" standard kernel.addzram dataretention trafficshaping kcmdlinetweak

# on file-server:
# scp bastian@46.252.25.48:$MYDIR/release/openwrt/bin/$ARCH/$FILE "${HARDWARE}-exp-r${R}-${K}.sysupgrade.bin"
# cp "${HARDWARE}-exp-r${R}-${K}.sysupgrade.bin" "${HARDWARE}.sysupgrade.bin"; md5sum "${HARDWARE}.sysupgrade.bin"




# db_cleanup()
# = remove old entries from stats >1 month
# = do not hash login-entries older than X month untouched

# while :; do netstat -an 2>/dev/null | grep $LANADR:80 | grep ESTABLISHED | while read LINE; do set -- $LINE; echo -n "$( echo $5 | cut -d':' -f2 ) "; done | sort -n; test -z "$LINE" && echo "#"; sleep 5; done


# erste inbetriebnahme: _db_backup() schlaegt fehl. checken
# touch ... noetig


# forbid udp-source-ip-spoofing: sudo hping3 10.63.99.33 --udp --spoof 192.168.1.150


# package: ekuku-longshot: ath5k -b43 +mii-tool
# package: rrdtool


# rrd:
# each router
# each user
# each login


# high load + multiple dropbear-pids: shutdown dropbear
#
# needs iptables-mod-conntrack-extra: _net local_inet_offer && {
# iptables -I INPUT -i $WANDEV -p tcp -m tcp --dport 22 -m state --state NEW -m recent \
#  --set --name DEFAULT --rsource
# iptables -I INPUT -i $WANDEV -p tcp -m tcp --dport 22 -m state --state NEW -m recent \
#  --update --seconds 180 --hitcount 4 --name DEFAULT --rsource -j DROP
# http://www.digitalsanctuary.com/tech-blog/debian/using-iptables-to-prevent-ssh-brute-force-attacks.html
# }


# FILE_IN=youtube.flv
# FILE_OUT=vtech_kidizoom.avi	// 102_0366.avi
# ffmpeg -i "$FILE_IN" -r 25 -ab 16k -ar 22050 -vcodec mjpeg -b 64k -acodec pcm_s16le -ac 1 -s 320x240 -sameq "$FILE_OUT"


# complex feedback during server_ask weblogin() -> speed, traffic, yes/no, special message etc.


# for i in $(seq 0 255); do hex="$( printf "%X\n" $i )"; echo "$i: $hex: $( eval "echo \$'\x$hex'" )"; sleep 1; done


# bytes bei user_del speichern und bei user_add apply?


# wenn ramdisk voll, dann logrotate checken: manchmal ist /www/everlasting_syslog weg

# speedwerte in file schreiben
#
# change per user traffshaping implementieren: percent from original OR percentual change (down to 75% OR -5%)
#
# change per profile alle 15mins (?) neu applien (kurven vor ermitteln)


# best practise for making an hybrid-router (adhoc+ap):
# in /etc/config/network add (beside to normal wlan-network)
#
# config 'interface' 'wlanadhoc'
# 	option 'ifname' 'wlan0-1'
# 	option 'proto'  'static'
#	option 'ipaddr'  'same like in network wlan'
#	option 'netmask' 'same like in network wlan'
#
# in /etc/config/wireless add
#
# config wifi-iface
#	option device   radio0
#	option network  wlanadhoc
#	option mode     adhoc
#	option bssid    '02:ca:ff:ee:ba:be'
#	option ssid     'bb'
#
# config wifi-iface
#	option device   radio0
#	option network  wlan
#	option mode     ap
#	option ssid     'myAP'
#

# fix profile_counter -> faster check, run every night for every ticket
# do not lock weblogin-via-mac-enabled clients during db_process
# make use of SNI?: http://en.gentoo-wiki.com/wiki/Apache2/SSL_and_Name_Based_Virtual_Hosts 

# Make panic_on_oops configurable / always on
# http://lkml.indiana.edu/hypermail/linux/kernel/1204.1/01389.html

# weblogin:
# support for single-string-login

# _netfilter user_list verbose
# xx:xx:xx:xx:xx:xx $ip $dev $tx $rx $shape_in $shape_out

# option for not kicking users over time, but slow them down to 8kbit/8kbit -> move to another profile?
# if not used for X days, remove from DB

# why index_gen is fully done after creating 32 tickets? -> implement also index_gen for a specific entry

# implement wshaper.htb for each user

# make var: LOCAL_INET_OFFER=lan

# better force of reboot for lowmem-devices each night

# why does olsr_restarts_over_limit() not work in lowmem-AP?

# add: kernel.hung_task_panic=1
# add: softlockup_panic=1

# kalua_init: allow 0 byte classes and allow all calls to them

# netfilter: mode for redirect of DNS requests to me, must be done global or per user

# fake-hybrid: update:
# F=/etc/config/wireless;I=0;while read L;do case "$L" in *wifi-iface*) I=$(($I+1));;esac;test $I -gt 1 && L="#$L";echo $L;done <$F >/tmp/W;mv /tmp/W $F
# F=/etc/config/wireless;I=0;while read L;do case "\$L" in *wifi-iface*) I=\$((\$I+1));;esac;test \$I -gt 1 && L="#\$L";echo \$L;done <\$F >/tmp/W;mv /tmp/W \$F

# debug uhttpd:
# /usr/sbin/uhttpd -h /www -r HOSTNAME -c /etc/httpd.conf -x /cgi-bin
# -t 60 -T 30 -A 1 -E /cgi-bin-404.sh -I cgi-bin-404.sh 
# -n 1 -p 0.0.0.0:80 -i .sh=/bin/ash -C /etc/uhttpd.crt -K /etc/uhttpd.key -s 0.0.0.0:443


# use "cutycapt" for make screenshots/pdf of webpages
# and for automatic walled_garden-url's -> list_of_ipaddresses

# add to website: https://github.com/blog/273-github-ribbons

# everything before the first :
# ${varname%%:*}
# everything after the first :
# ${varname#*:}
#
# always use 'set -- $var'

rm /www/channel_try
for i in $(seq 1 300); do
	uci set wireless.radio0.channel=$i
	wifi
	sleep 8
	[ -z "$(iwconfig $WIFIDEV | grep "Not-Associated" )" ] && echo $i >>/www/channel_try
done >/dev/null

# netfilter user_add: make an option 'force' for ignoring reachability

# autoapply config_ath9kdebug if possible during standard-conf

# abstraction for ticketcounter "_counterA", use: watch_counter() + set in _db_autocreate_tickets_and_send_mail() and _db_ticketcheck()

# DSL-modem/get values: http://www.webtemp.org/?page=sm50b

# wan-dhcp? -> use dns provided by wan, not 8.8.8.8

# unselect b43legacy
# CONFIG_PACKAGE_kmod-b43legacy is not set

# why do WZR/dual-radio have problems with being an olsr-slave?

# check: how does it look, if ip must be reauthenticated during send_mail()?

# kirkwood:
# use flash_eraseall and nandwrite -p from mtd-utils
# I mean flash_eraseall both the kernel and rootfs partition
# nandwrite -p the kernel to the kernel mtd
# mount -t jffs2  the rootfs mtdblock
# and tar -C /mnt -xzf openwrt-kirkwood-rootfs.tar.gz
# all this is best done from within an initramfs image


# after r32739 it should be enough to use "sed -ne ':package; /^Package: / { s/.*: //; h; :line; n;
# s/^Status: .* \(.*\) .*/\1/; /^user$/ { x; p; }; t package; b line }' /usr/lib/opkg/status" to find the list of user
# installed packages

# css-sprites for weblogin?

# check 15mins: tmpfs full?

# ticketcheck: use idX_counterA for fast processing

# b43:
# http://permalink.gmane.org/gmane.linux.drivers.bcm54xx.devel/10680

# automate build / continous integration via
# echo "# CONFIG_foo is not set" >> .config; make defconfig

# lowmem-device: make sure ulogd is not started by default; /etc/init.d/ulogd disable
# option for enforce dns for specific client: iptables -t nat -I PREROUTING -p udp -s 10.63.99.6 --dport 53 -j DNAT --to 10.63.99.1
# special longshot-mode, ping always, log stats (timeouts) -> simply set IP to check
# _watch inetoffer() -> restart masq, if no -> yes

# captive portal with oauth support
# https://github.com/livibetter/bash-oauth/blob/master/OAuth.sh

# http://holstentor.metameute.de/nodes/nodes.html

# show (count?) interesting tasks:
#
# ps | while read LINE; do set $LINE
#	case "$5" in
#		COMMAND|init|watchdog|uniq|sort|sleep|ps)
#		;;
#		"["*)
#		;;
#		*)
#			basename $5
#		;;
#	esac
# done | sort -u

# A="$( grep " sda"$ /proc/partitions )"; set $A; echo $3/1024 ->kilobyte

# debug: paste in /etc/functions.sh
# iw(){ logger -s "iw $@"; /usr/sbin/iw $@; };

# hook in system_date() for setting time
# check if 'option hidden 1' makes sense for adhoc-mode-only routers

# auf DSLer/Satama: ip: 10.63.119.1
# iptables -t nat -I PREROUTING -i $WANDEV -p tcp --dport 443 -j DNAT --to-destination 10.63.222.1:80
# iptables -t nat -I POSTROUTING -d 10.63.222.1 -j MASQUERADE
# test: http://pubip:443/robots.txt

# auf DSLer/FparkSsee: ip: 10.63.222.1, interner zielrrouter: 192.168.101.112
# iptables -t nat -I PREROUTING -s 10.63.119.33 -p tcp --dport 80 -j DNAT --to-destination 192.168.101.112

# more generic solution for simulated hw-clock

# dell-2300:
# robocfg show (egal ob LAN- oder WAN-kabel steckt)
#
# probing eth1
# phyid: Success
# probing eth0
# phyid: Success
# bcm53xx_probe: Success



build()
* bug: minor: same gitrev-tarball must have the same hash
* bug: minor: leave channel untouched in AP-mode, when rewriting profile
* bug: minor: http://wiki.openwrt.org/doc/howto/vpn.nat.pptp
* feature+: (testing) no stopping cron.minutely due to SSH-action on all inet-offer-nodes
* feature+: use .txz instead of .tgz for tarball
* feature+: include mysshpubkeys.ipk -> /root/.ssh/authorized_keys | known_hosts
* feature+: include mydesign + mysettings
* feature+: build /tmp/loader + kalua_working_dir on demand directly in the image (safes space)
* feature+: rework zram-stuff, simple append '; echo >$size >$kernel' to /etc/modules.d/00-zram
* feature+: apply_profile: better use dhcp-space on wifi
* feature+: ipsystem() cleanup variables-usage, throw away everything which is not used
* feature+: ipsystem() new var: NETDEVPRE=WAN|LAN|WIFI - show if $IP is from lan/wan/wifi
* feature+: autoinstall/deinstall_if_needed of: luci-mod-admin-full + luci-theme-bootstrap + ( libiwinfo-lua )
* hardware: Picostation M2 = dmesg: "MyLoader: sysp=f0f0f0f0, boardp=f0f0f0f0, parts=f1f0f0f0" + "mtd: partition "rootfs_data" created automatically, ofs=3A0000, len=410000"
* hardware: Bullet:        = dmesg: "MyLoader: sysp=f0f0f0f0, boardp=f0f0f0f0, parts=f0f0f0f0" + "mtd: partition "rootfs_data" created automatically, ofs=390000, len=420000"
* specialtweak: elephant/76: dualradio/olsr-hna-slave-error?
* specialtweak: apply_profile: olympia/2: telefonanlage -> OlsrMainIp = $WIFIADR
* specialtweak: apply_profile: hotelloB01/K80: disable olsr-hna-slave
* specialtweak: preskil: timezone "MUT"
* specialtweak: fparkssee: 222: olsrd: hna-offer (it's over lan)
* specialtweak: marinapark: inet:96/10 :announce alias-ip
* specialtweak: galerie: 3_inet: no wan OLSR
* specialtweak: fparkssee: 223: must have 152 for neigh? -> rapid shrink of routing table?
* specialtweak: ejbw/52 -> landhcp on (flurtelefone)

vpn()
* feature+: cleanup andi's approach

netfilter()
* bug: major: use a dummy policy-routing rule on simplemesh to avoid clients
* bug: minor: remove /tmp/user-$HASH* during restart()
* documentation: describe dependencies for each mode
* feature+: move vds-data to user's dir /tmp/NETFILTER/USER/$MAC/dataretention
* feature+: support special dir for vds-data, e.g. softlinked to usbdisk?
* feature+: conntrack_max++ on 32mb+: http://wiki.imagestream.com/wiki/Resolving_%22ip_conntrack:_table_full,_dropping_packet%22_errors
* feature+: check if connection_tracking is really of when '-m state --state' is not used
* feature+: maintenance-mode() on: enforce 5353-dnsmasq + logout all + show special message in weblogin off: back to normal + simulate 8.8.8.8
* feature+: detect 0x1337-port action ("a neighbour reboots")
* feature+: config-option to forbid forwarding for local-net-clients ("no clients"), to have a simple/fast setup on mesh-nodes
* feature+: masquerade "$exception/$cidr"
* feature+: portforwarding start|stop: iptables -t nat -I PREROUTING -p tcp -i $WANDEV --dport 222 -j DNAT --to-destination 10.63.2.34:22
* feature+: user_quota add|del "$mac" "$upload" "$download"
* feature+: user_quota query "$mac" <up|down|all>
* feature+: user_quota diff "$mac" <up|down|all>
* feature+: user_speed add|del "$mac" "$upload" "$download"
* feature+: user_adblock add|del
* feature+: olsr_whitelist (no more double ip's by accident) + monitoring bad packets
* feature+: use "passiv" speedtesting with connbytes: packets/quantum


lowmem()
* feature+: maintain a list if essential kmods/hardware-type, instead of checking each if used
* feature+: dynamically remove wandev, if not needed
* feature+: switch off lan-dhcp on APs
* feature+: switch off dhcp-script in APs
* feature+: use zram-based ramdisk instead of tmpfs (frontswap/cleancache)
* feature+: measure ssh-port-activity, kill daemon if no action for x minutes
* feature+: build config_profile-specific dhcp-script during startup (lowering condition checks/size)
* idea: instead of crond, use: 'while :; do . /tmp/cron.script; sleep 60; done &' -> problem? does it really safe mem?

misc()
* bug: major: fparkssee/222: cron.check_inet_gw / laninet_offer
* bug: major: patch mtd.c for verify + correct error-codes, respect that in sysupgrade
* bug: major: netintern scp with pubkeys is b0rken?
* bug: minor: why hangs '/etc/init.d/rcS' + 'logger' in tasklist
* bug: minor: change timing for inet-speedtest to be more accurate
* bug: minor: speedtest without iptables -> use /proc/net/dev -> e.g. $WANDEV
* bug: minor: change server/file for inet-speedtest (roundrobin)
* bug: minor: during speedtest disable any forwarding to be more accurate
* bug: minor: remove all occurrences of normal wget: cron.upgrade_packages / cron.evaluate_ulogd / speedtest?
* bug: minor: read dbclient cmdline + check ssh/http-reverse-ssh-tunnel correctly
* feature+: collect radio-stats each minute (ath9k)
* feature+: shell/logger: lookout for a way the handover "interactive" mode, e.g. *.sh calls another *.sh
* feature+: use curl or ssl-enabled wget for HTTPS-based REST for internal communication instead of plain HTTP
* feature+: set a maximum pause/uptime before running a scheduler job/in general, so we have "unknown" reboot
* feature+: firmware_burn() no pause in image-on-flash mode
* feature+: get rid of the cronwatchdog.sh
* feature+: use something like crondog.o, which pitches the kernel watchdog every 20 secs
* feature+: kalua-loader: only regen, if md5sum differs (overall/each class)
* feature+: if inet_offer via WANDEV, check regulary ping to gateway (primacom-problem)
* feature+: overclocking WRT54G? http://www.dd-wrt.com/wiki/index.php/Linksys_WRT54G/GL/GS/GX#Clock_Speed_and_Overclocking
* feature+: overclocking WHR-HP-54g (EU-version)? http://www.dd-wrt.com/phpBB2/viewtopic.php?p=102911&sid=01f76318a484a52a3267e4c2fe61ef41
* feature+: choose random channel on ap on early boot
* feature+: firmware_update_pmu() needs locking
* feature+: make logile-archive-length (monitoring etc.) configureable and limit it on lowmem-devices
* feature+: uci2nvram-wrapper for having a configureable lowflash-squashfs-only-device
* feature+: after setting time with ntp, safe /tmp/uptime2unixtime - so we have an offset for easy calculating
* cleanup: use generic locking-mechanism and use /tmp/lock
* cleanup: remove all calls to nvram-stuff

documentation()
* feature+: add screenshots of userdb-gui
* feature+: add screenshots of several splash-pages/captive-portals/weblogins
* feature+: add script for generate functions-call-graph with arguments

upgrade_packages()
* feature+: success? broadcast to all neighbours: "do it now"
* cleanup: use wget() for fetching or maybe activate busybox-option 'wget -T xxx'
* cleanup: use full opkg features for upgrade: if package-source-list is in ramdisk, temporarily hide full repo but leave ours alive and use 'opkg update', 'opkg install mydesign' (upgrade?)

switch()
* bug: minor: be correct when translating vlans, e.g. if somebody has changed the position of wan-port
* feature+: check every minute, if state of wan-port has changed: do ifup/ifdown accordingly
* feature+: detect permanent status-change of one or more ports
* feature+: detect time of port-status-change and include in monitoring

pdf()
* feature+: ongoing site-numbers for overview
* feature+: ongoing ticketnumber for labels

monitoring()
* bug: minor: after each correct transmitted line, move the OK-mark one line further (now, a wrong transmission after line 99/100 will cause an retransmission of all 99 lines)
* feature+: implement heartbeat, which simply refreshes old values ("no change, but alive")
* feature+: add some more speedtest-servers/files and use appropriate, e.g. in mauritus: http://www.gov.mu/portal/goc/educationsite/file/Livelihood%20And%20Trade%20Skills%20Book.pdf
* feature+: show: minstrelRX from my wifi-gateway '_tool remote $gateway minstrel'
* feature+: show: how many connection time, how many wifi-clients
* feature+: show: dhcp via trafficlight: LAN-max+used|WIFI-max+used|dhcpscript-on/off|dnsserver (color=symbol or ip)|cachesize|queries|cachehits|size:/etc/local.hosts (adblock)
* feature+: show: olsrd on/off
* feature+: show: last weblogin-fetch
* feature+: show: last weblogin-good-login
* feature+: show: last dhcp-offer
* feature+: show: db: profiles/logins/devices/index?
* feature+: different/shorter intervals for different values
* feature+: for specific changes fire a monitoring send immediately
* feature+: show: detect usb-stick plugin/out
* feature+: show: per neigh: HT20/HT40, LGI/SGI, MCS xy/rate
* feature+: show: wifi_signal() non_olsr_clients
* feature+: show: count of different connected clients LAN/WIFI + conn_time
* feature+: show: last wifi_phy_restart() reason (if any)
* feature+: show: count of usertunnels
* feature+: intranet internal aggregation of monitoring data
* feature+: network-map with javascript: http://thejit.org/demos/ -> http://thejit.org/static/v20/Jit/Examples/ForceDirected/example2.js
* feature+: network-map 3d with js: http://mrdoob.github.com/three.js/ -> http://mrdoob.github.com/three.js/examples/canvas_lines.html

monitoring-server()
* bug: password-protect admin-interface
* bug: accept/deny hostname if more than one is given (e.g. changed a correct hostname)
* feature+: allow change of arbitrary values via webif
* feature+: show olsrd-errors in relation to time-unit
* feature+: detect devices with always short uptime
* feature+: use 'logo.gif' from 'design.ipk' of all profiles to build a nice summary

olsr()
* bug: major: check_plausi() costs_getting_worse: doess the double check really work? (comparing correct database?)
* bug: minor: olsr-hna-slave: don't become a slave, if behind is an further olsr-neigh (e.g. at wandev, but default is via lan)
* bug: minor: olsr-hna-slave: master: block olsr-packets from slave before restarting daemon, otherwise we get the hna again
* feature+: deactivate arp-plugin, make arp permanent during check_plausi()
* feature+: olsr-hna-slave: if OK for specific host is often, output NEVER
* feature+: olsr-hna-slave: if answer is NEVER, do not try again this ip
* feature+: olsr-hna-slave: force to ask a specific neigh, if "ip" is set via uci
* feature+: maintain a list of all HNA-entries, lookout for missing ones
* feature+: check_plausi: detect: no_wifi_neigh, but had_good_before
* feature+: check_plausi: detect: lost a good neigh

sms()
* feature+: simplify procedure and use/send only one token (not username+password)
* feature+: premium-sms
* feature+: text2pay
* feature+: smsbox.net

fax()
* feature+: implement sipgate-API

userdb()
* bug: major: check if '_db user device show $ID' can be changed to be more exakt, e.g. append 'last'?
* bug: major: respect settings how much macs/devices are allowed to getin with one login (b0rken)
* bug: major: respect group-logins during device-check (e.g. devices eat up limit for 1 login)
* bug: minor: respect race, if index_gen runs, but new logins will be added
* bug: minor: change specific login -> index_gen runs not automatically or wrong
* feature+: implement ticket-print for Avery Zweckform Quick&Clean C32011
* feature+: remember last OK ticket-mail-sending - profile specific
* feature+: list_logins: last week, last month ...
* feature+: during cron.add-traff, built: active_users.html -> show in userdb-gui (+overall time/traff)
* feature+: index_gen() allow specific login (fast!)
* feature+: report() username/password or login_id -> fetches all devices
* feature+: report() $mac: -> PDF -> email
* feature+: report() show XX devices on YY routers
* feature+: report() top 10 users, top 10 devices
* feature+: report() show theoretical max download and "x percent of" for top-graphs + typical up/download ratio
* feature+: report() rotate_view() http://meinews.niuz.biz/re-t496245.html?s=1bf4dc343372425d68a62bcd18de7a6d&amp;
* feature+: report() punchcard: http://g.raphaeljs.com/dotchart.html
* feature+: report() traffic: http://g.raphaeljs.com/linechart.html
* feature+: measure tickets/s during index_gen and safe this value
* feature+: during index_gen write a mark each 30sec according to speed-value (see above)
* feature+: profile: allow access to internal network: yes/no
* feature+: profile: sanitize all speed-values to integer
* feature+: meta: weblogin = username/password | sms | both: (which is default)(user selectable)
* feature+: meta: weblogin is blocked, if hostname is virgin: yes/no
* feature+: meta: emails, sms-numbers, fax-numbers 
* feature+: meta: object name, speed uplink/downlink, ...
* feature+: meta: default language for weblogin (=order of languages)
* feature+: login: add message to user on next login
* feature+: login: temporarily disable a login
* feature+: relation between login and free-lan-dhcp-device
* feature+: list_logins: show used_or_not
* feature+: list_logins: show last used time
* feature+: username_namespace: 'islands of the world'
* feature+: auto distribute DB over network
* feature+: after making e.g. 32 logins, print a direct link to overview
* feature+: index_gen() if password = number && fuzzy-mode -> _list uniq $(hashes)
* cleanup: move hardcoded db-servers into config_var which is set during apply_profile

weblogin()
* bug: minor: translate logout-page
* bug: major: sms-mode: make sure, that phonenumer is safed in database
* cleanup: minor: change/translate varnames in terms_of_use.meta
* feature+: link to installation-object-name/webpage on logo
* feature+: fakepop / autoanswer pop3 action ("please login")
* feature+: make use of user-language via HTTP_ACCEPT_LANGUAGE
* feature+: make the sms-auth only visible in configurable timeslots
* feature+: implement credit-card API for payment
* feature+: implement import of xml/csv logins

usertunnel()
* bug: minor: allow local entry in/out: e.g. direct connection to inet_offering node
* bug: minor: check via ping the other tunnel-end - stop tunnel if fails (test: server reboots)
* bug: minor: disconnecting client: rewrite all.conf + remove client.conf 
* bug: minor: use different config-file-names on client/server
* bug: minor: release unused tunnel IDs
* feature+: explicit intranet tunnels (compression, another shaping?)
* feature+: join several tunnels into one, to corectly shape several devices with one login

config()
* bug: minor: leave already configured special network/vlan-settings
* feature+: make WAN-olsr better configureable
* feature+: repect /tmp/resolv.conf.ppp + .auto? (faster resolution)
* feature+: use special ip4 for service HNA/redundancy: 6.6.6.[5|6|7|8] = monitoring|dns|userdb|tunnelsrv

scheduler()
* bug: minor: why does it happen: "scheduler_allow_run() removing lockfile, which seems to be left by accident"
* feature+: run tasks at a specific time

net()
* cleanup: implement pingtest-abstraction and use it
* feature+: sort "/tmp/dhcp.leases" | while read LINE; do set $LINE; echo "$( _system date unixtime2date $1 ) $LINE";done

wifi()
* bug: major: b43: "BCM4318 chipset: AP mode does not work because of packet loss in high transmission rates"
* feature+: check if arping-test raised wifi-tx-counter
* feature+: b43: try module parameter 'nohwcrypt=1 qos=0' (lowering mem?)

